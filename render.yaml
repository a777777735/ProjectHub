# ProjectHub/render.yaml

services:
  #-------------------------------------------------
  # Service 1: Tic Tac Toe Backend (Socket.IO Server)
  #-------------------------------------------------
  - type: web
    name: projecthub-ttt-backend # 确保这个名字在你的Render账户中是唯一的
    env: node
    region: oregon # 或你选择的区域
    plan: free
    rootDir: apps/tic-tac-toe-server # 命令在此目录下执行
    buildCommand: "npm install"
    startCommand: "node server.js"
    healthCheckPath: /
    envVars:
      - key: NODE_ENV
        value: production
      # PORT is automatically injected by Render

  #-------------------------------------------------
  # Service 2: Main Frontend Server (Serves static files and app routes from root server/index.js)
  #-------------------------------------------------
  - type: web
    name: projecthub-main-frontend # 确保这个名字在你的Render账户中是唯一的
    env: node
    region: oregon # 与上面服务保持一致或按需选择
    plan: free
    # No rootDir, commands run from repository root.
    buildCommand: "npm install" # 安装根目录 package.json 中的依赖 (如 express)
    startCommand: "node server/index.js" # **这里指定了 server/index.js**
    healthCheckPath: / # 主菜单页
    envVars:
      - key: NODE_ENV
        value: production
      # PORT is automatically injected by Render
      # 如果井字棋前端需要知道后端的URL，你需要确保客户端JS能获取到
      # projecthub-ttt-backend 服务的URL。
      # 这通常通过在客户端JS中硬编码Render分配的后端URL，
      # 或者如果前端是由这个main-frontend服务动态渲染的，则可以通过服务器端注入。
      # 对于纯静态前端，客户端JS直接连接到后端的公共URL。
