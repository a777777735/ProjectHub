<!DOCTYPE html>
<!-- saved from url=(0158)file:///C:/Users/ab777/Desktop/%E4%BA%BA%E5%8A%9B%E9%9C%80%E6%B1%82%E7%B8%BD%E8%A1%A8%20(%E7%B5%82%E6%A5%B5%E6%8E%92%E7%A8%8B%E6%95%B4%E5%90%88%E7%89%88).html -->
<html lang="zh-TW">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‰∫∫ÂäõÈúÄÊ±ÇÁ∏ΩË°® (ÁµÇÊ•µÊéíÁ®ãÊï¥ÂêàÁâà)</title>

    <script src="./xlsx.full.min.js"></script>

    <style>
        /* ================= ÂÖ®Â±ÄËàá‰∏ªË°®Ê®£Âºè ================= */
        body {
            font-family: "Microsoft JhengHei", Arial, sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            padding: 20px;
            color: #333;
            display: flex;
            flex-direction: column;
            height: 100vh;
            box-sizing: border-box;
        }

        .control-panel {
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            padding: 15px 20px;
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            flex-shrink: 0;
        }

        .header-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 12px;
        }

        .header-row h2 {
            margin: 0;
            color: #1565C0;
            font-size: 22px;
            display: flex;
            align-items: baseline;
            gap: 8px;
        }

        .header-row h2 span {
            font-size: 14px;
            color: #78909c;
            font-weight: normal;
        }

        .toolbar {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            align-items: center;
        }

        .tools-row {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .filter-controls,
        .view-controls {
            background: #f8f9fa;
            padding: 10px 15px;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
            align-items: center;
            font-size: 13px;
            flex-wrap: wrap;
            flex: 1;
        }

        .panel-label {
            font-weight: bold;
            color: #455a64;
            white-space: nowrap;
        }

        .filter-controls select,
        .filter-controls input {
            padding: 6px;
            border-radius: 4px;
            border: 1px solid #ccc;
            outline: none;
            background: #fff;
        }

        .filter-controls input {
            flex: 1;
            min-width: 120px;
        }

        .view-controls {
            flex: 1.2;
        }

        .view-controls label {
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
            color: #0277bd;
            background: #e3f2fd;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            transition: 0.2s;
            user-select: none;
        }

        .view-controls label:hover {
            background: #bbdefb;
        }

        .view-controls input[type="checkbox"] {
            cursor: pointer;
            margin: 0;
        }

        button {
            padding: 8px 14px;
            font-size: 13px;
            cursor: pointer;
            border: none;
            border-radius: 4px;
            background-color: #4CAF50;
            color: white;
            transition: 0.2s;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);
            font-weight: bold;
        }

        button:hover {
            filter: brightness(1.1);
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        button:active {
            transform: translateY(0);
        }

        .btn-main {
            background-color: #43a047;
            font-size: 14px;
            padding: 8px 18px;
        }

        .btn-matrix {
            background-color: #1565C0;
            font-size: 14px;
            padding: 8px 18px;
        }

        .btn-danger {
            background-color: #e53935;
        }

        .btn-setting {
            background-color: #546e7a;
        }

        .btn-export {
            background-color: #1e88e5;
        }

        .btn-import {
            background-color: #fb8c00;
        }

        .btn-recovery {
            background-color: #8e24aa;
        }

        .btn-copy {
            background-color: #00897b;
        }

        .btn-small {
            padding: 5px 10px;
            font-size: 12px;
            font-weight: normal;
            background-color: #9e9e9e;
        }

        .btn-cancel {
            background-color: #777;
        }

        .context-menu {
            position: absolute;
            background: white;
            border-radius: 6px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            padding: 6px 0;
            min-width: 160px;
            z-index: 2000;
            font-size: 14px;
            border: 1px solid #eee;
        }

        .context-menu-item {
            padding: 10px 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #333;
            transition: background 0.2s;
        }

        .context-menu-item:hover {
            background-color: #f0f8ff;
            color: #1976D2;
        }

        .context-menu-item.danger:hover {
            background-color: #ffebee;
            color: #d32f2f;
        }

        .context-menu-item.disabled {
            color: #aaa;
            cursor: not-allowed;
        }

        .context-menu-item.disabled:hover {
            background-color: white;
            color: #aaa;
        }

        .inline-workload-input {
            width: 100%;
            box-sizing: border-box;
            text-align: center;
            border: 1px solid transparent;
            border-radius: 2px;
            font-size: 12px;
            padding: 2px 0;
            background-color: transparent;
            transition: 0.2s;
        }

        .inline-workload-input:hover {
            border-color: #ccc;
            background-color: #fcfcfc;
        }

        .inline-workload-input:focus {
            outline: none;
            border-color: #2196f3;
            background-color: #fff;
            box-shadow: 0 0 3px rgba(33, 150, 243, 0.5);
        }

        .inline-workload-input:invalid {
            border-color: red;
            background-color: #ffebee;
        }

        /* üí° ‰øÆÊ≠£ÔºöÂº∑Âà∂Èö±ËóèÊï∏Â≠óËº∏ÂÖ•Ê°ÜÁöÑ‰∏ä‰∏ãÁÆ≠È†≠ÔºåÂè™ÊúâÊªëÈº†ÂÅúÁïôÂú®‰∏äÈù¢ÊôÇÊâçÈ°ØÁ§∫ */

        /* ÈáùÂ∞ç Chrome, Safari, Edge */
        .inline-workload-input::-webkit-inner-spin-button,
        .inline-workload-input::-webkit-outer-spin-button {
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
        }

        .inline-workload-input:hover::-webkit-inner-spin-button,
        .inline-workload-input:hover::-webkit-outer-spin-button {
            opacity: 1;
        }

        /* ÈáùÂ∞ç Firefox */
        .inline-workload-input {
            -moz-appearance: textfield;
        }

        .inline-workload-input:hover {
            -moz-appearance: number-input;
        }

        .inline-select {
            width: 100%;
            min-width: max-content;
            box-sizing: border-box;
            border: 1px solid transparent;
            background: transparent;
            font-size: 13px;
            padding: 2px 16px 2px 8px;
            text-align: center;
            text-align-last: center;
            border-radius: 2px;
            cursor: pointer;
            color: #0277bd;
            font-weight: bold;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: none;
            transition: all 0.2s ease;
        }

        .inline-select:hover,
        .inline-select:focus {
            border-color: #ccc;
            background-color: #fafafa;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24"><path fill="%230277bd" d="M7 10l5 5 5-5z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 2px center;
        }

        .inline-select:focus {
            border-color: #2196f3;
            background-color: #fff;
            outline: none;
            box-shadow: 0 0 3px rgba(33, 150, 243, 0.3);
        }

        :root {
            --col-width: 45.5px;
        }

        .table-container {
            overflow: auto;
            background-color: white;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            flex: 1;
            min-height: 0;
            transition: cursor 0.2s;
        }

        .table-container.is-panning {
            cursor: grabbing !important;
            user-select: none;
        }

        .time-col {
            min-width: var(--col-width) !important;
            max-width: var(--col-width) !important;
            width: var(--col-width) !important;
            transition: min-width 0.1s ease-out, max-width 0.1s ease-out, width 0.1s ease-out;
            overflow: visible;
            position: relative;
            vertical-align: bottom;
            padding: 4px 0 !important;
        }

        .col-region,
        .col-project,
        .col-category,
        .col-macro,
        .col-micro,
        .col-task,
        .col-subtask,
        .col-group,
        .col-name {
            width: 1%;
            min-width: max-content !important;
            padding-left: 1.5px !important;
            padding-right: 1.5px !important;
            white-space: nowrap;
        }

        .phase-bar {
            position: absolute;
            height: 18px;
            font-size: 11px;
            font-weight: bold;
            text-align: left;
            line-height: 18px;
            box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.5), 0 1px 2px rgba(0, 0, 0, 0.15);
            pointer-events: auto;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: clip;
            z-index: 5;
            box-sizing: border-box;
            padding-left: 6px;
            cursor: pointer;
            transition: filter 0.2s;
        }

        .phase-bar:hover {
            filter: brightness(0.85);
            z-index: 15 !important;
        }

        table {
            width: max-content;
            border-collapse: separate;
            border-spacing: 0;
            white-space: nowrap;
            border-top: 1px solid #ddd;
            border-left: 1px solid #ddd;
            table-layout: fixed;
        }

        th,
        td {
            border-bottom: 1px solid #ddd;
            border-right: 1px solid #ddd;
            padding: 2px 4px;
            text-align: center;
            font-size: 12px;
            background-clip: padding-box;
        }

        tbody tr {
            background-color: #ffffff;
            cursor: context-menu;
        }

        tbody tr:hover {
            background-color: #f0f8ff;
        }

        #monthTheadTr th {
            position: sticky;
            top: 0;
            z-index: 20;
            height: 28px;
            box-sizing: border-box;
        }

        #monthTheadTr th[rowspan="2"] {
            z-index: 50;
            background-color: #e2e8f0;
        }

        #mainTheadTr th {
            position: sticky;
            top: 28px;
            z-index: 20;
            background-color: #f1f5f9;
            padding: 2px 0;
        }

        tfoot td {
            position: sticky;
            bottom: 0;
            z-index: 20;
            box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
            border-top: 2px solid #ffb300;
            background-color: #fff8e1;
            font-size: 12px;
        }

        th.sortable {
            cursor: grab;
            user-select: none;
            padding-right: 18px;
            transition: background-color 0.2s;
        }

        th.sortable:hover {
            filter: brightness(0.95);
        }

        th.sortable:active {
            cursor: grabbing;
        }

        th.sortable.drag-over {
            border-left: 3px solid #ff9800 !important;
            background-color: #ffe082 !important;
        }

        th.sortable::after {
            content: '‚Üï';
            position: absolute;
            right: 4px;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0.2;
            font-size: 12px;
        }

        th.sortable.asc::after {
            content: 'üîº';
            opacity: 1;
        }

        th.sortable.desc::after {
            content: 'üîΩ';
            opacity: 1;
        }

        .hidden-col {
            display: none !important;
        }

        .merged-cell {
            display: none !important;
        }

        td.highlight-target {
            outline: 3px solid #ff9800 !important;
            outline-offset: -3px;
            background-color: #fff3e0 !important;
            box-shadow: inset 0 0 10px rgba(255, 152, 0, 0.3) !important;
            z-index: 50 !important;
        }

        #cm-header {
            padding: 8px 16px;
            background: #e3f2fd;
            color: #0277bd;
            font-weight: bold;
            border-bottom: 1px solid #bbdefb;
            font-size: 13px;
            pointer-events: none;
        }

        /* ================= Á≥ªÁµ±ÂéüÁîüÂΩàÂá∫Ë¶ñÁ™ó Modal ================= */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            overflow-y: auto;
        }

        .modal-content {
            background-color: #fff;
            margin: 2% auto;
            padding: 20px 30px;
            border-radius: 8px;
            width: 98%;
            max-width: 1400px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: black;
        }

        .modal-footer {
            margin-top: 20px;
            text-align: right;
            border-top: 2px solid #eee;
            padding-top: 15px;
        }

        /* ================= Êñ∞Â¢û/Á∑®ËºØË¶ñÁ™óÊ®£Âºè ================= */
        .relation-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 15px;
            background: #fafafa;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #eee;
            transition: all 0.3s;
        }

        .step-hidden {
            opacity: 0.3;
            pointer-events: none;
            filter: grayscale(100%);
        }

        .check-group {
            flex: 1;
            min-width: 120px;
            display: flex;
            flex-direction: column;
        }

        .check-group label.title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #0056b3;
            border-bottom: 1px solid #ccc;
            padding-bottom: 4px;
            display: flex;
            justify-content: space-between;
        }

        .check-list {
            display: flex;
            flex-direction: column;
            gap: 6px;
            max-height: 150px;
            overflow-y: auto;
            padding-right: 5px;
        }

        .check-btn {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            text-align: left;
            padding: 6px 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            background: #fff;
            cursor: pointer;
            font-size: 13px;
            color: #333;
        }

        .check-btn:hover {
            background: #e9ecef;
        }

        .check-btn.active {
            background: #e3f2fd;
            border-color: #2196f3;
            color: #0d47a1;
            font-weight: bold;
            box-shadow: inset 3px 0 0 #2196f3;
        }

        .check-btn.disabled {
            display: none;
        }

        .tag-npi {
            background: #e1f5fe;
            color: #0277bd;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }

        .tag-mp {
            background: #e8f5e9;
            color: #2e7d32;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }

        .gantt-wrapper {
            width: 100%;
            overflow-x: auto;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border: 1px solid #eee;
            border-radius: 6px;
        }

        .gantt-scroll-area {
            min-width: 1200px;
            padding: 10px;
        }

        .gantt-container-parent {
            margin-left: 84px;
            width: calc(100% - 84px);
            margin-bottom: 8px;
            display: none;
        }

        .gantt-container {
            position: relative;
            width: 100%;
            height: 40px;
            background: #fdfdfd;
            border-radius: 6px;
            border: 1px solid #ddd;
            transition: height 0.3s;
        }

        .gantt-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: grid;
            pointer-events: none;
        }

        .gantt-grid div {
            border-right: 1px dashed #e0e0e0;
            box-sizing: border-box;
        }

        .gantt-grid div:last-child {
            border-right: none;
        }

        .gantt-bar {
            position: absolute;
            height: 24px;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 6px;
            font-size: 11px;
            color: white;
            box-sizing: border-box;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
            white-space: nowrap;
            overflow: hidden;
            transition: 0.3s;
        }

        .gantt-bar b {
            font-size: 12px;
            letter-spacing: 0.5px;
            margin: 0 4px;
        }

        .gantt-bar span {
            opacity: 0.9;
            font-size: 10px;
        }

        .workload-header-grid {
            display: grid;
            gap: 0;
            margin-bottom: 6px;
            align-items: end;
            width: max-content;
        }

        .workload-header {
            font-size: 11px;
            font-weight: bold;
            text-align: center;
            background: #eee;
            border-radius: 0;
            padding: 4px 0;
            border-right: 1px solid #ccc;
        }

        .workload-rows-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: max-content;
        }

        .workload-row {
            display: grid;
            gap: 0;
            align-items: center;
            width: max-content;
        }

        .workload-row-name {
            font-weight: bold;
            text-align: center;
            background: #e3f2fd;
            padding: 6px 2px;
            border-radius: 4px;
            color: #0277bd;
            font-size: 12px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-right: 2px;
        }

        .workload-input-modal {
            width: 100%;
            text-align: center;
            border: 1px solid transparent;
            border-radius: 2px;
            font-size: 11px;
            padding: 2px 0;
            outline: none;
            transition: 0.2s;
        }

        .workload-input-modal:hover {
            border-color: #ccc;
        }

        .workload-input-modal:focus {
            border-color: #2196f3;
            box-shadow: 0 0 3px rgba(33, 150, 243, 0.5);
            background: #fff;
        }

        /* DB Modal */
        .db-tabs {
            display: flex;
            border-bottom: 2px solid #ccc;
            margin-bottom: 15px;
            gap: 5px;
            flex-wrap: wrap;
        }

        .db-tab-btn {
            background: #f1f1f1;
            color: #333;
            border-radius: 6px 6px 0 0;
            padding: 10px 20px;
            font-weight: bold;
        }

        .db-tab-btn.active {
            background: #607d8b;
            color: white;
        }

        .db-tab-content {
            display: none;
        }

        .db-tab-content.active {
            display: block;
        }

        .action-bar {
            padding: 12px 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.05);
        }

        .action-bar .action-label {
            font-weight: bold;
            display: flex;
            align-items: center;
            white-space: nowrap;
            font-size: 14px;
        }

        .action-bar input,
        .action-bar select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            flex: 1;
            min-width: 120px;
        }

        .db-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .db-table th,
        .db-table td {
            border: 1px solid #eee;
            padding: 8px 10px;
            text-align: left;
            font-size: 14px;
        }

        .db-table th {
            background-color: #f9f9f9;
            color: #555;
            position: sticky;
            top: 0;
        }

        /* ================= üåü Ë≥áÊ∫êÂàÜÈÖçÁü©Èô£Â∞àÂ±¨Ê®£Âºè (am- prefix) ================= */
        #allocModal .modal-content {
            width: 98%;
            max-width: 1800px;
            height: 95vh;
            display: flex;
            flex-direction: column;
            padding: 20px;
            box-sizing: border-box;
        }

        .am-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 15px;
            margin-bottom: 15px;
            flex-shrink: 0;
        }

        .am-title {
            font-size: 22px;
            font-weight: 700;
            color: #0f172a;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .am-title span {
            font-size: 14px;
            font-weight: normal;
            color: #64748b;
        }

        .am-week-nav {
            display: flex;
            align-items: center;
            background: #f8fafc;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            overflow: hidden;
        }

        .am-btn-nav {
            background: transparent;
            border: none;
            padding: 8px 16px;
            cursor: pointer;
            color: #64748b;
            font-size: 15px;
            font-weight: bold;
            transition: 0.2s;
        }

        .am-btn-nav:hover {
            background: #e2e8f0;
            color: #3b82f6;
        }

        .am-week-sel-wrap {
            position: relative;
            border-left: 1px solid #e2e8f0;
            border-right: 1px solid #e2e8f0;
        }

        .am-week-sel {
            padding: 8px 30px 8px 16px;
            border: none;
            font-size: 15px;
            font-weight: 700;
            color: #3b82f6;
            background: transparent;
            outline: none;
            cursor: pointer;
            appearance: none;
            text-align: center;
        }

        .am-week-sel-wrap::after {
            content: '‚ñº';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 10px;
            color: #3b82f6;
            pointer-events: none;
        }

        .am-week-sel:hover {
            background: #eff6ff;
        }

        .am-main-layout {
            display: flex;
            gap: 20px;
            flex: 1;
            min-height: 0;
        }

        .am-panel {
            background: #fff;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .am-panel-left {
            flex: 1.4;
        }

        .am-panel-right {
            flex: 0.6;
        }

        .am-panel-title {
            background: #f8fafc;
            padding: 12px 20px;
            border-bottom: 1px solid #e2e8f0;
            margin: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 16px;
            font-weight: 700;
            color: #1e293b;
            flex-shrink: 0;
        }

        .am-content-scroll {
            overflow-y: auto;
            overflow-x: auto;
            flex: 1;
            padding: 15px;
        }

        .am-btn-add {
            background: #fff3e0;
            color: #e65100;
            border: 1px solid #ffb74d;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: 0.2s;
        }

        .am-btn-add:hover {
            background: #ffe0b2;
            transform: translateY(-1px);
        }

        .am-matrix {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
        }

        .am-matrix th {
            background: #f1f5f9;
            padding: 10px 6px;
            border-bottom: 2px solid #cbd5e1;
            border-right: 1px solid #e2e8f0;
            font-size: 13px;
            text-align: center;
            font-weight: 700;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .am-matrix th:last-child {
            border-right: none;
        }

        .am-matrix th.is-current {
            background: #e0e7ff;
            color: #1d4ed8;
            border-bottom: 2px solid #3b82f6;
        }

        .am-matrix td {
            padding: 12px 8px;
            border-bottom: 1px solid #e2e8f0;
            border-right: 1px dashed #e2e8f0;
            vertical-align: top;
        }

        .am-matrix td:last-child {
            border-right: none;
        }

        .am-matrix td.is-current {
            background: #eff6ff;
            box-shadow: inset 0 0 0 1px #bfdbfe;
        }

        .am-matrix tr:last-child td {
            border-bottom: none;
        }

        .am-group-row td {
            background: #f8fafc;
            padding: 10px 16px;
            border-top: 2px solid #cbd5e1;
            border-bottom: 1px solid #cbd5e1;
            border-right: none;
        }

        .am-timeline-wrap {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            align-items: center;
        }

        .am-task-info-td {
            min-width: 220px;
            max-width: 260px;
        }

        .am-task-name {
            font-weight: 600;
            font-size: 14px;
            color: #1e293b;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
            flex-wrap: wrap;
        }

        .am-task-path {
            font-size: 11px;
            color: #64748b;
            background: #f1f5f9;
            padding: 2px 6px;
            border-radius: 4px;
            display: inline-block;
            margin-bottom: 8px;
        }

        .am-badge-phase {
            font-size: 10px;
            padding: 2px 4px;
            border-radius: 4px;
            font-weight: bold;
            border: 1px dashed #93c5fd;
        }

        .am-phase-prep {
            background: #fef08a;
            color: #9a3412;
            border-color: #fde047;
        }

        .am-phase-active {
            background: #e0e7ff;
            color: #1e40af;
        }

        .am-phase-post {
            background: #e5e7eb;
            color: #475569;
            border-color: #d1d5db;
        }

        .am-input-req {
            width: 35px;
            border: 1px dashed #cbd5e1;
            border-radius: 4px;
            text-align: center;
            font-weight: 700;
            color: #3b82f6;
            outline: none;
            background: transparent;
            font-size: 12px;
            transition: 0.2s;
            -moz-appearance: textfield;
            padding: 2px 0;
        }

        .am-input-req::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .am-input-req:hover,
        .am-input-req:focus {
            background: #fff;
            border-style: solid;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px #eff6ff;
            cursor: text;
        }

        .am-assign-controls {
            background: #fff;
            border: 1px solid #93c5fd;
            border-radius: 6px;
            padding: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        }

        .am-assign-sel {
            padding: 4px;
            border: 1px solid #cbd5e1;
            border-radius: 4px;
            outline: none;
            font-size: 12px;
            color: #334155;
            width: 100%;
            margin-bottom: 4px;
        }

        .am-assign-val {
            padding: 4px;
            border: 1px solid #cbd5e1;
            border-radius: 4px;
            text-align: center;
            font-weight: 600;
            outline: none;
            font-size: 12px;
            width: 50%;
            box-sizing: border-box;
        }

        .am-btn-assign {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-size: 11px;
            width: 50%;
            box-sizing: border-box;
            transition: 0.2s;
        }

        .am-btn-assign:hover {
            background: #2563eb;
        }

        .am-pill {
            background: #dcfce7;
            color: #065f46;
            border-radius: 4px;
            padding: 3px 6px;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 11px;
            font-weight: 600;
            gap: 4px;
            border: 1px solid #a7f3d0;
        }

        .am-missing {
            color: #dc2626;
            font-weight: bold;
            font-size: 11px;
            background: #fee2e2;
            border-radius: 4px;
            padding: 3px 6px;
            display: block;
            text-align: center;
            border: 1px solid #fecaca;
            margin-bottom: 4px;
        }

        .am-btn-rm {
            background: transparent;
            border: none;
            color: #047857;
            cursor: pointer;
            padding: 0;
            font-size: 10px;
            line-height: 1;
            transition: 0.2s;
        }

        .am-pill:hover .am-btn-rm {
            color: #ef4444;
            transform: scale(1.2);
        }

        .am-group-hdr {
            font-size: 12px;
            font-weight: 700;
            color: #94a3b8;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 4px;
            margin: 20px 0 10px 0;
        }

        .am-person {
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            transition: 0.2s;
            margin-bottom: 6px;
            background: #fafafa;
        }

        .am-person:hover {
            background: #fff;
            border-color: #cbd5e1;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.02);
        }

        .am-person-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .am-person-name {
            width: 65px;
            font-weight: 600;
            font-size: 14px;
            text-align: right;
            color: #334155;
        }

        .am-track {
            flex: 1;
            background: #e2e8f0;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }

        .am-fill {
            height: 100%;
            transition: width 0.4s, background-color 0.4s;
            border-radius: 4px;
        }

        .am-val {
            width: 35px;
            font-weight: 700;
            font-size: 13px;
            text-align: right;
        }

        .am-tasks {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            padding-left: 77px;
        }

        .am-task-tag {
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 4px;
            border: 1px solid #cbd5e1;
            background: #fff;
            color: #475569;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: 0.2s;
            cursor: default;
        }

        .am-task-tag:hover {
            border-color: #fca5a5;
            background: #fee2e2;
            color: #b91c1c;
        }

        .am-tag-rm {
            color: #ef4444;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
            font-size: 13px;
            display: none;
            line-height: 1;
        }

        .am-task-tag:hover .am-tag-rm {
            display: inline-block;
        }
    </style>
</head>

<body>

    <div class="control-panel">
        <div class="header-row">
            <h2>‰∫∫ÂäõÈúÄÊ±ÇÁ∏ΩË°® <span>(ÂÖ®ÂäüËÉΩÊï¥ÂêàÁâà)</span></h2>
            <div class="toolbar">
                <button class="btn-main" onclick="openDataModal(-1)">‚ûï Êñ∞Â¢ûÂ∞àÊ°à/‰ªªÂãô</button>
                <button class="btn-matrix" onclick="openAllocModal()">üìä Ë≥áÊ∫êÂàÜÈÖçÁü©Èô£</button>
                <button class="btn-setting" onclick="openDbModal()">‚öôÔ∏è ÁÆ°ÁêÜË≥áÊñôÂ∫´</button>
                <button class="btn-copy" onclick="copyTableToClipboard()">üìã Ë§áË£ΩË¶ñËßí</button>
                <button class="btn-export" onclick="exportToExcel()">üì§ ÂåØÂá∫</button>
                <button class="btn-import" onclick="document.getElementById(&#39;excelFileInput&#39;).click()">üì•
                    ÂåØÂÖ•</button>
                <input type="file" id="excelFileInput" accept=".xlsx, .xls" style="display: none;"
                    onchange="importFromExcel(event)">
                <button class="btn-recovery" onclick="openRecoveryModal()">üïí ÊïëÊè¥</button>
                <button class="btn-danger" onclick="clearAllData()">üóëÔ∏è Ê∏ÖÈô§</button>
            </div>
        </div>

        <div class="tools-row">
            <div class="filter-controls">
                <span class="panel-label">üìÖ ÂçÄÈñìÔºö</span>
                <span id="timeline_range_label"
                    style="font-weight:bold; color:#e65100; font-size:14px; margin-right:10px; background:#fff3e0; padding:4px 8px; border-radius:4px;">2025Âπ¥12Êúà
                    ~ 2027Âπ¥2Êúà</span>

                <span style="border-left: 1px solid #ccc; height: 20px; margin: 0 5px;"></span>
                <span class="panel-label">üîç ÁØ©ÈÅ∏Ôºö</span>
                <select id="flt_region" onchange="applyMainFilter()">
                    <option value="">ÂÖ®ÈÉ®Âú∞ÂçÄ</option>
                    <option value="GL">GL</option>
                </select>
                <select id="flt_project" onchange="applyMainFilter()">
                    <option value="">ÂÖ®ÈÉ®Â∞àÊ°à</option>
                    <option value="Alpine">Alpine</option>
                </select>
                <select id="flt_category" onchange="applyMainFilter()">
                    <option value="">ÂÖ®ÈÉ®È°ûÂà•</option>
                    <option value="NPI">NPI</option>
                </select>
                <select id="flt_macro" onchange="applyMainFilter()">
                    <option value="">ÂÖ®ÈÉ®Â§ßË£ΩÁ®ã</option>
                    <option value="FATP">FATP</option>
                </select>
                <select id="flt_group" onchange="applyMainFilter()">
                    <option value="">ÂÖ®ÈÉ®ÁµÑÂà•</option>
                    <option value="ËªüÈ´îÊáâÁî®">ËªüÈ´îÊáâÁî®</option>
                </select>
                <input type="text" id="flt_keyword" placeholder="ÊêúÂ∞ãÂßìÂêç/‰∫ãÈ†Ö/Â∞èË£ΩÁ®ã..." oninput="applyMainFilter()">
                <button class="btn-small" onclick="clearMainFilter()">Ê∏ÖÈô§</button>
            </div>

            <div class="view-controls">
                <span class="panel-label" title="üí° ÊèêÁ§∫ÔºöÊåâ‰Ωè Ctrl + ÊªæËº™ÂèØ‰ª•ÁÑ°Á∏´Á∏ÆÊîæÂè≥ÂÅ¥ÊôÇÈñìËª∏ÔºåÂ∑¶ÂÅ¥‰øùÊåÅË≤ºÂêàÔºÅ">üëÅÔ∏è È°ØÁ§∫Ôºö</span>
                <label><input type="checkbox" id="toggleRegion" checked="" onchange="applyColumnToggle()"> Âú∞ÂçÄ</label>
                <label><input type="checkbox" id="toggleProject" checked="" onchange="applyColumnToggle()"> Â∞àÊ°à</label>
                <label><input type="checkbox" id="toggleCategory" checked="" onchange="applyColumnToggle()"> È°ûÂà•</label>
                <label><input type="checkbox" id="toggleMacro" checked="" onchange="applyColumnToggle()"> Â§ßË£ΩÁ®ã</label>
                <label><input type="checkbox" id="toggleMicro" checked="" onchange="applyColumnToggle()"> Â∞èË£ΩÁ®ã</label>
                <label><input type="checkbox" id="toggleTask" checked="" onchange="applyColumnToggle()"> ‰∏ª‰∫ãÈ†Ö</label>
                <label><input type="checkbox" id="toggleSubTask" checked="" onchange="applyColumnToggle()"> Â∞è‰∫ãÈ†Ö</label>
                <label><input type="checkbox" id="toggleGroup" checked="" onchange="applyColumnToggle()"> ÁµÑÂà•</label>
                <label><input type="checkbox" id="toggleName" checked="" onchange="applyColumnToggle()"> ÂßìÂêç</label>
            </div>
        </div>
    </div>

    <div class="table-container">
        <table id="mainTable">
            <thead>
                <tr id="monthTheadTr">
                    <th rowspan="2" class="sortable col-region"
                        style="border-bottom: 1px solid rgb(221, 221, 221); vertical-align: middle; position: sticky; left: 0px; z-index: 55; border-left: 1px solid rgb(221, 221, 221); border-right: 1px solid rgb(221, 221, 221); box-shadow: none;"
                        data-col="region" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)"
                        ondragover="dragOver(event)" ondragleave="dragLeave(event)" ondrop="dropCol(event)"
                        onclick="handleSort(&#39;region&#39;)" title="ÂèØÊãñÊõ≥ÊéíÂ∫èÊ¨Ñ‰Ωç">Âú∞ÂçÄ</th>
                    <th rowspan="2" class="sortable col-project"
                        style="border-bottom: 1px solid rgb(221, 221, 221); vertical-align: middle; position: sticky; left: 66.8px; z-index: 55; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;"
                        data-col="project" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)"
                        ondragover="dragOver(event)" ondragleave="dragLeave(event)" ondrop="dropCol(event)"
                        onclick="handleSort(&#39;project&#39;)" title="ÂèØÊãñÊõ≥ÊéíÂ∫èÊ¨Ñ‰Ωç">Â∞àÊ°à</th>
                    <th rowspan="2" class="sortable col-category"
                        style="background: rgb(255, 243, 224); border-bottom: 1px solid rgb(221, 221, 221); vertical-align: middle; position: sticky; left: 135.413px; z-index: 55; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;"
                        data-col="category" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)"
                        ondragover="dragOver(event)" ondragleave="dragLeave(event)" ondrop="dropCol(event)"
                        onclick="handleSort(&#39;category&#39;)" title="ÂèØÊãñÊõ≥ÊéíÂ∫èÊ¨Ñ‰Ωç">È°ûÂà•</th>
                    <th rowspan="2" class="sortable col-macro"
                        style="background: rgb(224, 242, 241); border-bottom: 1px solid rgb(221, 221, 221); vertical-align: middle; position: sticky; left: 197.888px; z-index: 55; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;"
                        data-col="macro" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)"
                        ondragover="dragOver(event)" ondragleave="dragLeave(event)" ondrop="dropCol(event)"
                        onclick="handleSort(&#39;macro&#39;)" title="ÂèØÊãñÊõ≥ÊéíÂ∫èÊ¨Ñ‰Ωç">Â§ßË£ΩÁ®ã</th>
                    <th rowspan="2" class="sortable col-task"
                        style="background: rgb(232, 245, 233); border-bottom: 1px solid rgb(221, 221, 221); vertical-align: middle; position: sticky; left: 277.688px; z-index: 55; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;"
                        data-col="task" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)"
                        ondragover="dragOver(event)" ondragleave="dragLeave(event)" ondrop="dropCol(event)"
                        onclick="handleSort(&#39;task&#39;)" title="ÂèØÊãñÊõ≥ÊéíÂ∫èÊ¨Ñ‰Ωç">‰∏ª‰∫ãÈ†Ö</th>
                    <th rowspan="2" class="sortable col-subtask"
                        style="background: rgb(232, 245, 233); border-bottom: 1px solid rgb(221, 221, 221); vertical-align: middle; position: sticky; left: 359.888px; z-index: 55; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;"
                        data-col="subTask" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)"
                        ondragover="dragOver(event)" ondragleave="dragLeave(event)" ondrop="dropCol(event)"
                        onclick="handleSort(&#39;subTask&#39;)" title="ÂèØÊãñÊõ≥ÊéíÂ∫èÊ¨Ñ‰Ωç">Â∞è‰∫ãÈ†Ö</th>
                    <th rowspan="2" class="sortable col-micro"
                        style="background: rgb(224, 242, 241); border-bottom: 1px solid rgb(221, 221, 221); vertical-align: middle; position: sticky; left: 428.488px; z-index: 55; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;"
                        data-col="micro" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)"
                        ondragover="dragOver(event)" ondragleave="dragLeave(event)" ondrop="dropCol(event)"
                        onclick="handleSort(&#39;micro&#39;)" title="ÂèØÊãñÊõ≥ÊéíÂ∫èÊ¨Ñ‰Ωç">Â∞èË£ΩÁ®ã</th>
                    <th rowspan="2" class="sortable col-group"
                        style="border-bottom: 1px solid rgb(221, 221, 221); vertical-align: middle; position: sticky; left: 517.088px; z-index: 55; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;"
                        data-col="group" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)"
                        ondragover="dragOver(event)" ondragleave="dragLeave(event)" ondrop="dropCol(event)"
                        onclick="handleSort(&#39;group&#39;)" title="ÂèØÊãñÊõ≥ÊéíÂ∫èÊ¨Ñ‰Ωç">ÁµÑÂà•</th>
                    <th rowspan="2" class="sortable col-name"
                        style="border-bottom: 1px solid rgb(221, 221, 221); vertical-align: middle; position: sticky; left: 598.488px; z-index: 55; border-left: none; border-right: 2px solid rgb(144, 202, 249); box-shadow: rgba(0, 0, 0, 0.08) 2px 0px 5px;"
                        data-col="name" draggable="true" ondragstart="dragStart(event)" ondragend="dragEnd(event)"
                        ondragover="dragOver(event)" ondragleave="dragLeave(event)" ondrop="dropCol(event)"
                        onclick="handleSort(&#39;name&#39;)" title="ÂèØÊãñÊõ≥ÊéíÂ∫èÊ¨Ñ‰Ωç">ÂßìÂêç</th>
                    <th colspan="65" style="padding: 0; border-bottom: 2px solid #bbdefb; border-right: none;">
                        <div style="display: flex; width: 100%; height: 100%;">
                            <div
                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2025Âπ¥ 12Êúà</div>
                            <div
                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2026Âπ¥ 1Êúà</div>
                            <div
                                style="width: 6.153846153846154%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2026Âπ¥ 2Êúà</div>
                            <div
                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2026Âπ¥ 3Êúà</div>
                            <div
                                style="width: 6.593406593406594%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2026Âπ¥ 4Êúà</div>
                            <div
                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2026Âπ¥ 5Êúà</div>
                            <div
                                style="width: 6.593406593406594%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2026Âπ¥ 6Êúà</div>
                            <div
                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2026Âπ¥ 7Êúà</div>
                            <div
                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2026Âπ¥ 8Êúà</div>
                            <div
                                style="width: 6.593406593406594%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2026Âπ¥ 9Êúà</div>
                            <div
                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2026Âπ¥ 10Êúà</div>
                            <div
                                style="width: 6.593406593406594%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2026Âπ¥ 11Êúà</div>
                            <div
                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2026Âπ¥ 12Êúà</div>
                            <div
                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2027Âπ¥ 1Êúà</div>
                            <div
                                style="width: 6.153846153846154%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 13px; font-weight: bold; box-sizing: border-box;">
                                2027Âπ¥ 2Êúà</div>
                        </div>
                    </th>
                </tr>
                <tr id="mainTheadTr">
                    <th class="sortable time-col" onclick="handleSort(&#39;y2025_w49&#39;)" style="line-height: 1.2;">
                        W49<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">12/1</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2025_w50&#39;)" style="line-height: 1.2;">
                        W50<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">12/8</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2025_w51&#39;)" style="line-height: 1.2;">
                        W51<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">12/15</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2025_w52&#39;)" style="line-height: 1.2;">
                        W52<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">12/22</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w1&#39;)" style="line-height: 1.2;">
                        W1<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">12/29</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w2&#39;)" style="line-height: 1.2;">
                        W2<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">1/5</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w3&#39;)" style="line-height: 1.2;">
                        W3<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">1/12</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w4&#39;)" style="line-height: 1.2;">
                        W4<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">1/19</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w5&#39;)" style="line-height: 1.2;">
                        W5<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">1/26</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w6&#39;)" style="line-height: 1.2;">
                        W6<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">2/2</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w7&#39;)" style="line-height: 1.2;">
                        W7<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">2/9</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w8&#39;)" style="line-height: 1.2;">
                        W8<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">2/16</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w9&#39;)" style="line-height: 1.2;">
                        W9<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">2/23</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w10&#39;)" style="line-height: 1.2;">
                        W10<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">3/2</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w11&#39;)" style="line-height: 1.2;">
                        W11<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">3/9</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w12&#39;)" style="line-height: 1.2;">
                        W12<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">3/16</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w13&#39;)" style="line-height: 1.2;">
                        W13<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">3/23</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w14&#39;)" style="line-height: 1.2;">
                        W14<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">3/30</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w15&#39;)" style="line-height: 1.2;">
                        W15<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">4/6</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w16&#39;)" style="line-height: 1.2;">
                        W16<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">4/13</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w17&#39;)" style="line-height: 1.2;">
                        W17<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">4/20</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w18&#39;)" style="line-height: 1.2;">
                        W18<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">4/27</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w19&#39;)" style="line-height: 1.2;">
                        W19<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">5/4</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w20&#39;)" style="line-height: 1.2;">
                        W20<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">5/11</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w21&#39;)" style="line-height: 1.2;">
                        W21<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">5/18</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w22&#39;)" style="line-height: 1.2;">
                        W22<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">5/25</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w23&#39;)" style="line-height: 1.2;">
                        W23<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">6/1</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w24&#39;)" style="line-height: 1.2;">
                        W24<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">6/8</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w25&#39;)" style="line-height: 1.2;">
                        W25<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">6/15</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w26&#39;)" style="line-height: 1.2;">
                        W26<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">6/22</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w27&#39;)" style="line-height: 1.2;">
                        W27<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">6/29</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w28&#39;)" style="line-height: 1.2;">
                        W28<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">7/6</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w29&#39;)" style="line-height: 1.2;">
                        W29<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">7/13</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w30&#39;)" style="line-height: 1.2;">
                        W30<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">7/20</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w31&#39;)" style="line-height: 1.2;">
                        W31<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">7/27</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w32&#39;)" style="line-height: 1.2;">
                        W32<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">8/3</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w33&#39;)" style="line-height: 1.2;">
                        W33<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">8/10</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w34&#39;)" style="line-height: 1.2;">
                        W34<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">8/17</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w35&#39;)" style="line-height: 1.2;">
                        W35<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">8/24</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w36&#39;)" style="line-height: 1.2;">
                        W36<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">8/31</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w37&#39;)" style="line-height: 1.2;">
                        W37<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">9/7</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w38&#39;)" style="line-height: 1.2;">
                        W38<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">9/14</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w39&#39;)" style="line-height: 1.2;">
                        W39<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">9/21</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w40&#39;)" style="line-height: 1.2;">
                        W40<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">9/28</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w41&#39;)" style="line-height: 1.2;">
                        W41<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">10/5</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w42&#39;)" style="line-height: 1.2;">
                        W42<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">10/12</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w43&#39;)" style="line-height: 1.2;">
                        W43<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">10/19</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w44&#39;)" style="line-height: 1.2;">
                        W44<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">10/26</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w45&#39;)" style="line-height: 1.2;">
                        W45<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">11/2</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w46&#39;)" style="line-height: 1.2;">
                        W46<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">11/9</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w47&#39;)" style="line-height: 1.2;">
                        W47<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">11/16</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w48&#39;)" style="line-height: 1.2;">
                        W48<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">11/23</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w49&#39;)" style="line-height: 1.2;">
                        W49<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">11/30</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w50&#39;)" style="line-height: 1.2;">
                        W50<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">12/7</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w51&#39;)" style="line-height: 1.2;">
                        W51<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">12/14</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w52&#39;)" style="line-height: 1.2;">
                        W52<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">12/21</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2026_w53&#39;)" style="line-height: 1.2;">
                        W53<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">12/28</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2027_w1&#39;)" style="line-height: 1.2;">
                        W1<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">1/4</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2027_w2&#39;)" style="line-height: 1.2;">
                        W2<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">1/11</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2027_w3&#39;)" style="line-height: 1.2;">
                        W3<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">1/18</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2027_w4&#39;)" style="line-height: 1.2;">
                        W4<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">1/25</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2027_w5&#39;)" style="line-height: 1.2;">
                        W5<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">2/1</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2027_w6&#39;)" style="line-height: 1.2;">
                        W6<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">2/8</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2027_w7&#39;)" style="line-height: 1.2;">
                        W7<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">2/15</span></th>
                    <th class="sortable time-col" onclick="handleSort(&#39;y2027_w8&#39;)" style="line-height: 1.2;">
                        W8<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">2/22</span></th>
                </tr>
            </thead>
            <tbody>
                <tr data-index="2" data-type="single">
                    <td class="col-region" rowspan="3" data-merged-indices="[2,1,0]"
                        style="position: sticky; left: 0px; z-index: 40; background-color: inherit; border-left: 1px solid rgb(221, 221, 221); border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <div
                            style="font-size:13px; padding:2px 16px 2px 8px; border:1px solid transparent; display:flex; align-items:center; justify-content:center; color:#333; white-space:nowrap;">
                            GL</div>
                    </td>
                    <td class="col-project" rowspan="3" data-merged-indices="[2,1,0]"
                        style="position: sticky; left: 66.8px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <div
                            style="font-size:13px; padding:2px 16px 2px 8px; border:1px solid transparent; display:flex; align-items:center; justify-content:center; color:#333; white-space:nowrap;">
                            Alpine</div>
                    </td>
                    <td class="col-category" rowspan="3" data-merged-indices="[2,1,0]"
                        style="position: sticky; left: 135.413px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <div
                            style="font-size:13px; padding:2px 16px 2px 8px; border:1px solid transparent; display:flex; align-items:center; justify-content:center; color:#333; white-space:nowrap;">
                            <span class="tag-npi">NPI</span></div>
                    </td>
                    <td class="col-macro" rowspan="3" data-merged-indices="[2,1,0]"
                        style="position: sticky; left: 197.888px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style=""
                            onchange="updateRowField(2, &#39;macro&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="FATP" selected="">FATP</option>
                            <option value="Packing">Packing</option>
                            <option value="SPA">SPA</option>
                        </select></td>
                    <td class="col-task" rowspan="3" data-merged-indices="[2,1,0]"
                        style="position: sticky; left: 277.688px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style="" onchange="updateRowField(2, &#39;task&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="Amotion" selected="">Amotion</option>
                            <option value="LMS">LMS</option>
                        </select></td>
                    <td class="col-subtask" rowspan="3" data-merged-indices="[2,1,0]"
                        style="position: sticky; left: 359.888px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style=""
                            onchange="updateRowField(2, &#39;subTask&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="C" selected="">C</option>
                        </select></td>
                    <td class="col-micro" rowspan="3" data-merged-indices="[2,1,0]"
                        style="position: sticky; left: 428.488px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style=""
                            onchange="updateRowField(2, &#39;micro&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="BG Line">BG Line</option>
                            <option value="CG Line">CG Line</option>
                            <option value="HSG Line" selected="">HSG Line</option>
                            <option value="Main">Main</option>
                        </select></td>
                    <td class="col-group" rowspan="3" data-merged-indices="[2,1,0]"
                        style="position: sticky; left: 517.088px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style=""
                            onchange="updateRowField(2, &#39;group&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="ËªüÈ´îÊáâÁî®" selected="">ËªüÈ´îÊáâÁî®</option>
                        </select></td>
                    <td class="col-name" rowspan="1" data-merged-indices="[2]"
                        style="position: sticky; left: 598.488px; z-index: 40; background-color: inherit; border-left: none; border-right: 2px solid rgb(144, 202, 249); box-shadow: rgba(0, 0, 0, 0.08) 2px 0px 5px;">
                        <select class="inline-select" style="" onchange="updateRowField(2, &#39;name&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="Èô≥Âª∑Â∏•1">Èô≥Âª∑Â∏•1</option>
                            <option value="Ë¢ÅÊ≠°">Ë¢ÅÊ≠°</option>
                            <option value="ÊûóÊúàÊ¶Æ" selected="">ÊûóÊúàÊ¶Æ</option>
                            <option value="Ê•äÁê¶">Ê•äÁê¶</option>
                            <option value="Èô≥Êñå">Èô≥Êñå</option>
                            <option value="ÊΩòË±™">ÊΩòË±™</option>
                            <option value="ÂúãËäÆ">ÂúãËäÆ</option>
                            <option value="ÈÑßÂøóÊµ©">ÈÑßÂøóÊµ©</option>
                            <option value="Âë®ÂÅ•">Âë®ÂÅ•</option>
                            <option value="Êñá‰øäÂá±">Êñá‰øäÂá±</option>
                            <option value="ÊùéÂø†Ë™†">ÊùéÂø†Ë™†</option>
                            <option value="Áî≥Èµ¨ÂÆá">Áî≥Èµ¨ÂÆá</option>
                        </select></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]">
                        <div
                            style="position:absolute; top:0; left:0; width:0; height:100%; z-index:5; pointer-events:none; overflow:visible;">
                            <div class="phase-bar" title="[NPI] P2 (2025-12-03~2026-01-03)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 0.2857142857142857); width: calc((var(--col-width) + 1px) * 4.571428569775132 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;P2</div>
                            <div class="phase-bar" title="[NPI] EVT (2026-03-11~2026-04-11)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 14.285714285714286); width: calc((var(--col-width) + 1px) * 4.571428569775132 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;EVT</div>
                            <div class="phase-bar" title="[NPI] CRB (2026-04-29~2026-05-29)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 21.285714285714285); width: calc((var(--col-width) + 1px) * 4.42857142691799 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;CRB</div>
                            <div class="phase-bar" title="[NPI] DVT (2026-06-17~2026-07-17)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 28.285714285714285); width: calc((var(--col-width) + 1px) * 4.42857142691799 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;DVT</div>
                            <div class="phase-bar" title="[NPI] PVTE (2026-07-22~2026-08-12)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 33.285714285714285); width: calc((var(--col-width) + 1px) * 3.1428571412037036 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;PVTE</div>
                        </div><input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2025_w49&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2025_w50&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2025_w51&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2025_w52&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w1&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w2&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w3&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w4&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w5&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w6&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w7&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w8&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w9&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w10&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="1.0"
                            min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w11&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w12&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w13&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w14&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w15&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w16&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w17&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w18&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w19&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w20&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w21&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w22&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w23&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w24&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w25&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w26&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w27&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w28&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w29&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w30&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w31&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w32&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[2]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(2, &#39;y2026_w33&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w34&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w35&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w36&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w37&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w38&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w39&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w40&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w41&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w42&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w43&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w44&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w45&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w46&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w47&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w48&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w49&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w50&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w51&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w52&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2026_w53&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2027_w1&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2027_w2&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2027_w3&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2027_w4&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2027_w5&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2027_w6&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2027_w7&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[2]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(2, &#39;y2027_w8&#39;, this.value)"></td>
                </tr>
                <tr data-index="1" data-type="single">
                    <td class="col-region merged-cell" rowspan="1" data-merged-indices="[1]"
                        style="display: none; position: sticky; left: 0px; z-index: 40; background-color: inherit; border-left: 1px solid rgb(221, 221, 221); border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <div
                            style="font-size:13px; padding:2px 16px 2px 8px; border:1px solid transparent; display:flex; align-items:center; justify-content:center; color:#333; white-space:nowrap;">
                            GL</div>
                    </td>
                    <td class="col-project merged-cell" rowspan="1" data-merged-indices="[1]"
                        style="display: none; position: sticky; left: 66.8px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <div
                            style="font-size:13px; padding:2px 16px 2px 8px; border:1px solid transparent; display:flex; align-items:center; justify-content:center; color:#333; white-space:nowrap;">
                            Alpine</div>
                    </td>
                    <td class="col-category merged-cell" rowspan="1" data-merged-indices="[1]"
                        style="display: none; position: sticky; left: 135.413px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <div
                            style="font-size:13px; padding:2px 16px 2px 8px; border:1px solid transparent; display:flex; align-items:center; justify-content:center; color:#333; white-space:nowrap;">
                            <span class="tag-npi">NPI</span></div>
                    </td>
                    <td class="col-macro merged-cell" rowspan="1" data-merged-indices="[1]"
                        style="display: none; position: sticky; left: 197.888px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style=""
                            onchange="updateRowField(1, &#39;macro&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="FATP" selected="">FATP</option>
                            <option value="Packing">Packing</option>
                            <option value="SPA">SPA</option>
                        </select></td>
                    <td class="col-task merged-cell" rowspan="1" data-merged-indices="[1]"
                        style="display: none; position: sticky; left: 277.688px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style="" onchange="updateRowField(1, &#39;task&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="Amotion" selected="">Amotion</option>
                            <option value="LMS">LMS</option>
                        </select></td>
                    <td class="col-subtask merged-cell" rowspan="1" data-merged-indices="[1]"
                        style="display: none; position: sticky; left: 359.888px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style=""
                            onchange="updateRowField(1, &#39;subTask&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="C" selected="">C</option>
                        </select></td>
                    <td class="col-micro merged-cell" rowspan="1" data-merged-indices="[1]"
                        style="display: none; position: sticky; left: 428.488px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style=""
                            onchange="updateRowField(1, &#39;micro&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="BG Line">BG Line</option>
                            <option value="CG Line">CG Line</option>
                            <option value="HSG Line" selected="">HSG Line</option>
                            <option value="Main">Main</option>
                        </select></td>
                    <td class="col-group merged-cell" rowspan="1" data-merged-indices="[1]"
                        style="display: none; position: sticky; left: 517.088px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style=""
                            onchange="updateRowField(1, &#39;group&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="ËªüÈ´îÊáâÁî®" selected="">ËªüÈ´îÊáâÁî®</option>
                        </select></td>
                    <td class="col-name" rowspan="1" data-merged-indices="[1]"
                        style="position: sticky; left: 598.488px; z-index: 40; background-color: inherit; border-left: none; border-right: 2px solid rgb(144, 202, 249); box-shadow: rgba(0, 0, 0, 0.08) 2px 0px 5px;">
                        <select class="inline-select" style="" onchange="updateRowField(1, &#39;name&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="Èô≥Âª∑Â∏•1">Èô≥Âª∑Â∏•1</option>
                            <option value="Ë¢ÅÊ≠°" selected="">Ë¢ÅÊ≠°</option>
                            <option value="ÊûóÊúàÊ¶Æ">ÊûóÊúàÊ¶Æ</option>
                            <option value="Ê•äÁê¶">Ê•äÁê¶</option>
                            <option value="Èô≥Êñå">Èô≥Êñå</option>
                            <option value="ÊΩòË±™">ÊΩòË±™</option>
                            <option value="ÂúãËäÆ">ÂúãËäÆ</option>
                            <option value="ÈÑßÂøóÊµ©">ÈÑßÂøóÊµ©</option>
                            <option value="Âë®ÂÅ•">Âë®ÂÅ•</option>
                            <option value="Êñá‰øäÂá±">Êñá‰øäÂá±</option>
                            <option value="ÊùéÂø†Ë™†">ÊùéÂø†Ë™†</option>
                            <option value="Áî≥Èµ¨ÂÆá">Áî≥Èµ¨ÂÆá</option>
                        </select></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]">
                        <div
                            style="position:absolute; top:0; left:0; width:0; height:100%; z-index:5; pointer-events:none; overflow:visible;">
                            <div class="phase-bar" title="[NPI] P2 (2025-12-03~2026-01-03)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 0.2857142857142857); width: calc((var(--col-width) + 1px) * 4.571428569775132 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;P2</div>
                            <div class="phase-bar" title="[NPI] EVT (2026-03-11~2026-04-11)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 14.285714285714286); width: calc((var(--col-width) + 1px) * 4.571428569775132 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;EVT</div>
                            <div class="phase-bar" title="[NPI] CRB (2026-04-29~2026-05-29)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 21.285714285714285); width: calc((var(--col-width) + 1px) * 4.42857142691799 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;CRB</div>
                            <div class="phase-bar" title="[NPI] DVT (2026-06-17~2026-07-17)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 28.285714285714285); width: calc((var(--col-width) + 1px) * 4.42857142691799 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;DVT</div>
                            <div class="phase-bar" title="[NPI] PVTE (2026-07-22~2026-08-12)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 33.285714285714285); width: calc((var(--col-width) + 1px) * 3.1428571412037036 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;PVTE</div>
                        </div><input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2025_w49&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2025_w50&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2025_w51&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2025_w52&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w1&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w2&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w3&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w4&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w5&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w6&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w7&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w8&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w9&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w10&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="1.0"
                            min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w11&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w12&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w13&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w14&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w15&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w16&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w17&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w18&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w19&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w20&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w21&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w22&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w23&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w24&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w25&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w26&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w27&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w28&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w29&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w30&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w31&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w32&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[1]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(1, &#39;y2026_w33&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w34&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w35&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w36&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w37&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w38&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w39&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w40&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w41&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w42&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w43&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w44&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w45&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w46&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w47&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w48&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w49&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w50&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w51&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w52&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2026_w53&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2027_w1&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2027_w2&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2027_w3&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2027_w4&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2027_w5&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2027_w6&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2027_w7&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[1]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(1, &#39;y2027_w8&#39;, this.value)"></td>
                </tr>
                <tr data-index="0" data-type="single">
                    <td class="col-region merged-cell" rowspan="1" data-merged-indices="[0]"
                        style="display: none; position: sticky; left: 0px; z-index: 40; background-color: inherit; border-left: 1px solid rgb(221, 221, 221); border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <div
                            style="font-size:13px; padding:2px 16px 2px 8px; border:1px solid transparent; display:flex; align-items:center; justify-content:center; color:#333; white-space:nowrap;">
                            GL</div>
                    </td>
                    <td class="col-project merged-cell" rowspan="1" data-merged-indices="[0]"
                        style="display: none; position: sticky; left: 66.8px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <div
                            style="font-size:13px; padding:2px 16px 2px 8px; border:1px solid transparent; display:flex; align-items:center; justify-content:center; color:#333; white-space:nowrap;">
                            Alpine</div>
                    </td>
                    <td class="col-category merged-cell" rowspan="1" data-merged-indices="[0]"
                        style="display: none; position: sticky; left: 135.413px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <div
                            style="font-size:13px; padding:2px 16px 2px 8px; border:1px solid transparent; display:flex; align-items:center; justify-content:center; color:#333; white-space:nowrap;">
                            <span class="tag-npi">NPI</span></div>
                    </td>
                    <td class="col-macro merged-cell" rowspan="1" data-merged-indices="[0]"
                        style="display: none; position: sticky; left: 197.888px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style=""
                            onchange="updateRowField(0, &#39;macro&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="FATP" selected="">FATP</option>
                            <option value="Packing">Packing</option>
                            <option value="SPA">SPA</option>
                        </select></td>
                    <td class="col-task merged-cell" rowspan="1" data-merged-indices="[0]"
                        style="display: none; position: sticky; left: 277.688px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style="" onchange="updateRowField(0, &#39;task&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="Amotion" selected="">Amotion</option>
                            <option value="LMS">LMS</option>
                        </select></td>
                    <td class="col-subtask merged-cell" rowspan="1" data-merged-indices="[0]"
                        style="display: none; position: sticky; left: 359.888px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style=""
                            onchange="updateRowField(0, &#39;subTask&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="C" selected="">C</option>
                        </select></td>
                    <td class="col-micro merged-cell" rowspan="1" data-merged-indices="[0]"
                        style="display: none; position: sticky; left: 428.488px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style=""
                            onchange="updateRowField(0, &#39;micro&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="BG Line">BG Line</option>
                            <option value="CG Line">CG Line</option>
                            <option value="HSG Line" selected="">HSG Line</option>
                            <option value="Main">Main</option>
                        </select></td>
                    <td class="col-group merged-cell" rowspan="1" data-merged-indices="[0]"
                        style="display: none; position: sticky; left: 517.088px; z-index: 40; background-color: inherit; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: none;">
                        <select class="inline-select" style=""
                            onchange="updateRowField(0, &#39;group&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="ËªüÈ´îÊáâÁî®" selected="">ËªüÈ´îÊáâÁî®</option>
                        </select></td>
                    <td class="col-name" rowspan="1" data-merged-indices="[0]"
                        style="position: sticky; left: 598.488px; z-index: 40; background-color: inherit; border-left: none; border-right: 2px solid rgb(144, 202, 249); box-shadow: rgba(0, 0, 0, 0.08) 2px 0px 5px;">
                        <select class="inline-select" style="" onchange="updateRowField(0, &#39;name&#39;, this.value)">
                            <option value="">Êú™ÊåáÂÆö</option>
                            <option value="Èô≥Âª∑Â∏•1" selected="">Èô≥Âª∑Â∏•1</option>
                            <option value="Ë¢ÅÊ≠°">Ë¢ÅÊ≠°</option>
                            <option value="ÊûóÊúàÊ¶Æ">ÊûóÊúàÊ¶Æ</option>
                            <option value="Ê•äÁê¶">Ê•äÁê¶</option>
                            <option value="Èô≥Êñå">Èô≥Êñå</option>
                            <option value="ÊΩòË±™">ÊΩòË±™</option>
                            <option value="ÂúãËäÆ">ÂúãËäÆ</option>
                            <option value="ÈÑßÂøóÊµ©">ÈÑßÂøóÊµ©</option>
                            <option value="Âë®ÂÅ•">Âë®ÂÅ•</option>
                            <option value="Êñá‰øäÂá±">Êñá‰øäÂá±</option>
                            <option value="ÊùéÂø†Ë™†">ÊùéÂø†Ë™†</option>
                            <option value="Áî≥Èµ¨ÂÆá">Áî≥Èµ¨ÂÆá</option>
                        </select></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]">
                        <div
                            style="position:absolute; top:0; left:0; width:0; height:100%; z-index:5; pointer-events:none; overflow:visible;">
                            <div class="phase-bar" title="[NPI] P2 (2025-12-03~2026-01-03)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 0.2857142857142857); width: calc((var(--col-width) + 1px) * 4.571428569775132 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;P2</div>
                            <div class="phase-bar" title="[NPI] EVT (2026-03-11~2026-04-11)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 14.285714285714286); width: calc((var(--col-width) + 1px) * 4.571428569775132 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;EVT</div>
                            <div class="phase-bar" title="[NPI] CRB (2026-04-29~2026-05-29)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 21.285714285714285); width: calc((var(--col-width) + 1px) * 4.42857142691799 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;CRB</div>
                            <div class="phase-bar" title="[NPI] DVT (2026-06-17~2026-07-17)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 28.285714285714285); width: calc((var(--col-width) + 1px) * 4.42857142691799 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;DVT</div>
                            <div class="phase-bar" title="[NPI] PVTE (2026-07-22~2026-08-12)"
                                style="top: 2px; left: calc((var(--col-width) + 1px) * 33.285714285714285); width: calc((var(--col-width) + 1px) * 3.1428571412037036 - 1px); background: #e1f5fe; color: #0288d1; border: 1px solid #81d4fa; border-radius: 3px;">
                                &nbsp;PVTE</div>
                        </div><input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2025_w49&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2025_w50&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2025_w51&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2025_w52&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w1&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w2&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w3&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w4&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w5&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w6&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w7&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w8&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w9&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w10&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="1.0"
                            min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w11&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w12&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w13&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w14&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w15&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w16&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w17&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w18&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w19&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w20&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w21&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w22&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w23&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w24&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w25&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w26&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w27&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w28&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w29&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w30&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w31&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w32&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; background-color: #fafcff;" rowspan="1"
                        data-merged-indices="[0]"><input type="number" class="inline-workload-input" value="" min="0.1"
                            max="1" step="0.05" onchange="updateInlineWorkload(0, &#39;y2026_w33&#39;, this.value)">
                    </td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w34&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w35&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w36&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w37&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w38&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w39&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w40&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w41&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w42&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w43&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w44&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w45&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w46&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w47&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w48&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w49&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w50&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w51&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w52&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2026_w53&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2027_w1&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2027_w2&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2027_w3&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2027_w4&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2027_w5&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2027_w6&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2027_w7&#39;, this.value)"></td>
                    <td class="time-col" style="padding-top: 24px !important; " rowspan="1" data-merged-indices="[0]">
                        <input type="number" class="inline-workload-input" value="" min="0.1" max="1" step="0.05"
                            onchange="updateInlineWorkload(0, &#39;y2027_w8&#39;, this.value)"></td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td class="col-region"
                        style="background-color: rgb(255, 224, 130); font-weight: bold; color: rgb(216, 67, 21); text-align: right; border-width: 2px 1px 1px; border-style: solid; border-color: rgb(255, 179, 0) rgb(221, 221, 221) rgb(221, 221, 221); position: sticky; left: 0px; z-index: 45; box-shadow: rgba(0, 0, 0, 0.1) 0px -2px 5px;">
                        Áï∂ÂâçÁ∏ΩË®à ‚ûî</td>
                    <td class="col-project"
                        style="background-color: rgb(255, 224, 130); font-weight: bold; color: rgb(216, 67, 21); text-align: right; border-top: 2px solid rgb(255, 179, 0); border-bottom: 1px solid rgb(221, 221, 221); position: sticky; left: 66.8px; z-index: 45; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: rgba(0, 0, 0, 0.1) 0px -2px 5px;">
                    </td>
                    <td class="col-category"
                        style="background-color: rgb(255, 224, 130); font-weight: bold; color: rgb(216, 67, 21); text-align: right; border-top: 2px solid rgb(255, 179, 0); border-bottom: 1px solid rgb(221, 221, 221); position: sticky; left: 135.413px; z-index: 45; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: rgba(0, 0, 0, 0.1) 0px -2px 5px;">
                    </td>
                    <td class="col-macro"
                        style="background-color: rgb(255, 224, 130); font-weight: bold; color: rgb(216, 67, 21); text-align: right; border-top: 2px solid rgb(255, 179, 0); border-bottom: 1px solid rgb(221, 221, 221); position: sticky; left: 197.888px; z-index: 45; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: rgba(0, 0, 0, 0.1) 0px -2px 5px;">
                    </td>
                    <td class="col-task"
                        style="background-color: rgb(255, 224, 130); font-weight: bold; color: rgb(216, 67, 21); text-align: right; border-top: 2px solid rgb(255, 179, 0); border-bottom: 1px solid rgb(221, 221, 221); position: sticky; left: 277.688px; z-index: 45; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: rgba(0, 0, 0, 0.1) 0px -2px 5px;">
                    </td>
                    <td class="col-subtask"
                        style="background-color: rgb(255, 224, 130); font-weight: bold; color: rgb(216, 67, 21); text-align: right; border-top: 2px solid rgb(255, 179, 0); border-bottom: 1px solid rgb(221, 221, 221); position: sticky; left: 359.888px; z-index: 45; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: rgba(0, 0, 0, 0.1) 0px -2px 5px;">
                    </td>
                    <td class="col-micro"
                        style="background-color: rgb(255, 224, 130); font-weight: bold; color: rgb(216, 67, 21); text-align: right; border-top: 2px solid rgb(255, 179, 0); border-bottom: 1px solid rgb(221, 221, 221); position: sticky; left: 428.488px; z-index: 45; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: rgba(0, 0, 0, 0.1) 0px -2px 5px;">
                    </td>
                    <td class="col-group"
                        style="background-color: rgb(255, 224, 130); font-weight: bold; color: rgb(216, 67, 21); text-align: right; border-top: 2px solid rgb(255, 179, 0); border-bottom: 1px solid rgb(221, 221, 221); position: sticky; left: 517.088px; z-index: 45; border-left: none; border-right: 1px solid rgb(221, 221, 221); box-shadow: rgba(0, 0, 0, 0.1) 0px -2px 5px;">
                    </td>
                    <td class="col-name"
                        style="background-color: rgb(255, 224, 130); font-weight: bold; color: rgb(216, 67, 21); text-align: right; border-top: 2px solid rgb(255, 179, 0); border-bottom: 1px solid rgb(221, 221, 221); position: sticky; left: 598.488px; z-index: 45; border-left: none; border-right: 2px solid rgb(144, 202, 249); box-shadow: rgba(0, 0, 0, 0.1) 2px -2px 5px;">
                    </td>
                    <td id="footer_y2025_w49"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2025_w50"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2025_w51"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2025_w52"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w1"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w2"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w3"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w4"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w5"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w6"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w7"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w8"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w9"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w10"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w11"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                        3</td>
                    <td id="footer_y2026_w12"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w13"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w14"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w15"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w16"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w17"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w18"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w19"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w20"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w21"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w22"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w23"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w24"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w25"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w26"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w27"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w28"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w29"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w30"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w31"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w32"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w33"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w34"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w35"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w36"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w37"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w38"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w39"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w40"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w41"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w42"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w43"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w44"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w45"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w46"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w47"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w48"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w49"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w50"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w51"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w52"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2026_w53"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2027_w1"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2027_w2"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2027_w3"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2027_w4"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2027_w5"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2027_w6"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2027_w7"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                    <td id="footer_y2027_w8"
                        style="font-weight: bold; color: #d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>

    <div id="customContextMenu" class="context-menu" style="display: none; left: 1183px; top: 323px;">
        <div id="cm-header">üéØ ÂñÆÁ≠ÜË≥áÊñôÊìç‰Ωú</div>
        <div id="cm-edit" class="context-menu-item" onclick="cmAction(&#39;edit&#39;)">‚úèÔ∏è ÈÄ≤ÈöéÁ∑®ËºØÊ≠§Á≠ÜË≥áÊñô</div>
        <div id="cm-duplicate" class="context-menu-item" onclick="cmAction(&#39;duplicate&#39;)">üìÑ Ë§áË£ΩÊ≠§ÂàóÂêë‰∏ã</div>
        <div id="cm-delete" class="context-menu-item danger" onclick="cmAction(&#39;delete&#39;)">üóëÔ∏è Âà™Èô§Ê≠§Á≠ÜË≥áÊñô</div>
    </div>

    <div id="recoveryModal" class="modal">
        <div class="modal-content" style="max-width: 650px;">
            <div class="modal-header">
                <h3>üïí Ê≠∑Âè≤Ë≥áÊñôËàáË®≠ÂÆöÊïëÊè¥</h3>
                <span class="close" onclick="closeModal(&#39;recoveryModal&#39;)">√ó</span>
            </div>
            <div class="modal-body">
                <p style="color:#555; font-size:14px; margin-bottom: 15px;">Á≥ªÁµ±Â∑≤ÊéÉÊèèÊÇ®Âú®Ê≠§ÈõªËÖ¶‰∏äÊâÄÊúâÊõæÁ∂ìËº∏ÂÖ•ÈÅéÁöÑÁâàÊú¨„ÄÇ</p>
                <div style="max-height: 400px; overflow-y:auto;">
                    <table class="db-table" id="recoveryTable">
                        <thead>
                            <tr>
                                <th>ÁâàÊú¨ÂêçÁ®± (ÂÖßÈÉ® Key)</th>
                                <th>Á∏ΩË°®Ë≥áÊñôÁ≠ÜÊï∏</th>
                                <th style="width: 180px;">Êìç‰Ωú</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div id="dataModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Êñ∞Â¢û/Á∑®ËºØË≥áÊñô <span
                        style="font-size:14px;color:#f57f17;font-weight:normal;margin-left:10px;">(‰Ω†ÁèæÂú®ÂèØ‰ª•Áõ¥Êé•ÁïôÁ©∫ÂßìÂêçÔºåÂ≠òÊ™îÂæåÂÜçÂæû‰∏ªÈ†ÅÊåáÊ¥æÔºÅ)</span>
                </h3>
                <span class="close" onclick="closeModal(&#39;dataModal&#39;)">√ó</span>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editIndex" value="-1">

                <div class="relation-container" style="background-color: #fff8e1; border-color: #ffe082;">
                    <div class="check-group"><label class="title" style="color:#f57f17;">1. ÈÅ∏ÊìáÂú∞ÂçÄ <span>üìå
                                ÂøÖÈÅ∏</span></label>
                        <div id="cl_region" class="check-list"><span style="color:#aaa; font-size:11px;">Â∞öÁÑ°Ë®≠ÂÆö</span>
                        </div>
                    </div>
                    <div class="check-group" id="block_project" style="display: none;"><label class="title"
                            style="color:#f57f17;">2. ÈÅ∏ÊìáÂ∞àÊ°à <span>üìå ÂøÖÈÅ∏</span></label>
                        <div id="cl_project" class="check-list"><span style="color:#aaa; font-size:11px;">Â∞öÁÑ°Ë®≠ÂÆö</span>
                        </div>
                    </div>
                    <div class="check-group" id="block_category" style="display: none;"><label class="title"
                            style="color:#f57f17;">3. ÈÅ∏ÊìáÈ°ûÂà• <span>üìå ÂøÖÈÅ∏</span></label>
                        <div id="cl_category" class="check-list"><button type="button"
                                class="check-btn  ">NPI</button><button type="button" class="check-btn  ">Ops.</button>
                        </div>
                    </div>
                </div>

                <div id="block_details" class="step-hidden">
                    <div class="relation-container" style="background-color: #e0f2f1; border-color: #80cbc4;">
                        <div class="check-group"><label class="title" style="color:#00695c;">ÈÅ∏ÊìáÂ§ßË£ΩÁ®ã</label>
                            <div id="cl_macro" class="check-list"><span style="color:#aaa; font-size:11px;">Â∞öÁÑ°Ë®≠ÂÆö</span>
                            </div>
                        </div>
                        <div class="check-group"><label class="title" style="color:#00695c;">ÈÅ∏ÊìáÂ∞èË£ΩÁ®ã <span
                                    style="font-size:12px; color:#c62828; font-weight:bold; margin-left:8px;">‚Äª
                                    ÂãæÈÅ∏Â§öÂÄãÊôÇÔºåÊúÉËá™ÂãïÂàÜÊãÜ</span></label>
                            <div id="cl_micro" class="check-list"
                                style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px;"><span
                                    style="color:#f57c00; font-size:12px; font-weight:bold; grid-column: 1 / -1; margin-top: 5px;">üîí
                                    Ë´ãÂÖàÈÅ∏ÊìáÂ∑¶ÂÅ¥ÁöÑ„ÄåÂ§ßË£ΩÁ®ã„Äç‰ª•Ëß£ÈéñÂ∞èË£ΩÁ®ã</span></div>
                        </div>
                    </div>

                    <div class="relation-container" style="background-color: #e8f5e9; border-color: #a5d6a7;">
                        <div class="check-group"><label class="title" style="color:#2e7d32;">ÈÅ∏Êìá‰∏ª‰∫ãÈ†Ö</label>
                            <div id="cl_task" class="check-list"
                                style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px;"><span
                                    style="color:#aaa; font-size:11px;">Â∞öÁÑ°Ë®≠ÂÆö</span></div>
                        </div>
                        <div class="check-group"><label class="title" style="color:#2e7d32;">ÈÅ∏ÊìáÁ∂ÅÂÆöÁöÑÂ∞è‰∫ãÈ†Ö</label>
                            <div id="cl_subTask" class="check-list"
                                style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px;"><span
                                    style="color:#f57c00; font-size:12px; font-weight:bold; grid-column: 1 / -1; margin-top: 5px;">üîí
                                    Ë´ãÂÖàÈÅ∏ÊìáÂ∑¶ÂÅ¥ÁöÑ„Äå‰∏ª‰∫ãÈ†Ö„Äç‰ª•Ëß£ÈéñÂ∞è‰∫ãÈ†Ö</span></div>
                        </div>
                    </div>

                    <div style="text-align: center; margin: 15px 0;">
                        <button type="button" id="btn_toggle_advanced" onclick="toggleAdvancedScheduling()"
                            style="background-color: #f8fafc; color: #475569; border: 1px dashed #cbd5e1; width: 100%; padding: 10px; font-weight: bold; font-size: 14px; cursor: pointer; border-radius: 6px; transition: 0.2s;">üîΩ
                            Â±ïÈñãÈÄ≤ÈöéÊéíÁ®ã (Èï∑ÊúüÊâπÊ¨°ÊåáÊ¥æ‰∫∫Âì°ËàáÈÄ±Ê¨äÈáç)</button>
                    </div>

                    <div id="advanced_scheduling_block"
                        style="display: none; border: 2px solid #e2e8f0; padding: 15px; border-radius: 8px; background: #fafaf9; margin-bottom: 15px;">
                        <div class="relation-container" style="background-color: #f0f8ff; margin-bottom: 0;">
                            <div class="check-group"><label class="title">ÈÅ∏ÊìáÁµÑÂà•</label>
                                <div id="cl_group" class="check-list"><span
                                        style="color:#aaa; font-size:11px;">Â∞öÁÑ°Ë®≠ÂÆö</span></div>
                            </div>
                            <div class="check-group" style="flex:2;"><label class="title">ÈÅ∏ÊìáÂßìÂêç</label>
                                <div id="cl_name" class="check-list"
                                    style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 6px;"><span
                                        style="color:#f57c00; font-size:12px; font-weight:bold; grid-column: 1 / -1; margin-top: 5px;">üîí
                                        Ëã•‰∏çÈÅ∏ÁµÑÂà•ÔºåÂèØÁõ¥Êé•ÂõûÂà∞‰∏ªÈ†Å‰∏ãÊãâÈÅ∏ÂñÆÊåáÊ¥æ</span></div>
                            </div>
                        </div>

                        <hr style="border-top: 1px dashed #ccc; margin: 15px 0;">
                        <label
                            style="font-weight:bold; margin-bottom:5px; display:flex; justify-content:space-between; align-items:center; color:#00695c;">
                            <span>Âª∫Á´ãÂ∞àÊ°à‰∫∫ÂäõÂàÜÈÖç (WÈÄ±Ê¨äÈáç)</span>
                            <div id="unassigned_count_container"
                                style="display: flex; background: rgb(255, 243, 224); padding: 4px 10px; border-radius: 6px; border: 1px solid rgb(255, 179, 0); align-items: center; gap: 8px;">
                                <span style="font-size:13px; color:#e65100; font-weight:bold;">Êú™ÊåáÊ¥æÂßìÂêçÔºåÈ†êÁïôÂêçÈ°çÊï∏Ôºö</span>
                                <input type="number" id="unassignedCount" value="1" min="1" max="50"
                                    style="width:50px; text-align:center; border:1px solid #ffb300; border-radius:4px; padding:2px; outline:none;">
                            </div>
                        </label>

                        <div class="gantt-wrapper" style="margin-bottom: 0;">
                            <div class="gantt-scroll-area">
                                <div id="gantt_container_parent" class="gantt-container-parent"
                                    style="width: calc(var(--col-width) * 65); margin-left: 80px; display: none;">
                                    <div class="gantt-container" id="gantt_container">
                                        <div class="gantt-grid" id="gantt_grid"
                                            style="grid-template-columns: repeat(65, 1fr);">
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                            <div></div>
                                        </div>
                                        <div id="gantt_bars"
                                            style="width: 100%; height: 100%; position: absolute; top:0; left:0; overflow:hidden;">
                                        </div>
                                    </div>
                                </div>
                                <div class="workload-header-grid" id="modal_workload_headers"
                                    style="grid-template-columns: 80px repeat(65, var(--col-width));">
                                    <div style="grid-column: 2 / span 65; grid-row: 1; padding: 0; margin-bottom: 2px;">
                                        <div
                                            style="display: flex; width: 100%; height: 100%; border-radius: 4px; overflow: hidden; border: 1px solid #90caf9;">
                                            <div
                                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2025Âπ¥ 12Êúà</div>
                                            <div
                                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2026Âπ¥ 1Êúà</div>
                                            <div
                                                style="width: 6.153846153846154%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2026Âπ¥ 2Êúà</div>
                                            <div
                                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2026Âπ¥ 3Êúà</div>
                                            <div
                                                style="width: 6.593406593406594%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2026Âπ¥ 4Êúà</div>
                                            <div
                                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2026Âπ¥ 5Êúà</div>
                                            <div
                                                style="width: 6.593406593406594%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2026Âπ¥ 6Êúà</div>
                                            <div
                                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2026Âπ¥ 7Êúà</div>
                                            <div
                                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2026Âπ¥ 8Êúà</div>
                                            <div
                                                style="width: 6.593406593406594%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2026Âπ¥ 9Êúà</div>
                                            <div
                                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2026Âπ¥ 10Êúà</div>
                                            <div
                                                style="width: 6.593406593406594%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2026Âπ¥ 11Êúà</div>
                                            <div
                                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2026Âπ¥ 12Êúà</div>
                                            <div
                                                style="width: 6.813186813186813%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2027Âπ¥ 1Êúà</div>
                                            <div
                                                style="width: 6.153846153846154%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">
                                                2027Âπ¥ 2Êúà</div>
                                        </div>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 1 / span 2; grid-column: 1; background:#f8fafc; justify-content:center; display:flex; align-items:center; border:none; border-right:2px solid #94a3b8; border-bottom:1px solid #cbd5e1; position:sticky; left:0; top:0; z-index:50; box-shadow: 3px 0 6px rgba(0,0,0,0.1); font-size: 13px; color: #334155;">
                                        ‰∫∫Âì°</div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 2; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W49 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2025_w49&#39;)">W49<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">12/1</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 3; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W50 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2025_w50&#39;)">W50<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">12/8</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 4; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W51 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2025_w51&#39;)">W51<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">12/15</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 5; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W52 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2025_w52&#39;)">W52<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">12/22</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 6; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W1 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w1&#39;)">W1<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">12/29</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 7; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W2 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w2&#39;)">W2<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">1/5</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 8; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W3 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w3&#39;)">W3<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">1/12</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 9; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W4 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w4&#39;)">W4<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">1/19</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 10; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W5 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w5&#39;)">W5<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">1/26</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 11; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W6 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w6&#39;)">W6<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">2/2</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 12; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W7 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w7&#39;)">W7<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">2/9</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 13; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W8 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w8&#39;)">W8<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">2/16</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 14; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W9 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w9&#39;)">W9<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">2/23</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 15; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W10 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w10&#39;)">W10<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">3/2</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 16; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W11 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w11&#39;)">W11<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">3/9</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 17; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W12 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w12&#39;)">W12<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">3/16</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 18; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W13 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w13&#39;)">W13<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">3/23</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 19; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W14 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w14&#39;)">W14<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">3/30</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 20; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W15 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w15&#39;)">W15<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">4/6</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 21; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W16 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w16&#39;)">W16<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">4/13</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 22; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W17 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w17&#39;)">W17<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">4/20</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 23; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W18 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w18&#39;)">W18<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">4/27</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 24; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W19 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w19&#39;)">W19<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">5/4</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 25; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W20 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w20&#39;)">W20<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">5/11</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 26; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W21 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w21&#39;)">W21<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">5/18</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 27; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W22 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w22&#39;)">W22<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">5/25</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 28; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W23 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w23&#39;)">W23<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">6/1</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 29; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W24 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w24&#39;)">W24<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">6/8</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 30; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W25 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w25&#39;)">W25<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">6/15</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 31; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W26 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w26&#39;)">W26<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">6/22</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 32; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W27 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w27&#39;)">W27<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">6/29</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 33; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W28 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w28&#39;)">W28<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">7/6</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 34; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W29 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w29&#39;)">W29<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">7/13</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 35; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W30 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w30&#39;)">W30<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">7/20</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 36; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W31 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w31&#39;)">W31<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">7/27</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 37; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W32 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w32&#39;)">W32<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">8/3</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 38; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W33 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w33&#39;)">W33<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">8/10</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 39; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W34 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w34&#39;)">W34<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">8/17</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 40; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W35 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w35&#39;)">W35<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">8/24</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 41; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W36 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w36&#39;)">W36<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">8/31</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 42; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W37 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w37&#39;)">W37<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">9/7</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 43; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W38 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w38&#39;)">W38<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">9/14</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 44; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W39 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w39&#39;)">W39<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">9/21</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 45; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W40 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w40&#39;)">W40<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">9/28</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 46; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W41 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w41&#39;)">W41<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">10/5</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 47; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W42 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w42&#39;)">W42<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">10/12</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 48; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W43 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w43&#39;)">W43<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">10/19</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 49; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W44 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w44&#39;)">W44<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">10/26</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 50; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W45 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w45&#39;)">W45<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">11/2</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 51; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W46 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w46&#39;)">W46<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">11/9</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 52; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W47 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w47&#39;)">W47<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">11/16</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 53; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W48 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w48&#39;)">W48<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">11/23</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 54; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W49 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w49&#39;)">W49<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">11/30</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 55; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W50 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w50&#39;)">W50<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">12/7</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 56; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W51 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w51&#39;)">W51<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">12/14</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 57; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W52 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w52&#39;)">W52<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">12/21</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 58; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W53 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2026_w53&#39;)">W53<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">12/28</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 59; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W1 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2027_w1&#39;)">W1<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">1/4</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 60; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W2 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2027_w2&#39;)">W2<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">1/11</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 61; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W3 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2027_w3&#39;)">W3<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">1/18</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 62; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W4 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2027_w4&#39;)">W4<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">1/25</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 63; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W5 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2027_w5&#39;)">W5<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">2/1</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 64; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W6 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2027_w6&#39;)">W6<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">2/8</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 65; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W7 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2027_w7&#39;)">W7<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">2/15</span>
                                    </div>
                                    <div class="workload-header"
                                        style="grid-row: 2; grid-column: 66; cursor:pointer; line-height: 1.2;"
                                        title="Ê∏ÖÈô§ W8 ÂàÜÈÖç" onclick="clearWeekWorkload(&#39;y2027_w8&#39;)">W8<br><span
                                            style="font-size: 9px; font-weight: normal; color: #78909c;">2/22</span>
                                    </div>
                                </div>
                                <div id="workload_rows" class="workload-rows-container">
                                    <div class="workload-row"
                                        style="grid-template-columns: 80px repeat(65, var(--col-width));">
                                        <div class="workload-row-name" title="ÈªûÊìäÊ∏ÖÈô§"
                                            style="cursor:pointer; position:sticky; left:0; z-index:40; background:#f0f8ff; border-right:2px solid #94a3b8; box-shadow: 3px 0 6px rgba(0,0,0,0.08); display:flex; align-items:center; justify-content:center;"
                                            onclick="clearPersonWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;)">Êú™ÊåáÂÆöÂßìÂêç</div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2025_w49&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2025_w50&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2025_w51&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2025_w52&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w1&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w2&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w3&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w4&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w5&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w6&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w7&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w8&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w9&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w10&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w11&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w12&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w13&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w14&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w15&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w16&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w17&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w18&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w19&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w20&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w21&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w22&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w23&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w24&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w25&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w26&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w27&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w28&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w29&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w30&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w31&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w32&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w33&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w34&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w35&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w36&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w37&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w38&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w39&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w40&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w41&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w42&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w43&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w44&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w45&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w46&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w47&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w48&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w49&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w50&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w51&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w52&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2026_w53&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2027_w1&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2027_w2&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2027_w3&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2027_w4&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2027_w5&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2027_w6&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2027_w7&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                        <div style="padding:0 1px;"><input type="number" class="workload-input-modal"
                                                value="" min="0.1" max="1" step="0.05"
                                                oninput="updateWorkload(&#39;Êú™ÊåáÂÆöÂßìÂêç&#39;, &#39;y2027_w8&#39;, this.value)"
                                                style="border-right:1px solid #eee;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeModal(&#39;dataModal&#39;)">ÂèñÊ∂à</button>
                <button id="btn_save_data" onclick="saveDataRow()" disabled="" style="opacity: 0.5;">üíæ Á¢∫Ë™çÂÑ≤Â≠òËá≥Á∏ΩË°®</button>
            </div>
        </div>
    </div>

    <div id="dbModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚öôÔ∏è ÁÆ°ÁêÜÈóúËÅØË≥áÊñôÂ∫´</h3>
                <span class="close" onclick="closeModal(&#39;dbModal&#39;)">√ó</span>
            </div>
            <datalist id="dl_groups">
                <option value="ËªüÈ´îÊáâÁî®"></option>
            </datalist><datalist id="dl_names">
                <option value="Èô≥Âª∑Â∏•1"></option>
                <option value="Ë¢ÅÊ≠°"></option>
                <option value="ÊûóÊúàÊ¶Æ"></option>
                <option value="Ê•äÁê¶"></option>
                <option value="Èô≥Êñå"></option>
                <option value="ÊΩòË±™"></option>
                <option value="ÂúãËäÆ"></option>
                <option value="ÈÑßÂøóÊµ©"></option>
                <option value="Âë®ÂÅ•"></option>
                <option value="Êñá‰øäÂá±"></option>
                <option value="ÊùéÂø†Ë™†"></option>
                <option value="Áî≥Èµ¨ÂÆá"></option>
            </datalist>
            <datalist id="dl_regions">
                <option value="GL"></option>
                <option value="ZZ"></option>
            </datalist><datalist id="dl_projects">
                <option value="Alpine"></option>
                <option value="Mistral"></option>
                <option value="Elva"></option>
                <option value="Blanc"></option>
            </datalist>
            <datalist id="dl_macros">
                <option value="FATP"></option>
                <option value="Packing"></option>
                <option value="SPA"></option>
            </datalist><datalist id="dl_micros">
                <option value="BG Line"></option>
                <option value="CG Line"></option>
                <option value="HSG Line"></option>
                <option value=""></option>
                <option value="Main"></option>
            </datalist>
            <datalist id="dl_tasks">
                <option value="Amotion"></option>
                <option value="LMS"></option>
            </datalist>
            <div class="db-tabs">
                <button class="db-tab-btn" onclick="switchDbTab(&#39;rp&#39;)">1. Âú∞ÂçÄ ‚Üî Â∞àÊ°à</button>
                <button class="db-tab-btn" onclick="switchDbTab(&#39;milestone&#39;)">2. ÈöéÊÆµÊôÇÁ®ã</button>
                <button class="db-tab-btn" style="background:#e0f2f1; color:#00695c;"
                    onclick="switchDbTab(&#39;process&#39;)">3. Â§ßÂ∞èË£ΩÁ®ã</button>
                <button class="db-tab-btn" onclick="switchDbTab(&#39;group&#39;)">4. ÁµÑÂà• ‚ûî ÂßìÂêç</button>
                <button class="db-tab-btn" style="background: rgb(76, 175, 80); color: white;"
                    onclick="switchDbTab(&#39;task&#39;)">5.
                    ‰∫ãÈ†ÖÁ∂ÅÂÆö</button>
            </div>

            <div id="tab_rp" class="db-tab-content">
                <div class="action-bar" style="background: #fff8e1; border-color: #ffe082;">
                    <input type="text" list="dl_regions" id="rp_region" placeholder="Ëº∏ÂÖ•Âú∞ÂçÄ..." oninput="applyRpFilter()">
                    <input type="text" list="dl_projects" id="rp_project" placeholder="Ëº∏ÂÖ•Â∞àÊ°à..."
                        oninput="applyRpFilter()">
                    <button onclick="addDbRpLink()" style="background:#ff9800;">Êñ∞Â¢û</button>
                </div>
                <table class="db-table">
                    <tbody id="db_rp_list">
                        <tr>
                            <td>GL</td>
                            <td>Alpine</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;rp&#39;, 0)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;rp&#39;, 0)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Mistral</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;rp&#39;, 2)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;rp&#39;, 2)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Blanc</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;rp&#39;, 5)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;rp&#39;, 5)">Âà™Èô§</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="tab_milestone" class="db-tab-content">
                <div class="action-bar" style="background: #e1f5fe; border: 1px solid #81d4fa;">
                    <select id="ms_rp" style="flex: 2;" onchange="applyMilestoneFilter()">
                        <option value="">-- ÈÅ∏ÊìáÂú∞ÂçÄ/Â∞àÊ°à --</option>
                        <option value="GL|Alpine">GL - Alpine</option>
                        <option value="ZZ|Alpine">ZZ - Alpine</option>
                        <option value="GL|Mistral">GL - Mistral</option>
                        <option value="ZZ|Mistral">ZZ - Mistral</option>
                        <option value="ZZ|Elva">ZZ - Elva</option>
                        <option value="GL|Blanc">GL - Blanc</option>
                    </select>
                    <select id="ms_category" style="max-width: 100px;" onchange="applyMilestoneFilter()">
                        <option value="NPI">NPI</option>
                        <option value="Ops.">Ops.</option>
                    </select>
                    <input type="text" id="ms_phase" placeholder="ÈöéÊÆµ(Â¶ÇP2)" style="max-width: 110px;">
                    <input type="date" id="ms_start"> ~ <input type="date" id="ms_end">
                    <button onclick="addDbMilestone()" style="background:#0288d1;">Êñ∞Â¢û</button>
                </div>
                <table class="db-table">
                    <tbody id="db_milestone_list">
                        <tr>
                            <td>GL</td>
                            <td>Blanc</td>
                            <td><span class="tag-npi">NPI</span></td>
                            <td style="font-weight:bold;">P1</td>
                            <td>2025-11-24</td>
                            <td>2026-03-27</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;milestone&#39;, 29)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;milestone&#39;, 29)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Alpine</td>
                            <td><span class="tag-npi">NPI</span></td>
                            <td style="font-weight:bold;">P2</td>
                            <td>2025-12-03</td>
                            <td>2026-01-03</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;milestone&#39;, 0)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;milestone&#39;, 0)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Mistral</td>
                            <td><span class="tag-npi">NPI</span></td>
                            <td style="font-weight:bold;">P2</td>
                            <td>2025-12-10</td>
                            <td>2026-01-10</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;milestone&#39;, 12)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;milestone&#39;, 12)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Alpine</td>
                            <td><span class="tag-npi">NPI</span></td>
                            <td style="font-weight:bold;">EVT</td>
                            <td>2026-03-11</td>
                            <td>2026-04-11</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;milestone&#39;, 1)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;milestone&#39;, 1)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Mistral</td>
                            <td><span class="tag-npi">NPI</span></td>
                            <td style="font-weight:bold;">EVT</td>
                            <td>2026-03-18</td>
                            <td>2026-04-18</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;milestone&#39;, 13)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;milestone&#39;, 13)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Alpine</td>
                            <td><span class="tag-npi">NPI</span></td>
                            <td style="font-weight:bold;">CRB</td>
                            <td>2026-04-29</td>
                            <td>2026-05-29</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;milestone&#39;, 2)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;milestone&#39;, 2)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Mistral</td>
                            <td><span class="tag-npi">NPI</span></td>
                            <td style="font-weight:bold;">CRB</td>
                            <td>2026-05-06</td>
                            <td>2026-06-06</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;milestone&#39;, 14)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;milestone&#39;, 14)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Alpine</td>
                            <td><span class="tag-npi">NPI</span></td>
                            <td style="font-weight:bold;">DVT</td>
                            <td>2026-06-17</td>
                            <td>2026-07-17</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;milestone&#39;, 3)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;milestone&#39;, 3)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Mistral</td>
                            <td><span class="tag-npi">NPI</span></td>
                            <td style="font-weight:bold;">DVT</td>
                            <td>2026-06-24</td>
                            <td>2026-07-24</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;milestone&#39;, 15)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;milestone&#39;, 15)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Blanc</td>
                            <td><span class="tag-npi">NPI</span></td>
                            <td style="font-weight:bold;">EVT</td>
                            <td>2026-06-29</td>
                            <td>2026-07-29</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;milestone&#39;, 30)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;milestone&#39;, 30)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Alpine</td>
                            <td><span class="tag-npi">NPI</span></td>
                            <td style="font-weight:bold;">PVTE</td>
                            <td>2026-07-22</td>
                            <td>2026-08-12</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;milestone&#39;, 4)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;milestone&#39;, 4)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Mistral</td>
                            <td><span class="tag-npi">NPI</span></td>
                            <td style="font-weight:bold;">PVTE</td>
                            <td>2026-07-29</td>
                            <td>2026-08-19</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;milestone&#39;, 16)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;milestone&#39;, 16)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Blanc</td>
                            <td><span class="tag-npi">NPI</span></td>
                            <td style="font-weight:bold;">DVT</td>
                            <td>2026-12-07</td>
                            <td>2026-12-27</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;milestone&#39;, 31)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;milestone&#39;, 31)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>GL</td>
                            <td>Blanc</td>
                            <td><span class="tag-npi">NPI</span></td>
                            <td style="font-weight:bold;">PVTE</td>
                            <td>2027-01-25</td>
                            <td>2027-02-25</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;milestone&#39;, 32)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;milestone&#39;, 32)">Âà™Èô§</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="tab_process" class="db-tab-content">
                <div class="action-bar" style="background: #e0f2f1; border-color: #b2dfdb;">
                    <input type="text" list="dl_macros" id="proc_macro" placeholder="Â§ßË£ΩÁ®ã..."
                        oninput="applyProcessFilter()">
                    <input type="text" list="dl_micros" id="proc_micro" placeholder="Â∞èË£ΩÁ®ã..."
                        oninput="applyProcessFilter()">
                    <button onclick="addDbProcessLink()" style="background:#00897b;">Êñ∞Â¢û</button>
                </div>
                <table class="db-table">
                    <tbody id="db_process_list">
                        <tr>
                            <td>FATP</td>
                            <td>BG Line</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;process&#39;, 0)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;process&#39;, 0)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>FATP</td>
                            <td>CG Line</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;process&#39;, 1)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;process&#39;, 1)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>FATP</td>
                            <td>HSG Line</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;process&#39;, 2)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;process&#39;, 2)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>Packing</td>
                            <td></td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;process&#39;, 3)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;process&#39;, 3)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>SPA</td>
                            <td></td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;process&#39;, 4)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;process&#39;, 4)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>FATP</td>
                            <td>Main</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;process&#39;, 5)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;process&#39;, 5)">Âà™Èô§</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="tab_group" class="db-tab-content">
                <div class="action-bar" style="background: #fce4ec; border-color: #f8bbd0;">
                    <input type="text" list="dl_groups" id="grp_group" placeholder="ÁµÑÂà•..." oninput="applyGroupFilter()">
                    <input type="text" list="dl_names" id="grp_name" placeholder="ÂßìÂêç..." oninput="applyGroupFilter()">
                    <button onclick="addDbGroupLink()" style="background:#e91e63;">Êñ∞Â¢û</button>
                </div>
                <table class="db-table">
                    <tbody id="db_group_list">
                        <tr>
                            <td>ËªüÈ´îÊáâÁî®</td>
                            <td>Èô≥Âª∑Â∏•1</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;group&#39;, 0)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;group&#39;, 0)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>ËªüÈ´îÊáâÁî®</td>
                            <td>Ë¢ÅÊ≠°</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;group&#39;, 1)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;group&#39;, 1)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>ËªüÈ´îÊáâÁî®</td>
                            <td>ÊûóÊúàÊ¶Æ</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;group&#39;, 2)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;group&#39;, 2)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>ËªüÈ´îÊáâÁî®</td>
                            <td>Ê•äÁê¶</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;group&#39;, 3)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;group&#39;, 3)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>ËªüÈ´îÊáâÁî®</td>
                            <td>Èô≥Êñå</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;group&#39;, 4)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;group&#39;, 4)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>ËªüÈ´îÊáâÁî®</td>
                            <td>ÊΩòË±™</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;group&#39;, 5)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;group&#39;, 5)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>ËªüÈ´îÊáâÁî®</td>
                            <td>ÂúãËäÆ</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;group&#39;, 6)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;group&#39;, 6)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>ËªüÈ´îÊáâÁî®</td>
                            <td>ÈÑßÂøóÊµ©</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;group&#39;, 7)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;group&#39;, 7)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>ËªüÈ´îÊáâÁî®</td>
                            <td>Âë®ÂÅ•</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;group&#39;, 8)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;group&#39;, 8)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>ËªüÈ´îÊáâÁî®</td>
                            <td>Êñá‰øäÂá±</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;group&#39;, 9)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;group&#39;, 9)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>ËªüÈ´îÊáâÁî®</td>
                            <td>ÊùéÂø†Ë™†</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;group&#39;, 10)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;group&#39;, 10)">Âà™Èô§</button>
                            </td>
                        </tr>
                        <tr>
                            <td>ËªüÈ´îÊáâÁî®</td>
                            <td>Áî≥Èµ¨ÂÆá</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;group&#39;, 11)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;group&#39;, 11)">Âà™Èô§</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="tab_task" class="db-tab-content active">
                <div class="action-bar" style="background: #e8f5e9; border-color: #a5d6a7;">
                    <input type="text" list="dl_tasks" id="task_main" placeholder="‰∏ª‰∫ãÈ†Ö..." oninput="applyTaskFilter()">
                    <input type="text" id="task_sub" placeholder="Â∞è‰∫ãÈ†Ö..." oninput="applyTaskFilter()">
                    <button onclick="addDbTaskLink()" style="background:#4CAF50;">Êñ∞Â¢û</button>
                </div>
                <table class="db-table">
                    <tbody id="db_task_list">
                        <tr>
                            <td>Amotion</td>
                            <td>C</td>
                            <td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
                                <button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;"
                                    onclick="startEditDb(&#39;task&#39;, 0)">Á∑®ËºØ</button>
                                <button style="background:#ef4444; padding:4px 10px; font-size:12px;"
                                    onclick="delDb(&#39;task&#39;, 0)">Âà™Èô§</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer"><button onclick="closeModal(&#39;dbModal&#39;)">ÂÆåÊàê‰∏¶ÈóúÈñâ</button></div>
        </div>
    </div>

    <div id="editDbModal" class="modal" style="z-index: 1005;">
        <div class="modal-content" style="max-width: 400px; margin-top: 10%;">
            <div class="modal-header">
                <h3>‚úèÔ∏è Á∑®ËºØ</h3><span class="close" onclick="closeModal(&#39;editDbModal&#39;)">√ó</span>
            </div>
            <div class="modal-body" id="editDbBody"></div>
            <div class="modal-footer"><button onclick="saveDbEdit()" style="background:#ff9800;">üíæ ÂÑ≤Â≠ò‰∏¶Êõ¥Êñ∞</button></div>
        </div>
    </div>

    <div id="allocModal" class="modal" style="display: none;">
        <div class="modal-content alloc-modal-content">
            <div class="am-header">
                <h2 class="am-title">üìä Â∞àÊ°àË≥áÊ∫êÂàÜÈÖçÁü©Èô£ <span>(ÂÖ®Â±ÄÊéíÁ®ãË¶ñËßí)</span></h2>
                <div class="am-week-nav">
                    <button class="am-btn-nav" onclick="changeAllocWeek(-1)">‚óÄ</button>
                    <div class="am-week-sel-wrap">
                        <select id="allocWeekSelector" class="am-week-sel" onchange="updateAllocView()">
                            <option value="y2025_w49">2025Âπ¥ W49 (12/1 ~ 12/7)</option>
                            <option value="y2025_w50">2025Âπ¥ W50 (12/8 ~ 12/14)</option>
                            <option value="y2025_w51">2025Âπ¥ W51 (12/15 ~ 12/21)</option>
                            <option value="y2025_w52">2025Âπ¥ W52 (12/22 ~ 12/28)</option>
                            <option value="y2026_w1">2026Âπ¥ W1 (12/29 ~ 1/4)</option>
                            <option value="y2026_w2">2026Âπ¥ W2 (1/5 ~ 1/11)</option>
                            <option value="y2026_w3">2026Âπ¥ W3 (1/12 ~ 1/18)</option>
                            <option value="y2026_w4">2026Âπ¥ W4 (1/19 ~ 1/25)</option>
                            <option value="y2026_w5">2026Âπ¥ W5 (1/26 ~ 2/1)</option>
                            <option value="y2026_w6">2026Âπ¥ W6 (2/2 ~ 2/8)</option>
                            <option value="y2026_w7">2026Âπ¥ W7 (2/9 ~ 2/15)</option>
                            <option value="y2026_w8">2026Âπ¥ W8 (2/16 ~ 2/22)</option>
                            <option value="y2026_w9">2026Âπ¥ W9 (2/23 ~ 3/1)</option>
                            <option value="y2026_w10">2026Âπ¥ W10 (3/2 ~ 3/8)</option>
                            <option value="y2026_w11">2026Âπ¥ W11 (3/9 ~ 3/15)</option>
                            <option value="y2026_w12">2026Âπ¥ W12 (3/16 ~ 3/22)</option>
                            <option value="y2026_w13">2026Âπ¥ W13 (3/23 ~ 3/29)</option>
                            <option value="y2026_w14">2026Âπ¥ W14 (3/30 ~ 4/5)</option>
                            <option value="y2026_w15">2026Âπ¥ W15 (4/6 ~ 4/12)</option>
                            <option value="y2026_w16">2026Âπ¥ W16 (4/13 ~ 4/19)</option>
                            <option value="y2026_w17">2026Âπ¥ W17 (4/20 ~ 4/26)</option>
                            <option value="y2026_w18">2026Âπ¥ W18 (4/27 ~ 5/3)</option>
                            <option value="y2026_w19">2026Âπ¥ W19 (5/4 ~ 5/10)</option>
                            <option value="y2026_w20">2026Âπ¥ W20 (5/11 ~ 5/17)</option>
                            <option value="y2026_w21">2026Âπ¥ W21 (5/18 ~ 5/24)</option>
                            <option value="y2026_w22">2026Âπ¥ W22 (5/25 ~ 5/31)</option>
                            <option value="y2026_w23">2026Âπ¥ W23 (6/1 ~ 6/7)</option>
                            <option value="y2026_w24">2026Âπ¥ W24 (6/8 ~ 6/14)</option>
                            <option value="y2026_w25">2026Âπ¥ W25 (6/15 ~ 6/21)</option>
                            <option value="y2026_w26">2026Âπ¥ W26 (6/22 ~ 6/28)</option>
                            <option value="y2026_w27">2026Âπ¥ W27 (6/29 ~ 7/5)</option>
                            <option value="y2026_w28">2026Âπ¥ W28 (7/6 ~ 7/12)</option>
                            <option value="y2026_w29">2026Âπ¥ W29 (7/13 ~ 7/19)</option>
                            <option value="y2026_w30">2026Âπ¥ W30 (7/20 ~ 7/26)</option>
                            <option value="y2026_w31">2026Âπ¥ W31 (7/27 ~ 8/2)</option>
                            <option value="y2026_w32">2026Âπ¥ W32 (8/3 ~ 8/9)</option>
                            <option value="y2026_w33">2026Âπ¥ W33 (8/10 ~ 8/16)</option>
                            <option value="y2026_w34">2026Âπ¥ W34 (8/17 ~ 8/23)</option>
                            <option value="y2026_w35">2026Âπ¥ W35 (8/24 ~ 8/30)</option>
                            <option value="y2026_w36">2026Âπ¥ W36 (8/31 ~ 9/6)</option>
                            <option value="y2026_w37">2026Âπ¥ W37 (9/7 ~ 9/13)</option>
                            <option value="y2026_w38">2026Âπ¥ W38 (9/14 ~ 9/20)</option>
                            <option value="y2026_w39">2026Âπ¥ W39 (9/21 ~ 9/27)</option>
                            <option value="y2026_w40">2026Âπ¥ W40 (9/28 ~ 10/4)</option>
                            <option value="y2026_w41">2026Âπ¥ W41 (10/5 ~ 10/11)</option>
                            <option value="y2026_w42">2026Âπ¥ W42 (10/12 ~ 10/18)</option>
                            <option value="y2026_w43">2026Âπ¥ W43 (10/19 ~ 10/25)</option>
                            <option value="y2026_w44">2026Âπ¥ W44 (10/26 ~ 11/1)</option>
                            <option value="y2026_w45">2026Âπ¥ W45 (11/2 ~ 11/8)</option>
                            <option value="y2026_w46">2026Âπ¥ W46 (11/9 ~ 11/15)</option>
                            <option value="y2026_w47">2026Âπ¥ W47 (11/16 ~ 11/22)</option>
                            <option value="y2026_w48">2026Âπ¥ W48 (11/23 ~ 11/29)</option>
                            <option value="y2026_w49">2026Âπ¥ W49 (11/30 ~ 12/6)</option>
                            <option value="y2026_w50">2026Âπ¥ W50 (12/7 ~ 12/13)</option>
                            <option value="y2026_w51">2026Âπ¥ W51 (12/14 ~ 12/20)</option>
                            <option value="y2026_w52">2026Âπ¥ W52 (12/21 ~ 12/27)</option>
                            <option value="y2026_w53">2026Âπ¥ W53 (12/28 ~ 1/3)</option>
                            <option value="y2027_w1">2027Âπ¥ W1 (1/4 ~ 1/10)</option>
                            <option value="y2027_w2">2027Âπ¥ W2 (1/11 ~ 1/17)</option>
                            <option value="y2027_w3">2027Âπ¥ W3 (1/18 ~ 1/24)</option>
                            <option value="y2027_w4">2027Âπ¥ W4 (1/25 ~ 1/31)</option>
                            <option value="y2027_w5">2027Âπ¥ W5 (2/1 ~ 2/7)</option>
                            <option value="y2027_w6">2027Âπ¥ W6 (2/8 ~ 2/14)</option>
                            <option value="y2027_w7">2027Âπ¥ W7 (2/15 ~ 2/21)</option>
                            <option value="y2027_w8">2027Âπ¥ W8 (2/22 ~ 2/28)</option>
                        </select>
                    </div>
                    <button class="am-btn-nav" onclick="changeAllocWeek(1)">‚ñ∂</button>
                </div>
                <span class="close" onclick="closeModal(&#39;allocModal&#39;)">√ó</span>
            </div>

            <div class="am-main-layout">
                <div class="am-panel am-panel-left">
                    <h3 class="am-panel-title">
                        <div style="display:flex; align-items:center; gap:10px;">
                            <span>üìã ‰ªªÂãôÊéíÁ®ãÁü©Èô£</span>
                            <span id="allocUnassignedCount" class="count-badge"
                                style="background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: var(--success); color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px;">0</span>
                        </div>
                    </h3>
                    <div class="am-content-scroll" id="allocEventList">
                        <table class="am-matrix">
                            <thead>
                                <tr>
                                    <th class="am-task-info-td" style="text-align:left; padding-left:16px;">Â∞àÊ°à / ‰ªªÂãôË≥áË®ä
                                    </th>
                                    <th class="" style="min-width: 120px; width: 120px;">W7<br><span
                                            style="font-size:10px; font-weight:normal; color:#64748b;">2/9</span></th>
                                    <th class="" style="min-width: 120px; width: 120px;">W8<br><span
                                            style="font-size:10px; font-weight:normal; color:#64748b;">2/16</span></th>
                                    <th class="" style="min-width: 120px; width: 120px;">W9<br><span
                                            style="font-size:10px; font-weight:normal; color:#64748b;">2/23</span></th>
                                    <th class="is-current" style="min-width: 120px; width: 120px;">W10<br><span
                                            style="font-size:10px; font-weight:normal; color:#64748b;">3/2</span></th>
                                    <th class="" style="min-width: 120px; width: 120px;">W11<br><span
                                            style="font-size:10px; font-weight:normal; color:#64748b;">3/9</span></th>
                                    <th class="" style="min-width: 120px; width: 120px;">W12<br><span
                                            style="font-size:10px; font-weight:normal; color:#64748b;">3/16</span></th>
                                    <th class="" style="min-width: 120px; width: 120px;">W13<br><span
                                            style="font-size:10px; font-weight:normal; color:#64748b;">3/23</span></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="am-group-row">
                                    <td class="am-task-info-td">
                                        <div style="display:flex; justify-content:space-between; align-items:center;">
                                            <span style="font-size:14px; font-weight:bold; color:#1e293b;">üåç GL - üì¶
                                                Alpine <span
                                                    style="color:#64748b; font-weight:normal;">(NPI)</span></span>
                                        </div>
                                    </td>
                                    <td colspan="7"
                                        style="padding: 0; vertical-align: middle; position: relative; border-right: none;">
                                        <div
                                            style="position:relative; width:100%; height:24px; display:flex; align-items:center;">
                                            <div class="gantt-bar"
                                                style="position:absolute; left:61.224489810379936%; width:38.775510189620064%; background:#e1f5fe; border:1px solid #81d4fa; z-index:5; box-sizing:border-box; overflow:hidden;"
                                                title="[NPI] EVT (2026-03-11~2026-04-11)">
                                                <span style="color:#0288d1">3/11</span>
                                                <b style="color:#0288d1">EVT</b>
                                                <span style="color:#0288d1">4/11</span>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="am-task-info-td">
                                        <div class="am-task-name"><span class="am-badge-phase am-phase-prep">EVT
                                                (È†êÂÇô)</span><span>Amotion</span></div>
                                        <div class="am-task-path">FATP ‚ûî HSG Line (C)</div>
                                        <div style="font-size:11px; color:#64748b; margin-top:4px;">
                                            Áï∂ÈÄ±ÈúÄÊ±Ç: <input type="number" value="0.0" step="0.1"
                                                data-task="GL|Alpine|NPI|FATP|HSG Line|Amotion|C"
                                                onchange="changeAllocTotalReq(this)" class="am-input-req" title="ÈªûÊìä‰øÆÊîπ">
                                            ‰∫∫
                                        </div>
                                    </td>
                                    <td class="" style="">
                                        <div style="text-align:center; color:#cbd5e1; font-size:11px; margin-top:8px;">-
                                        </div>
                                    </td>
                                    <td class="" style="">
                                        <div style="text-align:center; color:#cbd5e1; font-size:11px; margin-top:8px;">-
                                        </div>
                                    </td>
                                    <td class="" style="">
                                        <div style="text-align:center; color:#cbd5e1; font-size:11px; margin-top:8px;">-
                                        </div>
                                    </td>
                                    <td class="is-current"
                                        style="border-left: 2px solid #60a5fa; border-right: 2px solid #60a5fa; box-shadow: inset 0 0 10px rgba(191,219,254,0.3);">
                                        <div style="text-align:center; color:#cbd5e1; font-size:11px; margin-top:8px;">-
                                        </div>
                                    </td>
                                    <td class="" style="">
                                        <div style="margin-bottom:6px;">
                                            <div class="am-pill" style="display:block;">
                                                <div
                                                    style="display:flex; justify-content:space-between; align-items:center;">
                                                    <span>Èô≥Âª∑Â∏•1 <b
                                                            style="opacity:0.7; font-weight:normal;">1.0</b></span>
                                                    <button class="am-btn-rm"
                                                        onclick="unassignAllocTask(1772405799146, &#39;y2026_w11&#39;)"
                                                        title="ÊãîÈô§">‚úñ</button>
                                                </div>

                                            </div>

                                            <div class="am-pill" style="display:block;">
                                                <div
                                                    style="display:flex; justify-content:space-between; align-items:center;">
                                                    <span>Ë¢ÅÊ≠° <b style="opacity:0.7; font-weight:normal;">1.0</b></span>
                                                    <button class="am-btn-rm"
                                                        onclick="unassignAllocTask(1772405802621, &#39;y2026_w11&#39;)"
                                                        title="ÊãîÈô§">‚úñ</button>
                                                </div>

                                            </div>

                                            <div class="am-pill" style="display:block;">
                                                <div
                                                    style="display:flex; justify-content:space-between; align-items:center;">
                                                    <span>ÊûóÊúàÊ¶Æ <b style="opacity:0.7; font-weight:normal;">1.0</b></span>
                                                    <button class="am-btn-rm"
                                                        onclick="unassignAllocTask(1772405847204, &#39;y2026_w11&#39;)"
                                                        title="ÊãîÈô§">‚úñ</button>
                                                </div>

                                            </div>
                                        </div>
                                    </td>
                                    <td class="" style="">
                                        <div style="text-align:center; color:#cbd5e1; font-size:11px; margin-top:8px;">-
                                        </div>
                                    </td>
                                    <td class="" style="">
                                        <div style="text-align:center; color:#cbd5e1; font-size:11px; margin-top:8px;">-
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="am-panel am-panel-right">
                    <h3 class="am-panel-title" id="allocRightPanelTitle">üë• ÂúòÈöäË≤†Ëç∑Ê∞¥‰ΩçË°® - W10</h3>
                    <div class="am-content-scroll" id="allocPersonnelList">
                        <div class="am-group-hdr"
                            onclick="let c = this.nextElementSibling; let i = this.querySelector(&#39;.am-grp-icon&#39;); if(c.style.display===&#39;none&#39;){c.style.display=&#39;block&#39;; i.innerText=&#39;‚ñº&#39;;}else{c.style.display=&#39;none&#39;; i.innerText=&#39;‚ñ∂&#39;;}"
                            onmouseover="this.style.backgroundColor=&#39;#f1f5f9&#39;"
                            onmouseout="this.style.backgroundColor=&#39;transparent&#39;"
                            style="cursor:pointer; font-size:13px; color:#475569; border-bottom:2px solid #cbd5e1; padding:6px 4px; margin:15px 0 5px 0; display:flex; align-items:center; justify-content:space-between; transition:0.2s; border-radius:4px 4px 0 0;">
                            <div style="display:flex; align-items:center; gap:8px;">
                                <span
                                    style="background:#e2e8f0; padding:2px 6px; border-radius:4px; font-weight:bold; color:#1e293b;">üè¢
                                    ËªüÈ´îÊáâÁî®</span>
                                <span style="font-size:11px; color:#64748b; font-weight:normal;">(ÂÖ± 12 ‰∫∫)</span>
                            </div>
                            <span class="am-grp-icon"
                                style="font-size:10px; color:#94a3b8; font-weight:bold; padding-right:4px;">‚ñº</span>
                        </div>
                        <div class="am-group-content" style="display:block;">
                            <div class="am-person"
                                style="border: 1px solid #e2e8f0; background-color: #f8fafc; margin-bottom: 8px; border-radius:8px; padding:12px; transition:0.2s;">
                                <div class="am-person-row"
                                    style="margin-bottom: 12px; display:flex; align-items:center; gap:12px;">
                                    <div class="am-person-name"
                                        style="width: 70px; text-align: right; font-weight:bold; color:#334155; font-size:14px;">
                                        Èô≥Âª∑Â∏•1</div>
                                    <div class="am-track"
                                        style="flex:1; height:8px; background:#e2e8f0; border-radius:4px; position:relative;">
                                        <div class="am-fill"
                                            style="height:100%; border-radius:4px; transition:width 0.4s, background-color 0.4s; width: 0%; background-color: #cbd5e1;">
                                        </div>
                                        <div style="position:absolute; left:100%; top:-3px; bottom:-3px; width:2px; background:#475569; z-index:2; opacity:0.6;"
                                            title="ÊªøÁ∑® 1.0 Âü∫Ê∫ñÁ∑ö"></div>
                                    </div>
                                    <div class="am-val"
                                        style="color: #94a3b8; width: 35px; text-align:right; font-weight:800; font-size:13px;">
                                        0.0</div>
                                </div>
                                <div class="am-tasks"
                                    style="padding-left: 0; display: flex; flex-wrap: wrap; gap: 6px;">
                                    <div
                                        style="font-size:11px; color:#94a3b8; font-style:italic; padding:6px; width:100%; text-align:center;">
                                        üèñÔ∏è Êú¨ÈÄ±ÁÑ°ÊåáÊ¥æ‰ªªÂãô</div>
                                </div>
                            </div>
                            <div class="am-person"
                                style="border: 1px solid #e2e8f0; background-color: #f8fafc; margin-bottom: 8px; border-radius:8px; padding:12px; transition:0.2s;">
                                <div class="am-person-row"
                                    style="margin-bottom: 12px; display:flex; align-items:center; gap:12px;">
                                    <div class="am-person-name"
                                        style="width: 70px; text-align: right; font-weight:bold; color:#334155; font-size:14px;">
                                        Ë¢ÅÊ≠°</div>
                                    <div class="am-track"
                                        style="flex:1; height:8px; background:#e2e8f0; border-radius:4px; position:relative;">
                                        <div class="am-fill"
                                            style="height:100%; border-radius:4px; transition:width 0.4s, background-color 0.4s; width: 0%; background-color: #cbd5e1;">
                                        </div>
                                        <div style="position:absolute; left:100%; top:-3px; bottom:-3px; width:2px; background:#475569; z-index:2; opacity:0.6;"
                                            title="ÊªøÁ∑® 1.0 Âü∫Ê∫ñÁ∑ö"></div>
                                    </div>
                                    <div class="am-val"
                                        style="color: #94a3b8; width: 35px; text-align:right; font-weight:800; font-size:13px;">
                                        0.0</div>
                                </div>
                                <div class="am-tasks"
                                    style="padding-left: 0; display: flex; flex-wrap: wrap; gap: 6px;">
                                    <div
                                        style="font-size:11px; color:#94a3b8; font-style:italic; padding:6px; width:100%; text-align:center;">
                                        üèñÔ∏è Êú¨ÈÄ±ÁÑ°ÊåáÊ¥æ‰ªªÂãô</div>
                                </div>
                            </div>
                            <div class="am-person"
                                style="border: 1px solid #e2e8f0; background-color: #f8fafc; margin-bottom: 8px; border-radius:8px; padding:12px; transition:0.2s;">
                                <div class="am-person-row"
                                    style="margin-bottom: 12px; display:flex; align-items:center; gap:12px;">
                                    <div class="am-person-name"
                                        style="width: 70px; text-align: right; font-weight:bold; color:#334155; font-size:14px;">
                                        ÊûóÊúàÊ¶Æ</div>
                                    <div class="am-track"
                                        style="flex:1; height:8px; background:#e2e8f0; border-radius:4px; position:relative;">
                                        <div class="am-fill"
                                            style="height:100%; border-radius:4px; transition:width 0.4s, background-color 0.4s; width: 0%; background-color: #cbd5e1;">
                                        </div>
                                        <div style="position:absolute; left:100%; top:-3px; bottom:-3px; width:2px; background:#475569; z-index:2; opacity:0.6;"
                                            title="ÊªøÁ∑® 1.0 Âü∫Ê∫ñÁ∑ö"></div>
                                    </div>
                                    <div class="am-val"
                                        style="color: #94a3b8; width: 35px; text-align:right; font-weight:800; font-size:13px;">
                                        0.0</div>
                                </div>
                                <div class="am-tasks"
                                    style="padding-left: 0; display: flex; flex-wrap: wrap; gap: 6px;">
                                    <div
                                        style="font-size:11px; color:#94a3b8; font-style:italic; padding:6px; width:100%; text-align:center;">
                                        üèñÔ∏è Êú¨ÈÄ±ÁÑ°ÊåáÊ¥æ‰ªªÂãô</div>
                                </div>
                            </div>
                            <div class="am-person"
                                style="border: 1px solid #e2e8f0; background-color: #f8fafc; margin-bottom: 8px; border-radius:8px; padding:12px; transition:0.2s;">
                                <div class="am-person-row"
                                    style="margin-bottom: 12px; display:flex; align-items:center; gap:12px;">
                                    <div class="am-person-name"
                                        style="width: 70px; text-align: right; font-weight:bold; color:#334155; font-size:14px;">
                                        Ê•äÁê¶</div>
                                    <div class="am-track"
                                        style="flex:1; height:8px; background:#e2e8f0; border-radius:4px; position:relative;">
                                        <div class="am-fill"
                                            style="height:100%; border-radius:4px; transition:width 0.4s, background-color 0.4s; width: 0%; background-color: #cbd5e1;">
                                        </div>
                                        <div style="position:absolute; left:100%; top:-3px; bottom:-3px; width:2px; background:#475569; z-index:2; opacity:0.6;"
                                            title="ÊªøÁ∑® 1.0 Âü∫Ê∫ñÁ∑ö"></div>
                                    </div>
                                    <div class="am-val"
                                        style="color: #94a3b8; width: 35px; text-align:right; font-weight:800; font-size:13px;">
                                        0.0</div>
                                </div>
                                <div class="am-tasks"
                                    style="padding-left: 0; display: flex; flex-wrap: wrap; gap: 6px;">
                                    <div
                                        style="font-size:11px; color:#94a3b8; font-style:italic; padding:6px; width:100%; text-align:center;">
                                        üèñÔ∏è Êú¨ÈÄ±ÁÑ°ÊåáÊ¥æ‰ªªÂãô</div>
                                </div>
                            </div>
                            <div class="am-person"
                                style="border: 1px solid #e2e8f0; background-color: #f8fafc; margin-bottom: 8px; border-radius:8px; padding:12px; transition:0.2s;">
                                <div class="am-person-row"
                                    style="margin-bottom: 12px; display:flex; align-items:center; gap:12px;">
                                    <div class="am-person-name"
                                        style="width: 70px; text-align: right; font-weight:bold; color:#334155; font-size:14px;">
                                        Èô≥Êñå</div>
                                    <div class="am-track"
                                        style="flex:1; height:8px; background:#e2e8f0; border-radius:4px; position:relative;">
                                        <div class="am-fill"
                                            style="height:100%; border-radius:4px; transition:width 0.4s, background-color 0.4s; width: 0%; background-color: #cbd5e1;">
                                        </div>
                                        <div style="position:absolute; left:100%; top:-3px; bottom:-3px; width:2px; background:#475569; z-index:2; opacity:0.6;"
                                            title="ÊªøÁ∑® 1.0 Âü∫Ê∫ñÁ∑ö"></div>
                                    </div>
                                    <div class="am-val"
                                        style="color: #94a3b8; width: 35px; text-align:right; font-weight:800; font-size:13px;">
                                        0.0</div>
                                </div>
                                <div class="am-tasks"
                                    style="padding-left: 0; display: flex; flex-wrap: wrap; gap: 6px;">
                                    <div
                                        style="font-size:11px; color:#94a3b8; font-style:italic; padding:6px; width:100%; text-align:center;">
                                        üèñÔ∏è Êú¨ÈÄ±ÁÑ°ÊåáÊ¥æ‰ªªÂãô</div>
                                </div>
                            </div>
                            <div class="am-person"
                                style="border: 1px solid #e2e8f0; background-color: #f8fafc; margin-bottom: 8px; border-radius:8px; padding:12px; transition:0.2s;">
                                <div class="am-person-row"
                                    style="margin-bottom: 12px; display:flex; align-items:center; gap:12px;">
                                    <div class="am-person-name"
                                        style="width: 70px; text-align: right; font-weight:bold; color:#334155; font-size:14px;">
                                        ÊΩòË±™</div>
                                    <div class="am-track"
                                        style="flex:1; height:8px; background:#e2e8f0; border-radius:4px; position:relative;">
                                        <div class="am-fill"
                                            style="height:100%; border-radius:4px; transition:width 0.4s, background-color 0.4s; width: 0%; background-color: #cbd5e1;">
                                        </div>
                                        <div style="position:absolute; left:100%; top:-3px; bottom:-3px; width:2px; background:#475569; z-index:2; opacity:0.6;"
                                            title="ÊªøÁ∑® 1.0 Âü∫Ê∫ñÁ∑ö"></div>
                                    </div>
                                    <div class="am-val"
                                        style="color: #94a3b8; width: 35px; text-align:right; font-weight:800; font-size:13px;">
                                        0.0</div>
                                </div>
                                <div class="am-tasks"
                                    style="padding-left: 0; display: flex; flex-wrap: wrap; gap: 6px;">
                                    <div
                                        style="font-size:11px; color:#94a3b8; font-style:italic; padding:6px; width:100%; text-align:center;">
                                        üèñÔ∏è Êú¨ÈÄ±ÁÑ°ÊåáÊ¥æ‰ªªÂãô</div>
                                </div>
                            </div>
                            <div class="am-person"
                                style="border: 1px solid #e2e8f0; background-color: #f8fafc; margin-bottom: 8px; border-radius:8px; padding:12px; transition:0.2s;">
                                <div class="am-person-row"
                                    style="margin-bottom: 12px; display:flex; align-items:center; gap:12px;">
                                    <div class="am-person-name"
                                        style="width: 70px; text-align: right; font-weight:bold; color:#334155; font-size:14px;">
                                        ÂúãËäÆ</div>
                                    <div class="am-track"
                                        style="flex:1; height:8px; background:#e2e8f0; border-radius:4px; position:relative;">
                                        <div class="am-fill"
                                            style="height:100%; border-radius:4px; transition:width 0.4s, background-color 0.4s; width: 0%; background-color: #cbd5e1;">
                                        </div>
                                        <div style="position:absolute; left:100%; top:-3px; bottom:-3px; width:2px; background:#475569; z-index:2; opacity:0.6;"
                                            title="ÊªøÁ∑® 1.0 Âü∫Ê∫ñÁ∑ö"></div>
                                    </div>
                                    <div class="am-val"
                                        style="color: #94a3b8; width: 35px; text-align:right; font-weight:800; font-size:13px;">
                                        0.0</div>
                                </div>
                                <div class="am-tasks"
                                    style="padding-left: 0; display: flex; flex-wrap: wrap; gap: 6px;">
                                    <div
                                        style="font-size:11px; color:#94a3b8; font-style:italic; padding:6px; width:100%; text-align:center;">
                                        üèñÔ∏è Êú¨ÈÄ±ÁÑ°ÊåáÊ¥æ‰ªªÂãô</div>
                                </div>
                            </div>
                            <div class="am-person"
                                style="border: 1px solid #e2e8f0; background-color: #f8fafc; margin-bottom: 8px; border-radius:8px; padding:12px; transition:0.2s;">
                                <div class="am-person-row"
                                    style="margin-bottom: 12px; display:flex; align-items:center; gap:12px;">
                                    <div class="am-person-name"
                                        style="width: 70px; text-align: right; font-weight:bold; color:#334155; font-size:14px;">
                                        ÈÑßÂøóÊµ©</div>
                                    <div class="am-track"
                                        style="flex:1; height:8px; background:#e2e8f0; border-radius:4px; position:relative;">
                                        <div class="am-fill"
                                            style="height:100%; border-radius:4px; transition:width 0.4s, background-color 0.4s; width: 0%; background-color: #cbd5e1;">
                                        </div>
                                        <div style="position:absolute; left:100%; top:-3px; bottom:-3px; width:2px; background:#475569; z-index:2; opacity:0.6;"
                                            title="ÊªøÁ∑® 1.0 Âü∫Ê∫ñÁ∑ö"></div>
                                    </div>
                                    <div class="am-val"
                                        style="color: #94a3b8; width: 35px; text-align:right; font-weight:800; font-size:13px;">
                                        0.0</div>
                                </div>
                                <div class="am-tasks"
                                    style="padding-left: 0; display: flex; flex-wrap: wrap; gap: 6px;">
                                    <div
                                        style="font-size:11px; color:#94a3b8; font-style:italic; padding:6px; width:100%; text-align:center;">
                                        üèñÔ∏è Êú¨ÈÄ±ÁÑ°ÊåáÊ¥æ‰ªªÂãô</div>
                                </div>
                            </div>
                            <div class="am-person"
                                style="border: 1px solid #e2e8f0; background-color: #f8fafc; margin-bottom: 8px; border-radius:8px; padding:12px; transition:0.2s;">
                                <div class="am-person-row"
                                    style="margin-bottom: 12px; display:flex; align-items:center; gap:12px;">
                                    <div class="am-person-name"
                                        style="width: 70px; text-align: right; font-weight:bold; color:#334155; font-size:14px;">
                                        Âë®ÂÅ•</div>
                                    <div class="am-track"
                                        style="flex:1; height:8px; background:#e2e8f0; border-radius:4px; position:relative;">
                                        <div class="am-fill"
                                            style="height:100%; border-radius:4px; transition:width 0.4s, background-color 0.4s; width: 0%; background-color: #cbd5e1;">
                                        </div>
                                        <div style="position:absolute; left:100%; top:-3px; bottom:-3px; width:2px; background:#475569; z-index:2; opacity:0.6;"
                                            title="ÊªøÁ∑® 1.0 Âü∫Ê∫ñÁ∑ö"></div>
                                    </div>
                                    <div class="am-val"
                                        style="color: #94a3b8; width: 35px; text-align:right; font-weight:800; font-size:13px;">
                                        0.0</div>
                                </div>
                                <div class="am-tasks"
                                    style="padding-left: 0; display: flex; flex-wrap: wrap; gap: 6px;">
                                    <div
                                        style="font-size:11px; color:#94a3b8; font-style:italic; padding:6px; width:100%; text-align:center;">
                                        üèñÔ∏è Êú¨ÈÄ±ÁÑ°ÊåáÊ¥æ‰ªªÂãô</div>
                                </div>
                            </div>
                            <div class="am-person"
                                style="border: 1px solid #e2e8f0; background-color: #f8fafc; margin-bottom: 8px; border-radius:8px; padding:12px; transition:0.2s;">
                                <div class="am-person-row"
                                    style="margin-bottom: 12px; display:flex; align-items:center; gap:12px;">
                                    <div class="am-person-name"
                                        style="width: 70px; text-align: right; font-weight:bold; color:#334155; font-size:14px;">
                                        Êñá‰øäÂá±</div>
                                    <div class="am-track"
                                        style="flex:1; height:8px; background:#e2e8f0; border-radius:4px; position:relative;">
                                        <div class="am-fill"
                                            style="height:100%; border-radius:4px; transition:width 0.4s, background-color 0.4s; width: 0%; background-color: #cbd5e1;">
                                        </div>
                                        <div style="position:absolute; left:100%; top:-3px; bottom:-3px; width:2px; background:#475569; z-index:2; opacity:0.6;"
                                            title="ÊªøÁ∑® 1.0 Âü∫Ê∫ñÁ∑ö"></div>
                                    </div>
                                    <div class="am-val"
                                        style="color: #94a3b8; width: 35px; text-align:right; font-weight:800; font-size:13px;">
                                        0.0</div>
                                </div>
                                <div class="am-tasks"
                                    style="padding-left: 0; display: flex; flex-wrap: wrap; gap: 6px;">
                                    <div
                                        style="font-size:11px; color:#94a3b8; font-style:italic; padding:6px; width:100%; text-align:center;">
                                        üèñÔ∏è Êú¨ÈÄ±ÁÑ°ÊåáÊ¥æ‰ªªÂãô</div>
                                </div>
                            </div>
                            <div class="am-person"
                                style="border: 1px solid #e2e8f0; background-color: #f8fafc; margin-bottom: 8px; border-radius:8px; padding:12px; transition:0.2s;">
                                <div class="am-person-row"
                                    style="margin-bottom: 12px; display:flex; align-items:center; gap:12px;">
                                    <div class="am-person-name"
                                        style="width: 70px; text-align: right; font-weight:bold; color:#334155; font-size:14px;">
                                        ÊùéÂø†Ë™†</div>
                                    <div class="am-track"
                                        style="flex:1; height:8px; background:#e2e8f0; border-radius:4px; position:relative;">
                                        <div class="am-fill"
                                            style="height:100%; border-radius:4px; transition:width 0.4s, background-color 0.4s; width: 0%; background-color: #cbd5e1;">
                                        </div>
                                        <div style="position:absolute; left:100%; top:-3px; bottom:-3px; width:2px; background:#475569; z-index:2; opacity:0.6;"
                                            title="ÊªøÁ∑® 1.0 Âü∫Ê∫ñÁ∑ö"></div>
                                    </div>
                                    <div class="am-val"
                                        style="color: #94a3b8; width: 35px; text-align:right; font-weight:800; font-size:13px;">
                                        0.0</div>
                                </div>
                                <div class="am-tasks"
                                    style="padding-left: 0; display: flex; flex-wrap: wrap; gap: 6px;">
                                    <div
                                        style="font-size:11px; color:#94a3b8; font-style:italic; padding:6px; width:100%; text-align:center;">
                                        üèñÔ∏è Êú¨ÈÄ±ÁÑ°ÊåáÊ¥æ‰ªªÂãô</div>
                                </div>
                            </div>
                            <div class="am-person"
                                style="border: 1px solid #e2e8f0; background-color: #f8fafc; margin-bottom: 8px; border-radius:8px; padding:12px; transition:0.2s;">
                                <div class="am-person-row"
                                    style="margin-bottom: 12px; display:flex; align-items:center; gap:12px;">
                                    <div class="am-person-name"
                                        style="width: 70px; text-align: right; font-weight:bold; color:#334155; font-size:14px;">
                                        Áî≥Èµ¨ÂÆá</div>
                                    <div class="am-track"
                                        style="flex:1; height:8px; background:#e2e8f0; border-radius:4px; position:relative;">
                                        <div class="am-fill"
                                            style="height:100%; border-radius:4px; transition:width 0.4s, background-color 0.4s; width: 0%; background-color: #cbd5e1;">
                                        </div>
                                        <div style="position:absolute; left:100%; top:-3px; bottom:-3px; width:2px; background:#475569; z-index:2; opacity:0.6;"
                                            title="ÊªøÁ∑® 1.0 Âü∫Ê∫ñÁ∑ö"></div>
                                    </div>
                                    <div class="am-val"
                                        style="color: #94a3b8; width: 35px; text-align:right; font-weight:800; font-size:13px;">
                                        0.0</div>
                                </div>
                                <div class="am-tasks"
                                    style="padding-left: 0; display: flex; flex-wrap: wrap; gap: 6px;">
                                    <div
                                        style="font-size:11px; color:#94a3b8; font-style:italic; padding:6px; width:100%; text-align:center;">
                                        üèñÔ∏è Êú¨ÈÄ±ÁÑ°ÊåáÊ¥æ‰ªªÂãô</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="allocAddReqModal" class="modal" style="z-index: 1010;">
        <div class="modal-content" style="max-width: 400px; margin-top: 10%;">
            <div class="modal-header">
                <h3 style="margin:0; font-size:18px;">‚ûï Âú®Êú¨ÈÄ±ÂºïÂÖ•È†êÂÇô‰ªªÂãô</h3>
                <span class="close"
                    onclick="document.getElementById(&#39;allocAddReqModal&#39;).style.display=&#39;none&#39;">√ó</span>
            </div>
            <div class="modal-body">
                <label
                    style="display:block; font-size:12px; font-weight:bold; color:#64748b; margin-bottom:4px;">ÈóúËÅØÂ∞àÊ°à</label>
                <select id="allocNewReqProject"
                    style="width:100%; padding:8px; border:1px solid #ccc; border-radius:6px; margin-bottom:12px;"></select>

                <div style="display:flex; gap:10px; margin-bottom:12px;">
                    <div style="flex:1;">
                        <label
                            style="display:block; font-size:12px; font-weight:bold; color:#64748b; margin-bottom:4px;">Â§ßË£ΩÁ®ã</label>
                        <input type="text" id="allocNewReqMacro" value="Ê∫ñÂÇôÂ∑•‰Ωú"
                            style="width:100%; padding:8px; border:1px solid #ccc; border-radius:6px; box-sizing:border-box;">
                    </div>
                    <div style="flex:1;">
                        <label
                            style="display:block; font-size:12px; font-weight:bold; color:#64748b; margin-bottom:4px;">Â∞èË£ΩÁ®ã</label>
                        <input type="text" id="allocNewReqMicro" value="Ë≥áÊñôËíêÈõÜ"
                            style="width:100%; padding:8px; border:1px solid #ccc; border-radius:6px; box-sizing:border-box;">
                    </div>
                </div>
                <label
                    style="display:block; font-size:12px; font-weight:bold; color:#64748b; margin-bottom:4px;">‰ªªÂãôÂêçÁ®±</label>
                <input type="text" id="allocNewReqTask" value="ÈöéÊÆµÂâçÊúüË¶èÂäÉ"
                    style="width:100%; padding:8px; border:1px solid #ccc; border-radius:6px; margin-bottom:12px; box-sizing:border-box;">

                <label
                    style="display:block; font-size:12px; font-weight:bold; color:#64748b; margin-bottom:4px;">Êú¨ÈÄ±ÈúÄÊ±Ç‰∫∫Âäõ</label>
                <input type="number" id="allocNewReqVal" value="1.0" min="0.1" step="0.1"
                    style="width:100%; padding:8px; border:1px solid #ccc; border-radius:6px; margin-bottom:15px; box-sizing:border-box;">
            </div>
            <div class="modal-footer">
                <button class="btn-main" style="width:100%;" onclick="submitAllocNewReq()">Âª∫Á´ã‰∏¶Âä†ÂÖ•ÊéíÁ®ã</button>
            </div>
        </div>
    </div>


    <script>
        // ================= Ê†∏ÂøÉË®≠ÂÆö ======        let mainTableData = [];
        let db = { rpLinks: [], milestones: [], processLinks: [], groupLinks: [], taskLinks: [] };
        let currentSelec "", name: [], region: "", project: "", category: "", macro: "", micro: [], task: "", subTask: [] };
        let currentWorkloads = {};
        let currentSort = { column: '', direction: 'asc' };
        let cmTargetContext = null;

        let defaultColOrder = ['region', 'project', 'category', 'macro', 'miubTask', 'group', 'name'];
        let colOrder = JSON.parse(localStorage.getItem('colOrderV36')) || defaultColOrder;

        // üåü Ê†∏ÂøÉÔºöÊ∞∏ÈÅ†‰øùÊåÅÈÄ±Ê®°ÂºèÁöÑÊ†ºÂ≠êÔºå‰∏¶‰ΩøÁî®Á≤æÊ∫ñÂ§©Êï∏Ë®àÁÆóÊúà‰ªΩÁöÑÁôæÂàÜÊØîÂØ¨Â∫¶
        let pixelsPerDay = 6.5;
        let timelineCols = [];
        let timelineMonths = [];
        let timelineStartMs = 0;
        let timelineEndMs = 0;

        function getISOWeek(date) {
            const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
            const dayNum = d.getUTCDay() || 7;
            d.setUTCDate(d.getUTCDate() + 4 -dayNum);
            const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
            return Math.ceil((((d - yearStart) / 86400000) + 1) / 7);
       }

        function generateTimeline() {
            timelineCols = [];
            timelineMonths = [];

            const now = new Date();
            const startMonth = new Date(now.getFullYear(), now.getMonth() - 3, 1);
            const endMonth = new Date(now.getFullYear(), now.getMonth() + 12, 0);

            const labelEl = document.getElementById('timeline_range_label');
            if (labelEl) labelEl.innerText = `${startMonth.getFullYear()}Âπ¥${startMonth.getdMonth.getFullYear()}Âπ¥${endMonth.getMonth() + 1}Êúà`;

            let curr = new Date(startMonth);
            const startDay = curr.getDay() || 7;
            curr.setDate(curr.getDate() - startDay + 1);
            timelineStartMs = curr.setHours(0, 0, 0, 0);

            let weekCurr = new Date(timelineStartMs);
            let endLimi = endMonth.getTime();

            while (weekCurr.getTime() <= endLimit) {
                let thursday = new Date(weekCurr);
                thursday.setDate(thursday.getDate() + 3);
                let year = thursday.getFulle                     getISOWeek(thursday);

                              );
                let dateStr = `${monday.gemonday.getDate()}`;
                let key = `y${year}_${weekNum}`;

                let startMs = monday.getTime();
               let sunday = new Date(monday);
                sunday.setDate(sunday.getDate() + 6);
                let endMs = sunday.setHours(23, 59, 59, 999);

                timelineCols.push({ year, label: `W${weekNum}`, subLabel: dateStr, key: key, startMs, endMs });

                weekCurr.setDate(weekCurr.getDate() + 7);
                timelineEndMs = endMs;
            }

            let totalDays = Math.round((timelineEndMs - timelineStartMs + 1) / 86400000);
            let monthCurr = new Date(timelineStartMs);

            while (monthCurr.getTime() <= timelineEndMs) {
                let y = monthCurr.getFullYear();
                let m = monthCurr.getMonth();

                let startOfThisMonth = new Date(y, m, 1).getTime();
                let endOfThisMonth = new Date(y, m + 1, 0, 23, 59, 59, 999).getTime();

                let actualStart = Math.max(timelineStartMs, startOfThisMonth);
                let actualEnd = Math.min(timelineEndMs, endOfThisMonth);

                let daysSpanned = Math.round((actualEnd - actualStart + 1) / 86400000);

                if (daysSpanned > 0) {
                    timelineMonths.push({
                        label: `${y}Âπ¥ ${m + 1}Êúà`,
                        widthPct: (daysSpanned / totalDays) * 100
                    });
                }
                monthCurr = new Date(y, m + 1, 1);
            }
        }

         // ================= ÂàùÂßãÂåñ =================
        document.addEventListener('DOMContentLoaded', () => {
            generateTimeline();
            loadAllStorage();
            initModalHeaders();
            renderMainTable();
            setupContextMenu ();
                setupPanAndZoom();
        });

         // === = ============= ÊªëÈº†Â∑¶ÈçµÂ∑¶Âè≥Âπ≥ÁßªËàáÁÑ°Á∏´Á∏ÆÊîæ =================
        function set u pPanAndZoom() {
            const container = document.q u er y Selector('.table-container');

             conta i ner.addEv en tListe n er('wh ee l', (e) => {
                if (e.ctrlKey) {
                    e.preventDefault();
                    const zoomFactor = 1.15;
                    if (e.deltaY < 0) pixelsPerDay *= zoomF a cto;
                    else pixelsPerDay /= zoomFactor;

                    pixelsPerDay = Math.max(2, Math.min(100, pixelsPerDay));
                    const colWidth = pixelsPerDay * 7;
                    document.documentElement.style.setProperty('--col-width', `${colWidth}px`);
                    setTimeout(updateStickyColumns, 50);
                 }
            }, { passive: false });

            let isPanning = false;
            let startX, scrollLeft;

            container.addEventListener('mousedown', (e) => {
                const isInteractive = [INPUT', 'SELECT', 'BUTTON'].includes(e.target.tagNa            || e.target.closest('.phase-bar')
                    || e.target.closest('th[draggable="true"]');

                if (e.button === 0 && !isInteractive) {
                    if (e.target.tagName !== 'TH') e.preventDefault();
                    isPanning = true;
                    container.classList.add('is-panning');
                    startX = e.pageX - container.offsetLeft;
                    scrollLeft = container.scrollLeft;
                }
            });

            window.addEventListener('mousemove', (e) => {
                if (!isPanning)  return;
                e.preventDefault();
                const x = e.pageX - container.offsetLeft;
                const walkX = (x - startX) * 1.5;
                container.scro llLeft = scrollLeft - walkX;
            });

            window.addEventListener('mouseup', (e) => {
                if (e.button === 0 && isPanning) {
                     isPanning = false;
                    container.classList.remove('is-panning');
                }
            });

            window.addEventListener('mouseleave', () => {
                if (isPanni ng) {
                    isPanning = false;
                    container.classList.remove('is-panning');
                }
             });
        }

        // ================= Ë≥áÊñôËºâÂÖ•ËàáËá™ÂãïÈÅ∑Áßª =================
        function loadAllStorage() {
            let savedData = localStorage.getItem('manpowerDataV36');
            let savedDb = localStorage.getItem('manpowerDbV36');

            if (!savedData) {
                let oldData = localStorage.getItem('manpowerDataV28');
                if (oldData) {
                     let parsedOld = JSON.parse(oldData);
                    let currentY = new Date().getFullYear();
                    mainTableData = parsedOld.map(row => {
                        let newRow = { ...row };
                        for (let m = 1; m <= 12; m++) {
                            if (row['m' + m]) {
                                let val = parseFloat(row['m' + m]) / 4;
                                let startW = (m - 1) * 4 + 1;
                                for (let w = startW; w <= startW + 3 && w <= 53; w++) {
                                    newRow[`y${currentY}_w${w}`]  Math.round(val * 100) / 100;
                                }
                                delete newRow['m' + m];
                            }
                        }
                        return newRow;
                    });
                }
            } else {
                mainTableData = JSON.parse(savedData);
            }

            if (savedDb) db = JSON.parse(savedDb);
            else { let oldDb = localStorage.getItem('manpowerDbV28'); if (oldDb) db = JSON.parse(oldDb); }

            if (!db.rpLinks) db.rpLinks = []; if (!db.milestones) db.milestones = [];
            if (!db.processLinks) db.processLinks = []; if (!db.groupLinks) db.groupLinks = [];
            if (!db.taskLinks) db.taskLinks = [];

            // Ë≥¶‰∫àËàäË≥áÊñô _id
            mainTableData.forEach(row => {
                if (!row._id) row._id = Date.now() + Math.floor(Math.random() * 1000000);
            });
            saveAllStorage();
        }

        function saveAllStorage() {
            localStorage.setItem('manpowerDataV36', JSON.stringify(mainTableDat a));
             localStorage.setItem('manpowerDbV36' , JSON.stringify(db));
            updateFilterDropdowns();
        }

        // ================= ÊãñÊõ≥ÈáçÁµÑÊ¨Ñ‰ΩçÂäüËÉΩ =================
        let draggedCol = null;
        window.dragStart = function (e) { draggedCol = e.target.getAttribute('data-col'); e.dataTransfer.effectAllowed = 'move'; setTimeout(() => e.target.style.opacity = '0.5', 0); };
        window.dragEnd = function (e) { e.target.style.opacity = '1'; document.querySelectorAll('th').forEach(th => th.classList.remove('drag-over')); };
        window.dragOver = function (e) { e.preventDefault(); e.dataTransfer.dropEffect = 'm ove'; let target = e.target.closest('th'); if (target && target.getAttribute('draggable')) target.classList.add('drag-over'); };
        window.dragLeave = function (e) { let target = e.target.closest('th'); if (target) target.classList.remove('drag-over'); };
        window.dropCol = function (e) {
            e.preventDefault(); let target = e.target.closest('th'); if (!target) return;
            target.classList.remove('drag-over'); let targetCol = target.getAttribute('data-col');
            if (draggedCol && targetCol && draggedCol !== targetCol) {
                let fromIdx = colOrder.indexOf(draggedCol); let toIdx = colOrder.indexOf(targetCol);
                if (fromIdx > -1 && toIdx > -1) { colOrder.splice(fromIdx, 1); colOrder.splie(toIdx, 0, draggedCol); localStorage.setItem('colOrderV36', JSON.stringify(colOrder)); renderMainTable(); }
            }
        };

       function openRecoveryModal() {
            const tbody = document.querySelector('#recoveryTable tbody'); tbody.innerHTML = '';
            let foundAny = false;
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('manpowerData')) {
                    const suffix = key.replace('manpowerData', '');
                    let versionDisplay = suffix === '' ? 'V1 (ÊúÄÊó©Êúü)' : suffix;
                     const dbKey = 'manpowerDb' + suffix;
                    try {
                        const dataObj = JSON. parse(localSt orage.getItem(key));
                        if (dataObj && Array.isArray(dataObj)) {
                            foundAny = true;
                            const isCu rrent = (k ey === 'manpowerDataV36');
                            tbody.innerHTML += `<tr style="${isCurrent ? 'background-color:#f0f8ff;' : ''}">
                                    <td style="font-weight:bold; color:#0277bd;">${versionDisplay} $ {i sCurrent ? '<span style="font-size: 10 px;color:red;">(Áï∂Ââç‰ΩøÁî®)</span>' : ''}< /t d>
                                    <td>${ da taObj.length} Á≠ÜË≥áÊñô</td>
                                    <td><bu tt on class="btn-danger" style="paddi ng : 4px 8px; font-size: 11px; margi n- bottom: 2px;" onclick="recoverDa ta ('${key}', '${dbKey}')">ÂÆåÂÖ®Ë¶ÜËìãËºâÂÖ•</b ut ton></td> 
                                 </tr> `; 
                        }
                    } catch (e) { }
                }
            }
            if (!foundAny) tbody.innerHTML = '<tr><td colspan="3" style="text-align:center;color:#888;">Êä±Ê≠âÔºåÊú™ÂÅµÊ∏¨Âà∞Ê≠∑Âè≤ Á¥ÄÈåÑ„ÄÇ</td></tr>';
            document.getElementById('recoveryModal').style.display = 'block';
        }

        function recoverData(dataKey, dbKey) {
            try {
                if (!confirm(`Ë≠¶ÂëäÔºÅÈÄôÂ∞áÊúÉÁî® [${dataKey}] ÁöÑË≥áÊñôÂÆåÂÖ®Âèñ‰ª£ÁõÆÂâçÁöÑÁï´Èù¢„ÄÇÁ¢∫ÂÆöÁπºÁ∫åÂóéÔºü`)) return;
                mainTableData = JSON.parse(localStorage.getItem(dataKey) || '[]'); db = JSON.parse(localStorage.getItem(dbKey) || '{}');
                saveAllStorage(); renderMainTable(); closeModal('recoveryModal');
            } catch (e) { alert('ÊÅ¢Âæ©Ë≥áÊñôÊôÇÁôºÁîüÈåØË™§ÔºÅ'); }
        }

        function exportToExcel() {
            if (typeof XLSX === 'undefined') { alert("Êâæ‰∏çÂà∞ Excel ÂºïÊìéÔºÅ"); return; }
            if (mainTableData.length === 0 && db.rpLinks.length === 0) { alert("ÁõÆÂâçÊ≤íÊúâË≥áÊñôÂèØ‰ª•ÂåØÂá∫ÂñîÔºÅ"); return; }

            const wb = XLSX.utils.book_new();
            const wsMain = XLSX.utils.json_to_sheet(mainTableData.map(row => {
                let exp = {
                    "Âú∞ÂçÄ": row.region || "", "Â∞àÊ°à": row.project || "", "È°ûÂà•": row.category || "",
                    "Â§ßË£ΩÁ®ã": row.macro || "", "Â∞èË£ΩÁ®ã": row.micro || "",
                    "ÁµÑÂà•": row.group || "", "ÂßìÂêç": row.name || "", "‰∏ª‰∫ãÈ†Ö": row.task || "", "Â∞è‰∫ãÈ†Ö": row.subTask || ""
                };
                timelineCols.forEach(c => {
                    let colName = `${c.key.replace('y', '').replace('_w', '-W')}`;
                    exp[colName] = row[c.key] || "";
                });
                return exp;
            }));
            XLSX.utils.book_append_sheet(wb, wsMain, `ÂãïÊÖãÂ∞àÊ°àÁ∏ΩË°®`);
            XLSX.writeFile(wb, `‰∫∫ÂäõÈúÄÊ±ÇÁ∏ΩË°®_ÂãïÊÖãÂçÄÈñì.xlsx`);
        }

        function importFromExcel(event) {
            const file = event.target.files[0]; if (!file) return;
            if (typeof XLSX === 'undefined') { alert("Êâæ‰∏çÂà∞ Excel ÂºïÊìéÔºÅ"); event.target.value = ""; return; }
            const reader = new FileReader();
            reader.onload = function (e) {
                try {
                    const data = new Uint8Array(e.target.result); const wb = XLSX.read(data, { type: 'array' }); let newData = [];
                    if (wb.Sheets[wb.SheetNames[0]]) {
                        const rows = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]], { defval: "" });
                        newData = rows.map(r => {
                            let item = {
                                _id: Date.now() + Math.floor(Math.random() * 1000000),
                                region: String(r["Âú∞ÂçÄ"] || "").trim(), project: String(r["Â∞àÊ°à"] || "").trim(), category: String(r["È°ûÂà•"] || "").trim() === 'MP' ? 'Ops.' : String(r["È°ûÂà•"] || "").trim(),
                                macro: String(r["Â§ßË£ΩÁ®ã"] || "").trim(), micro: String(r["Â∞èË£ΩÁ®ã"] || "").trim(), group: String(r["ÁµÑÂà•"] || "").trim(), name: String(r["ÂßìÂêç"] || "").trim(), task: String(r["‰∏ª‰∫ãÈ†Ö"] || r["Â∑•‰Ωú‰∫ãÈ†Ö"] || "").trim(), subTask: String(r["Â∞è‰∫ãÈ†Ö"] || "").trim()
                            };
                            Object.keys(r).forEach(k => {
                                const matchW = k.match(/(\d{4})-W(\d+)/);
                                if (matchW && String(r[k]).trim()) item[`y${matchW[1]}_w${matchW[2]}`] = String(r[k]).trim();
                            });
                            return item;
                        });
                    }
                    mainTableData = mainTableData.concat(newData);
                    saveAllStorage(); renderMainTable(); alert(`‚úÖ Excel ÂåØÂÖ•ÊàêÂäüÔºÅ`);
                } catch (error) { alert("ËÆÄÂèñÊ™îÊ°àÁôºÁîüÈåØË™§„ÄÇ"); } finally { event.target.value = ""; }
            };
            reader.readAsArrayBuffer(file);
        }

        function copyTableToClipboard() {
            let tsvContent = ''; const table = document.getElementById('mainTable');
            for (let i = 0; i < table.rows.length; i++) {
                let row = table.rows[i]; let rowData = [];
                for (let j = 0; j < row.cells.length; j++) {
                    let cell = row.cells[j];
                    if (window.getComputedStyle(cell).display !== 'none') {
                        let valSpan = cell.querySelector('.val-span');
                        let inputEl = cell.querySelector('input');
                        let selectEl = cell.querySelector('select');
                        let val = selectEl ? selectEl.value : (inputEl ? inputEl.value : (valSpan ? valSpan.textContent : cell.textContent.replace(/\n/g, ' ').trim()));
                        rowData.push(val);
                    }
                }
                tsvContent += rowData.join('\t') + '\n';
            }
            navigator.clipboard.writeText(tsvContent).then(() => alert('‚úÖ Â∑≤Ë§áË£ΩÔºåË´ãËá≥ Excel Ë≤º‰∏ä (Ctrl+V)„ÄÇ'));
        }

        // ================= ÁØ©ÈÅ∏ËàáÊéíÂ∫è =================
        function updateMainFilterOptions() {
            if (!document.getElementById('flt_region')) return;
            const preserveValue = (id) => document.getElementById(id).value;
            const vals = { region: preserveValue('flt_region'), project: preserveValue('flt_project'), category: preserveValue('flt_category'), macro: preserveValue('flt_macro'), group: preserveValue('flt_group') };
            const setOptions = (id, field, defaultText) => {
                const el = document.getElementById(id); const uniqueVals = [...new Set(mainTableData.map(r => r[field]).filter(v => v))];
                el.innerHTML = `<option value="">${defaultText}</option>` + uniqueVals.map(v => `<option value="${v}">${v}</option>`).join('');
                el.value = vals[field] || "";
            };
            setOptions('flt_region', 'region', 'ÂÖ®ÈÉ®Âú∞ÂçÄ'); setOptions('flt_project', 'project', 'ÂÖ®ÈÉ®Â∞àÊ°à'); setOptions('flt_category', 'category', 'ÂÖ®ÈÉ®È°ûÂà•'); setOptions('flt_macro', 'macro', 'ÂÖ®ÈÉ®Â§ßË£ΩÁ®ã'); setOptions('flt_group', 'group', 'ÂÖ®ÈÉ®ÁµÑÂà•');
        }
        function applyMainFilter() { renderMainTable(); }
        function clearMainFilter() { document.getElementById('flt_region').value = ""; document.getElementById('flt_project').value = ""; document.getElementById('flt_category').value = ""; document.getElementById('flt_macro').value = ""; document.getElementById('flt_group').value = ""; document.getElementById('flt_keyword').value = ""; renderMainTable(); }
        function handleSort(column) { if (currentSort.column === column) currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc'; else { currentSort.column = column; currentSort.direction = 'asc'; } renderMainTable(); }

        // ================= Âè≥ÈçµÈÅ∏ÂñÆ =================
        function setupContextMenu() {
            const menu = document.getElementById('customContextMenu'); const table = document.getElementById('mainTable');
            table.addEventListener('contextmenu', (e) => {
                const td = e.target.closest('td'); const tr = e.target.closest('tbody tr'); if (!td || !tr) { menu.style.display = 'none'; return; }
               e.preventDefault(); document.querySelectorAl('td.highlight-target').forEach(el => el.classList.remove('highlight-target')); td.classList.add('highlight-target');
                const editBtn= document.getElementById('cm-edit'); const dupBt = document.getElementById('cm-duplicate'); c onst delBtn = document.getElementById('cm-delete'); const header = document.getElementById('cm-header');
                const indic es = JSON.parse(td.dataset.mergedIndices || "[]");
                 if (tr.dataset.type === 'readonly') {
                    header.innerText = 'üîí ÂîØËÆÄÊ®°Âºè'; editBtn.innerHTML = 'üîí Ë¶ñËßí‰∏çÂèØÁ∑®ËºØ'; dupBtn.inner HTML = 'üîí ‰∏çÂèØË§áË£Ω'; delBtn.innerHTML = 'üîí ‰∏çÂèØÂà™Èô§';
                    editBtn.classList.add('disabled'); dupBtn.classList.add('disabled');  delBtn.classList.add('disabled'); cmTargetContext = { type: 'readonly' };
                } else if (indices.length > 1) {
                    header.innerText = `üéØ ÂçÄÂ°äÊìç‰Ωú (${indices.length} Á≠Ü)`;  ed itBtn.i nne rHTML = '‚úè Ô∏è  ÊâπÊ¨°Á∑®ËºØÊ≠§ÂçÄÂ°äË≥áÊñô'; dupBtn.innerHTML = 'üîí ÂçÄÂ°ä‰∏çÂèØË§áË£Ω'; delBtn.innerHTML = 'üóëÔ∏è Âà™Èô§Ê≠§ÂçÄÂ°äÊâÄÊúâË≥áÊñô';
                    editBtn.classList.remove('disabled'); dupBtn.classList.add('disabled'); delBtn.classList .r emove(' dis abled'); c mT argetContext = { type: 'group', indices: indices };
                } else {
                    header.innerText = `üéØ ÂñÆÁ≠ÜË≥áÊñôÊìç‰Ωú`; editBtn.innerHTML = '‚úèÔ∏è ÈÄ≤ÈöéÁ∑®ËºØÊ≠§Á≠ÜË≥áÊñô'; dupBtn.innerHTML = 'üìÑ  Ë§á Ë£ΩÊ≠§ÂàóÂêë‰∏ã' ; d elBtn.inne rH TML = 'üóëÔ∏è Âà™Èô§Ê≠§Á≠ÜË≥áÊñô';
                    editBtn.classList.remove('disabled'); dupBtn.classList.remove('disabled'); delBtn.classList.remove('disabled'); cmTargetConext = { type: 'single', indices: indices };
                }
                 menu.style.display = 'block'; let x = e.pageX; let y = e.pageY;
                if (x + menu.offsetWidth > window.innerWidth) x = window.innerWidth - menu.offsetWidth - 10; if (y + menu.offsetHeight > window.innerHeight) y = window.innerHeight - menu.offsetHeight - 10;
                menu.style.left  = x + 'px'; menu.style.top = y + 'px';
            });
            document.addEventListener('click', (e) => { if (e.target.closest('#customContextMenu')) return; menu.style.display = 'none'; document.querySelectorAll('td.highlight-target').forEach(el => el.classList.remove('highlight-target')); });
        }
        funtion cmAction(action) {
            document.getElementById('customContextMenu').style.display = 'none'; document.querySelectorAll('td.highlight-target').forEach(el => el.classList.remove('highlight-target'));
            if (!cmTargetContext || cmTargetContext.type === 'readonly') return;
            if (cmTargetContext.type === 'single') { const idx = cmTargetContext.indices[0]; if (action === 'edit') openDataModal(idx); if (action === 'delete') deleteRow(idx); if (action === 'duplicate') duplicateRow(idx); }
            else if (cmTargetContext.type === 'group') { const indices = cmTargetContext.indices; if (action === 'edit') openGroupModal(indices); if (action === 'delete') deleteGroup(indices); }
        }
        function duplicateRow(index) {
            const newRow = { ...mainTableData[index] };
            newRow._id = Date.now() + Math.floor(Math.random() * 100000); // Á¢∫‰øùË§áË£ΩÊôÇÊúâÊñ∞ÁöÑÁç®Á´ã ID
            mainTableData.splice(index + 1, 0, newRow);
            saveAllStorage(); renderMainTable();
        }
        function deleteRow(i) { if (confirm("Á¢∫ÂÆöÂà™Èô§Ôºü")) { mainTableData.splice(i, 1); saveAllStorage(); renderMainTable(); } }
        function deleteGroup(indices) { if (confirm(`Á¢∫ÂÆöÂà™Èô§ ${indices.length} Á≠ÜË≥áÊñôÔºü`)) { indices.sot((a, b) => b - a).forEach(idx => { mainTableData.splice(idx, 1); }); saveAllStorage(); renderMainTable(); } }
        function clearAllData() { if (confirm("ÈÄôÂ∞áÊúÉÊ∏ÖÈô§Á∏ΩË°®‰∏äÁöÑÊâÄÊúâË≥áÊñôÔºåÁ¢∫ÂÆöÂóéÔºü")) { mainTableData = []; saveAllStorage(); renderMainTable(); } }


        window.updateRowField = function (index, field, val) {
            if (mainTableData[index]) {
                mainTableData[index][field] = val;
                if (field === 'group') { const validNames = db.groupLinks.filter(l => l.group === val).map(l => l.name); if (val && !validNames.includes(mainTableData[index].name)) mainTableData[index].name = ""; }
                if (field === 'macro') { const validMicros = db.processLinks.filter (l => l.macro === val). map(l => l.micro); if (val && !validMicros.includes(mainTableData[index].micro)) mainTableData[index].micro = ""; }
                if (field === 'task') { const validSubs = db.taskLinks.filter(l => l.task === val).map(l => l.subTask); if (val && !validSubs.includes(mainTableData[index].subTask)) mainTableData[index].subTask = ""; }
                saveAllStorage(); renderMainTable();
           }
        };

        window.updateInlineWrkload = function (index, weekKey, val) {
            if (val && (va < 0.1 || val > 1)) { alert("Ê¨äÈáçÂàÜÈÖçË´ãËº∏ÂÖ• 0.1 ~ 1 ‰πãÈñìÔºÅ"); renderMainTable(); return; }
            if (mainTableData[index]) { mainTableData[index][weekKey] = val; saveAllStorage(); updteFooterTotals(); }
        };
        window.updateFooterTotals = function () {
            let tempTotal s  = {};
            timelineCols.forEachc => tempTotals[c.key] = 0);
            const rows = document.querySelectorAll('#mainTable tbody tr');
            rows.forEach(tr => {
                timelineCols.forEach((c, idx) => {
                    let cell = tr.cells[colOrder.length + idx];
                    if (cell) {
                        let input = cell.querySelector('input');
                        let valSpan = cell.querySelector('.val-span');
                        let val = 0;
                        if (input) val = parseFloat(input.value) || 0;
                        else if (valSpan) val = parseFloat(valSpan.textContent) || 0;
                        tempTotals[c.key] += val;
                    }
                });
            });
            timelineCols.forEach(c => {
                let fCell = document.getElementById            ooter_' + c.key);
                if (fCell) { let sum = Math.round(tempTotals[c.key] * 100) / 100; fCell.innerText = sum > 0 ? sum : ""; }
                     });
        };

        f                ion applyColumnToggleDisplay(showFlags) {
            colOrder.forEach(col => {
                const className = '.col-' + col.toLowerCase(); const isShow = showFlags[col];
                document.querySelectorAll(className).forEach(el => { if (isShow) { el.classList.remove('hidden-c            ); i            !el.classList.contains('mer-            l')) el.style.dis            y = ''; } else { el.classList.add('hidden-col'); el.style.display = 'none'; } });
            });
            applyRowSpan(); updateStickyColumns(                 }

        function applyColumnToggle() { renderMainTable             }

        function applyRowSpan() {
            const tbody = document.querySelector('#mainTable tbody'); const rows = Array.from(tbody.querySelectorAll('tr'));
            rows.forEach(tr => {
                let baseIndices = tr.dataset.type === 'group' ? JSON.parse(tr.dataset.groupIndices) : [parseInt(tr.dataset.index)];
                Array.from(tr.cells).forEach(c             { cell.rowSpan = 1; cell.classList.                ve('merged-cell'); if (!cell.classList.contains('hidden-col')) cell.style.display = ''; cell.dataset.mergedIndices = JSON                ingify(baseIndices); });
                        });
            const mergeCols = Array.from({ length: colOrder.length }, (_, i) => i);
            mergeCols.forEach(colIdx => {
                let prevCell = null; let rowspan = 1;
                fo            let              i < rows.length; i++) {
                    const cell = rows[i].cells            lIdx]; if (!cell) continue;
                    let match = true;
                    if (i > 0             prevCell) {
                        for (let c            0; c <= colIdx; c++) {
                            const             Val = (td) => {
                                let s = td.querySelector('sel            ');
                                let vs = td.querySelector('.v        -span');
                                return s ? s.value : (vs ? vs.textContent.trim() : td.textContent.trim());
                            };
                           if (getVal(rows[i].cells[c]) !== getVal(rows[i - 1].cells[c])) { match = false; break; }
                        }
                    } else { match =                  if (match && prevCell && !cell.classList.contains('hidden-col')) {
                        rowspan++; prevCell.rowSpan = rowspan; cell.classList.add('merged-cell'); cell.style.display = 'none';
                        let prevIndices = JSON.parse(prevCell.dataset.mergedIndices); let currIndices = JSON.parse(cell.dataset.mergedIndices);
                        prevCell.dataset.mergedIndices = JSON.stringify([...new Set([...prevIndices, ...currIndices])]);
                    } else { if (!cell.classList.contains('hidden-col'))  {  prevCell = cell; r ow span = 1; } }
                }
            });
        }

        // ================= üåü ‰∏ªË°®Ê®°ÊÖãÊ°Ü‰øÆÂæ© (Add/Edit) =================
         fu nction initModalHe ad ers() {
            let monthFlexHtml = `<div style="display: flex; width: 100%; height: 100%; border-radius: 4px; overflow: hidden; border: 1px solid #90caf9;">`;
           forEach(m => {
                monthFlexHtml += `<div style="width: ${m.widthPct}%; border-right: 1px solid #90caf9; display: flex; align-items: center; justify-content: center; background-color: #e3f2fd; color: #0277bd; font-size: 11px; font-weight: bold; box-sizing: border-box; padding: 2px 0;">${m.label}</div>`;
            });
            monthFlexHtml += `</div>`;

            // üí° Ë®≠ÂÆöÊúà‰ªΩÂæûÁ¨¨‰∫åÊ¨ÑÈñãÂßã
            let monthHtml = `<div style="grid-column: 2 / span ${timelineCols.length}; grid-row: 1; padding: 0; margin-bottom: 2px;">${monthFlexHtml}</div>`;

            // üí° ‰øÆÊ≠£ÔºöËÆì„Äå‰∫∫Âì°„ÄçË∑®Ë∂äÂÖ©Ë°å (grid-row: 1 / span 2)ÔºåÂæπÂ∫ïÂ∞ÅÊ≠ªÂ∑¶‰∏äËßíÔºåÈò≤Ê≠¢ÊñáÂ≠óÊªëÈÅéÂéªÊôÇÁ©øÂπ´
            let weekHtml = `<div class="workload-header" style="grid-row: 1 / span 2; grid-column: 1; background:#f8fafc; justify-content:center; display:flex; align-items:center; border:none; border-right:2px solid #94a3b8; border-bottom:1px solid #cbd5e1; position:sticky; left:0; top:0; z-index:50; box-shadow: 3px 0 6px rgba(0,0,0,0.1); font-size: 13px; color: #334155;">‰∫∫Âì°</div>`;

            timelineCols.forEach((c, idx) => {
                let labelHtml = `${c.label}<br><span style="font-size: 9px; font-weight: normal; color: #78909c;">${c.subLabel}</span>`;
                  // üí° Ë®≠ÂÆöÊØè‰∏ÄÈÄ±ÁöÑÊ®ôÈ°åÂæûÁ¨¨ ‰∫åË°å „ÄÅÁ¨¨‰∫åÊ¨ÑÈñãÂßãÊéíÂàó
                weekHtml += `<div class="workload-header" style="grid-row: 2; grid-column: ${idx + 2}; cursor:pointer; line-height: 1.2;"  ti tle="Ê∏ÖÈô§ ${c.label}  ÂàÜ ÈÖç" onclick="clearWeekWorkload('${c.key}')">${labelHtml}</div>`;
            });

            const headerGrid = document.getElementById('modal_workload_headers');
            headerGrid.style.gridTemplateColumns = `80px repeat(${timelineCols.length}, var(--col-width))`;
            headerGrid.innerHTML = monthHtml + weekHtml;

            const ganttGrid = document.getElementById('gantt_grid');
            ganttGrid.style.gridTemplateColumns = `repeat(${timelineCols.length}, 1fr)`;
            ganttGrid.innerHTML = '<div></div>'.repeat(timelineCols.length);
        }

        function openDataModal(index) {
            document.getElementById('editIndex').value = index; document.getElementById('unassignedCount').value = 1;
            currentSelections = { group: "", name: [], region: "", project: "", category: "", macro: "", micro: [], task: "", subTask: [] }; currentWorkloads = {};

            let shouldOpenAdvanced = false; // üí° È†êË®≠ÁÇ∫Êî∂ÂêàÁãÄÊÖã

            if (index !== -1) {
                const row = mainTableData[index];
                currentSelections.group = row.group || ""; currentSelections.name = row.name ? [row.name] : [];
                currentSelections.region = row.region || ""; currentSelections.project = row.project || "";
                currentSelections.category = row.category || ""; currentSelections.macro = row.macro || "";
               currentSelections.micro = row.micro ? row.micro.split(',').map(s => s.trim()).filter(s => s) : [];
                currentSelections.task = row.task || ""; currentSelections.subTask = row.subTask ? row.subTask.split(',').map(s => s.trim()).filter(s => s) : [];
                let n = row.name || 'Êú™ÊåáÂÆöÂßìÂêç'; currentWorkloads[n] = {};
                timelineCols.forEach(c => { currentWorkloads[n][c.key] = row[c.key] || ""; });

                // üí° Â¶ÇÊûúÊòØÁ∑®ËºØËàäË≥áÊñôÔºå‰∏îË©≤Ë≥áÊñôÂ∑≤Á∂ìÊúâÂàÜÈÖçÁµÑÂà•ÊàñÂßìÂêçÔºåÂ∞±Ëá™ÂãïÂ±ïÈñãÈÄ≤ÈöéÂçÄÂ°ä
                if (row.group || row.name) shouldOpenAdvanced = true;
            }

            // üí° Âü∑Ë°åÁãÄÊÖãÂàáÊèõ
            if (typeof toggleAdvancedScheduling === 'function') {
                toggleAdvancedScheduling(shouldOpenAdvanced ? 'open' : 'close');
            }

            checkWaterfallState(); buildCheckLists(); document.getElementById('dataModal').style.display = 'block';
        }

        function openGroupModal(indices) {
            document.getElementById('editIndex').value = JSON.stringify(indices); document.getElementById('unassignedCount').value = 1;
            currentSelections = { group: "", name: [], region: "", project: "", category: "", macro: "", micro: [], task: "", subTask: [] }; currentWorkloads = {};
            const firstRow = mainTableData[indices[0]];
            currentSelections.group = firstRow.group || ""; currentSelections.region = firstRow.region || "";
            currentSelections.project = firstRow.proect || ""; currentSelections.category = firstRow.category || "";
            currentSelections.macro = firstRow.macro || ""; currentSelections.micro = firstRow.micro ? firstRow.micro.split(',').map(s => s.trim()).filter(s => s) : [];
            currentSelections.task = firstRow.task || ""; currentSelections.subTask = firstRow.subTask ? firstRow.subTask.split(',').map(s => s.trim()).filter(s => s) : [];
            indices.forEach(idx => {
                const row = mainTableData[idx]; const n = row.name || "";
                if (n && !currentSelections.name.includes(n)) currentSelections.name.push(n);
                let targetN = n === "" ? "Êú™ÊåáÂÆöÂßìÂêç" : n;
                if (!currentWorkloads[targetN]) currentWorkloads[targetN] = {};
                timelineCols.forEach(c => { currentWorkloads[targetN][c .k ey] = row[c.key] || ""; });
            });
            checkWate rf allState(); buildCheckLists(); document.getElementById('dataModal').style.display = 'block '; 
        }

        function checkWaterfallState() {
            co ns t hasRegion = currentSelections.region !== ""; const hasProject = currentSelections.project !== ""; const hasCategory = currentSelections.category !== "";
            const blockProject = document.getElementById('block_project'); const blockCategory = document.getElementById('block_category');
            const blockDetails = document.getElementById('block_details'); const btnSave = document.getElementById('btn_save_data');
            blockProject.style.display = hasRegion ? 'flex' : 'none'; blockCategory.style.display = (hasRegion && hasProject) ? 'flex' : 'none';
            if (hasRegion && hasProject && hasCategory) { blockDetails.classList.remove('step-hidden'); btnSave.disabled = false; btnSave.style.opacity = 1; }
            else { blockDetails.classList.add('step-hidden'); btnSave.disabled = true; btnSave.style.opacity = 0.5; }
        }

        function getPersonTaskCount(name) {
            let count = 0; const editIndexVal = document.getElementById('editIndex').value; let skipIndices = [];
            if (editIndexVal && editIndexVal.startsWith('[')) skipIndices = JSON.parse(editIndexVal); else if (editIndexVal) { const idx = parseInt(editIndexVal); if (idx !== -1) skipIndices = [idx]; }
            mainTableData.forEach((row, idx) => { if (skipIndices.includes(idx)) return; if (row.name === name) count++; });
           return count;
        }

        function buildCheckLsts() {
            const allGroups = [...new Set(db.groupLinks.map(l => l.group))];
            let allowedNames = currentSelections.group ? db.groupLinks.filter(l => l.group === currentSelections.group).map(l => l.name) : [];
            let validRps = db.rpLinks;
            if (currentSelections.region) validRps = validRps.filter(l => l.region === currentSelections.region);
             if (curentSelections.project) validRps = validRps.filter(l => l.project === currentSelections.project);
            const allMacros = [...new Set(db.processLinks.map(l => l.macro))];
            let allowedMicros = currentSelections.macro ? db.processLinks.filter(l => l.macro === currentSelections.macro).map(l => l.micro) : [];
            let allowedCategories = null;
            if (currentSelections.region && currentSelections.project) {
                const msForRp = db.milestones.filter(m => m.region === currentSelections.region && m.project === currentSelections.project);
                if (msForRp.length > 0) { allowedCategories = [...new Set(msForRp.map(m => m.category))]; if (currentSelections.category && !allowedCategories.includes(currentSelections.category)) { currentSelections.category = ""; setTimeout(checkWaterfallState, 0); } }
            }
            const allTasks = [...new Set(db.taskLinks.map(l => l.task))];
            let allowedSubTasks = currentSelections.task ? db.taskLinks.filter(l => l.task === currentSelections.task).map(l => l.subTask).filter(s => s !== "") : [];

            renderList('cl_region', 'region', [...new Set(db.rpLinks.map(l => l.region))], currentSelections.region, [...new Set(validRps.map(l => l.region))]);
            renderList('cl_project', 'project', [...new Set(db.rpLinks.map(l => l.project))], currentSelections.project, [...new Set(validRps.map(l => l.project)));
            renderList('cl_category', 'category', ['NPI', 'Ops.'], currentSelections.category, allowedCategories);
            renderList('cl_macro', 'macro', allMacros, curentSelections.macro, null);
            if (!currentSelections.macro) document.getElementById('cl_micro').innerHTML = '<span style="color:#f57c00; font-size:12px; font-weight:bold; grid-column: 1 / -1; margin-top: 5px;">üîí Ë´ãÂÖàÈÅ∏ÊìáÂ∑¶ÂÅ¥ÁöÑ„ÄåÂ§ßË£ΩÁ®ã„Äç‰ª•Ëß£ÈéñÂ∞èË£ΩÁ®ã</span>'; else renderList('cl_icro', 'micro', [...new Set(allowedMicros)], currentSelections.micro, null);
            renderList('cl_task', 'task', allTasks, currentSelections.task, null);
            if (currentSelections.task) document.getElementById('cl_subTask').innerHTML = '<span style="color:#f57c00; font-size:12px; font-wei ght:bold; grid-column: 1 / -1; margin-top: 5px;">üîí Ë´ãÂÖàÈÅ∏ÊìáÂ∑¶ÂÅ¥ÁöÑ„Äå‰∏ª‰∫ãÈ†Ö„Äç‰ª•Ëß£ÈéñÂ∞è‰∫ãÈ†Ö</span>'; else renderList('cl_subTask', 'subTask', [...new Set(allowedSubTasks)], currentSelections.subTask, null);
            renderList('cl_group', 'group', allGroups, cur rentSelections.group, null);
            if (!currentSelections.group) document.getElementById('cl_name').innerHTML = '<span style="color:#f57c00; font-size:12px; font-weight:bold; grid-column: 1 / -1; margin-top: 5px;">üîí Ëã•‰∏çÈÅ∏ÁµÑÂà•ÔºåÂèØÁõ¥Êé•ÂõûÂà∞‰∏ªÈ†Å‰∏ãÊãâÈÅ∏ÂñÆÊåáÊ¥æ</span>'; else renderList('cl_name', 'name', [...new Set(allowedNames)], currentSelections.name, null);
            renderGanttChart(); renderWorkloadInputs();
        }

        function renderList(containerId, fieldName, fullList, selectedValue, allowedList) {
            const container = document.getElementById(containerId); container.innerHTML = '';
            if (fullList.length === 0) { container.innerHTML = `<span style="color:#aaa; font-size:11px;">Â∞öÁÑ°Ë®≠ÂÆö</span>`; return; }
            fullList.forEach(item => {
                if (!item) return;
                const btn = document.createElement('button'); btn.type = "button";
                const isSelected = Array.isArra y( selectedValue) ? selectedValue.includes(item) : item === selectedValue;
                btn.className = `check-btn ${isSelected ? 'active' : ''} ${(!allowedList || allowedList.includes(item)) ? '' : 'disabled'}`;
                if (fieldName === 'name') {
                    const taskCount = getPersonTaskCount(item); const badgeBg = taskCount > 0 ? '#ffe0b2' : '#f5f5f5'; const badgeColor = taskCount > 0 ? '#e65100' : '#888';
                    btn.innerHTML = `<span>${item}</span> <span  st yle="font-size:10p x;  background:${badgeBg}; color:${badgeColor}; padding:2px 4px; border-radius:10px; box-shadow: 0 1px 2px rgba(0,0,0,0.1);">‰∫ãÈ†Ö: ${taskCount}</span>`;
                } else btn.textContent = item;
                btn.onclick = () => handleToggleSelection(fieldName, item);
                container.appendChild(btn);
            });
        }

        function handleToggleSelection(type, value) {
            if (type === 'micro' || type === 'name' || type === 'subTask') {
                const idx = currentSelections[type].indexOf(value);
                if (idx > -1) currentSelections[type].splice(idx, 1); else currentSelections[type].push(value);
            } else {
                if (currentSelections[type] === value) {
                    currentSelections[type] = "";
                    if (type === 'group') currentSelections.name = []; if (type === 'macro') currentSelections.micro = []; if (type === 'task') currentSelections.subTask = [];
                    if (type === 'region') { currentSelections.project = ""; currentSelections.category = ""; }
                    if (type === 'project') { currentSelections.category = ""; }
                } else {
                    currentSelections[type] = value;
                    if (type === 'group') currentSelections.name = []; if (type === 'macro') currentSelections.micro = []; if (type === 'task') currentSelections.subTask = [];
                    if (type === 'region') { const validP = db.rpLinks.filter(l => l.region === value).map(l => l.project); if (!validP.includes(currentSelections.project)) { currentSelections.project = ""; currentSelections.category = ""; } }
                    if (type === 'project') { const validR = db.rpLinks.filter(l => l.project = == value).map(l => l.region); if (!va lidR.includes(currentSelections.region) && validR.length === 1) currentSelections.region = validR[0]; currentSelecti        s.category = ""; }
                                       }

            const triggerFields = ['region', 'project', 'category', 'macro', 'micro', 'task'];
            if (triggerField            ncludes(type)) {
                if (currentSelections.region && currentSelections.p            ect && currentSelections.category) {
                    let matches = mainTableData.filter(row => {
                                    (row.region !=            urrentSelections.regi                re turn false; if (row.project !== currentSelections.project) return false;
                        if (row.category                 currentSelections.category) return false; if ((row.macro || "") !== (currentSelections.macro || "")) return false;
                                let selMicros = [...cur                Selections.micro].sort().join(','); let rowMicros = row.micro ? row.micro.split(',').map(s => s.trim()).sort().join(',') : "";
                        if (selMicros !== rowMicros) return false; if ((row.task || "") !== (currentSelections.task || "")) return false;
                        return true;
                              ;
                    if (ma                    .length > 0) {
                        let f                    = matches[0];
                        if (first.group) currentSelections.group = first.group;
                        if (first.subTask) { let rowSubs = first.subTask.split(',').map(s => s.trim()).filter(s => s); rowSubs.forEach(s => {                (!cu                tSelections.subTas            nclu            (s)) currentSelections.subTa        .ph(s); }); }
                        matches.for Each(m => {
                            let n = m.name || ""; if (n && !currentSelections.name.includes(n)) currentSelections.name.push(n);
                            let targetN = n === "" ? "Êú™ÊåáÂÆöÂßìÂêç" : n;
                            if  (!currentWorkloads[targetN]) currentWorkloads[targetN] = {};
                            timelineCols.forEach(c => { if (m[c.key]) currentWorkloads[targetN][c.key] = m[c.key]; });
                        });
                        let matchedIndices = []; mainTableData.forEach((row, idx) => { if (matche            ncludes(row)) matchedIndices.push(idx); });
                                  t currentEditVal = document.getElementById('editIndex').valu;            t originalIndices = [];
                        if (currentEdi            l && currentEditVal.startsWit()            riginalIndices = JSON.parse(currentEditVal            else if (currentEditVal && currentEditVal !== '-1') originalIndices = [p            eInt(currentEditVal)];
                                document.getElementById('editIndex').value = JSON.stringify([...new Set([...originalIndices, ...matchedIndices])]);
                             } else {
                        if (currentSelections.name.length > 0) {
                            if (confirm('Êü•ÁÑ°Ê≠§Ë®≠ÂÆöÁµÑÂêàÁöÑËàäË≥áÊñô„ÄÇ\nÊòØÂê¶Ë¶ÅÊ∏ÖÈô§‰∏ãÊñπÁõÆÂâçÈÅ∏ÊìáÁöÑ„Äå‰∫∫Âì°„ÄçËàá„ÄåÊ¨äÈáçÂàÜÈÖç„ÄçÔºü\n\n            ] Ê∏ÖÁ©∫‰∏¶ÈáçÊñ∞ÂàÜÈÖç\n[ÂèñÊ∂à] ‰øùÁïôÁï∂Ââç‰∫∫Âì°Ë®≠ÂÆö')) { currentSelections.group = ""; curr            Selections.name = []; currentWorkloads = {} ; document.getElementById('editIndex').value =             '; }
                        }
                                              }
                     }
                        checkWaterfallState();                 dCheckLists();
        }

        window.upd at eW orko                 function (name, weekKey, val) {
              if  (!cur                Wo rkloads[name]) currentWorkloads[name] = {};
            curo                ads[name][weekKey] = val;
        }
        function                 erWorkloadInputs() {
            const container                ocument.getElementById('workload_rows'); const countContainer = dc                t.getElementById('unassigned_count_container');
            la                = currentSelections.nam                ngt h > 0  ?  cur r entSelections.name : ['Êú™ÊåáÂÆöÂßìÂêç'];
            if (currentSelections.name.length === 0) countContainer.st                display = 'flex'; else countContainer.style.display = 'none';
            let html = '                           names.forEach(n => {
                           if (!currentWorkloads[n]) { currentWorkloads[n] = {};                elineCols.forEach(c => currentWor k loads[n][c.key] = ''); }
                html += `<d i v class="workload-row                yle="grid-template-columns: 80px repeat(${ti                ls.length}, var(--col-width));">`;

                            // üí° ‰øÆÊ≠£ÔºöÂä†Ê∑±ÈÇäÊ°ÜÈ°èËâ≤ËàáÈô∞ÂΩ±ÔºåËÆìÊç≤ÂãïÊôÇÁöÑÈÇäÁïåÊõ¥Ê∏ÖÊô∞
                html +                div class="workload-row-name" title="ÈªûÊìäÊ∏ÖÈô§" style="cursor:point                position:sticky; left:0; z-index:40; background:#f0f8ff; border-r                :2px solid #94a3b8; box-shado                px 0 6px rgba(0,0,0,0.08); dispa                ex; align-items:center; justify-cn                :center;" onclick="clearPersonW                oad('${n}')">${n}</div>`;

                            timelineCols.forEach(c => {
                                 et val = currentWorkloads[n][                y] || '';
                    html += `<div st                "padding:0 1px;"><input type="number" class="workload-input-modl                lue="${val}" min="0.1" max="1" step="0.05" oninput="updateWorkload('${n}', '${c.key}', this.value)" style="border-right:1px solid #eee;"></div>`;
                })                              html += `</div>`;
                              });
            container.innerHTML = html;
        }


        win        w.clearPersonWorkload = function (name) {
            if (confirm(`Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§„Äå${name}„ÄçÁöÑÊâÄÊúâÊ¨äÈáçÂàÜÈÖçÂóéÔºü`)) { if (currentWorkloads[name]) { timelineCols.forEach(c => currentWorkloads[name][c.key] = ''); renderWorkloadInputs(); } }
         }
        window.clearWeekWorkload = unction (weekKey) {
            if (confirm(`Á¢∫ÂÆöË¶ÅÊ∏ÖÈô§„ÄåÊâÄÊúâ‰∫∫„ÄçÂú®Ë©≤ÈÄ±ÁöÑÂàÜÈÖçÂóéÔºü`)) { let names = currentSelections.name.length > 0 ? currentSelections.name : ['Êú™ÊåáÂÆöÂßìÂêç']; names.forEach(n => { if (currentWorkloads[n]) currentWorkloads[n][weekKey] = ''; }); renderWorkloadInputs(); }
        }

        function renderGanttChart() {
            const parent = document.getElementById('gantt_container_parent');
            const barsContainer = document.getElementById('gantt_bars');
            const container = document.getElementById('gantt_container');
            barsContainer.innerHTML = '';

            // üí° ‰øÆÊ≠£‰ΩçÁΩÆÔºöÂº∑Âà∂ËÆìÈÄ≤Â∫¶Ê¢ùÁà∂ÂÆπÂô®ÁöÑÂØ¨Â∫¶ËàáÂ∑¶ÈÇäË∑ùÔºåÁ≤æÊ∫ñË≤ºÂêà‰∏ãÊñπÁöÑ Wk Ê¨Ñ‰Ωç
            parent.style.width = `calc(var(--col-width) * ${timelineCols.length})`;
            parent.style.marginLeft = '80px';

            if (!currentSelections.region || !currentSelections.project || !currentSelections.category)  { parent.style.display = 'none'; return; }
            let ms = db.milestones.filter(m => m.region === currentSelections.region && m.project === currentSelections.project && m.category === currentSelectio
                s.category);
            if (ms.length === 0) { parent.style.display = 'none'; r
                    turn; }
            parent.style.display = 'block'; ms.sort((a, b) => new Date(a.star                        start));

            const duration = timelineEndMs - timelineStartMs;
              let lanes = [];

            ms.forEach(m => {
                // Á¢∫‰øùÁ≤æÊ∫ñÊäìÂà∞‰∏ÄÂ§©ÁöÑ‰∏ÄÈ†≠‰∏ÄÂ∞æÔºåËß£Ê±∫Â∞çÈΩäË™§Â∑Æ
                const startT = new Date(m.start).setHours(0, 0, 0, 0);
                const endT = new Date(m.end).setHours(23, 59, 59, 999);
                             ndT < timelineStartMs || startT > time                        n;

                let rend                            tartT, timelineStartMs);
                let renderEnd = Math.min(endT, timel                                    let leftPct = ((renderStart - timelineStartMs) / duration) * 100;
                let widthPct = ((renderEnd - re                        atio                                   let assi                    1;

                   
                       for (let i = 0; i < lanes.length; i++) { if (lanes[i] < renderStart) { assignedLane = i; lanes[i] = renderEnd;  break; } }
                if (assignedLane === -1) { lanes.push(renderEnd); assignedLane = lanes.length - 1; }

                const topPos = assignedLane * 20 + 2;
                const sd = new Date(m.start); const ed = new Date(m.end);
                const strStart = `${sd.getMonth() + 1}/${sd.getDate()}`; const str             = `${ed.getMonth() + 1}/$e            etDate()}`;
                const bar = document.createE            ent('div');

                // üí° ‰øÆÊ≠£È°èËâ≤ÔºöÁõ¥Êé•Âà©Áî®Ë°åÂÖßÊ®£ÂºèË≥¶‰∫à NPI / Ops. ‰∏çÂêåÁöÑ‰∏ªÈ°åËâ≤
                         let bgColor = m.category === 'NPI' ? '#e1f5fe' : '            f5e9';
                let textColor = m.category === 'N             ? '#0288d1' : '#2e7d32';
                let borderColor = m.category === 'NPI'            '#81d4fa' : '#a5d6a7';

                bar.className =             ntt-bar`;
                bar.style.left = `${leftPct}%`;
                bar.style.width = `${widthPct}%`;
                         bar.style.top =             topPos}px`;
                            bar.style.backgroundColor = bgColor;
                bar.style.border = `1px solid ${borderColor}`;
                            bar.style.color = textColor;
                bar.style.textShadow = 'none'; // Ë¶ÜËìãÊéâÈ†êË®≠ÁöÑÊñáÂ≠óÈ°èËâ≤

                bar.title = `[${m.category                {m.phase} (${m.start}~${m.end})`;
                bar.innerHTML = `<span style="color:${textColor}">${strStart}</span><b style="color:${te                lor}">${m.phase}</b><span style="color:${textColor}">${strEnd}</span>`;
                barsContainer.appendChild(bar);
            });
            container.style.height             ${Ma            max(40, lanes.length * 20                 }px`;
        }

                       ction saveDataRow() {
            let isFormValid = true; document.querySelectorAll('.workload-input-modal').forEach(el => { if (el.value && !el.checkValidity()) { isFormValid = false; el.reportValidity(); } });
            if (!isFormValid) return;
            const editIndexVal = document.getElementById('editIndex').value; let indicesToRemove = [];
            if (editIndexVal &            ditIx            .startsWith('[')) indicesToRemove = JSON.parse(editIndexVal); else if (editInde            l && editIndexVal !== '-1') in                sToRemove = [parseInt(editIndexVal)];
            let namesToSave = currentSelections.name.length > 0 ? currentSelections.name : [];
            if (namesToSave.length === 0) { for (let i = 0; i < (parseInt(document.getElementById('unassignedCount').value) || 1); i++) n            sToS            .push(''); }
            le            plitFactor = (currentSelections.micro.length || 1) * (currentSelections.subTask.length || 1);
            let baseExistingRow = {};
            if (indicesToR            ve.length > 0 && mainTableDa                ndicesToRemove[0]]) {
                Object.keys(mainTableData[indicesToRemove[0]]).forEach(k => { if (k.startsWith('y')                !timelineCols.find(c => c.key === k)) baseExistingRow[k] = mainTableData[indicesToRemove[0]][k]; });
            }
            let             Rows             ];
            names                ve.forEach(n => {
                (currentSelections.micro.length ? currentSelections.micro : ['']).forEach(m => {
                                (currentSelections.subTask.length ? currentSelections.subTask : ['']).forEach(s => {
                                    let row = { ...baseExistingRow, _id: Date.now() + Math.floor(Math.random() * 100000), region: currentSel                ons.region, project: currentSelections.project, category: currentSelections.category, macro: currentSelections.mac                micro: m, task: currentSelections.task, subTask: s,             up:             re ntSelections.group, name: n };                                    let targetN = n === "" ? "Êú™ÊåáÂÆöÂßìÂêç" : n;
                        timelineCols.forEach(c => {
                            let val =c                ntWorkloads[targetN] ? currentWorkloads[targt            c.k             : "";
                            if (val && splitFactor > 1) row[c.key] = Math.round((parseFloat(val) / splitFactor) *            0) / 100; else row[c.key] = val;
                        });
                        newRows.push(row);
                             });
                });
            });
            if (indicesToRemove.length > 0) { const insertPos = Math.min(...indicesToRemov             indicesToRemove.sort((a, b) => b - a).forEach(idx => mainTableDat                lice(idx, 1)); mainTableData.splicei                tPos, 0, ...newRows); } else { mainTableData.push(...newRows); }
            saveAllStorage(); render                Table(); closeModal('dataModal');
        }

        // ================= ‰∏ªÊ∏≤Êüì =================
                    function renderMainTable() {
            update                FilterOptions();
              let thead =  do cument.querySe le ctor('#mainTable  th ead');
            thead.innerHTML = '<tr id="mon                eadTr"></tr><            id="m            TheadTr"></tr>';
            const monthTr = document.getElem            ById('monthTheadTr');
            const theadTr = document.getElementById('mainTheadTr');
            const tbody = document.querySelector('#mainTable tbody'); tbody.innerHTML = '';
            let tfo             document.querySelector            mainTable tfoot');
                        if (!tfoot) { tfoot = document.createElement('tfoot'); document.getElementById('ma            able').ap                Child(tfoot); }
                        tfoot.innerHTML = '';

                          const colDefs = {
                region: { title: 'Âú∞ÂçÄ', cls: 'col-region', bg:                    , project: { title: '                        ls: 'col-project', bg: '' },
                category: {                          'È°ûÂà•', cls: 'col-category', bg: 'background:#fff3e0;                        acro: { title: 'Â§ßË£ΩÁ®ã', cls: 'col-macro', bg: 'background:#e0f2f1;' },
                                    :                     le: 'Â∞èË£ΩÁ®ã', cls: 'col-micro', bg: 'background:#e0f2f1;'}                    k: { title: '‰∏ª‰∫ãÈ†Ö', cls: 'col-task', bg: 'background:#e8f5e9;' },
                sub                : {                 e: 'Â∞è‰∫ãÈ†Ö', cls: 'col-subtask', bg: 'background:#e8f                     }, group: { title: 'ÁµÑÂà•', cls: 'col-group', bg: '' }, name: { title: 'ÂßìÂêç', cls: 'col-name', bg: '' }
            };

                           colOrder.fo                h(co            > {                          let def = colDe                ol];
                month                    nerHTML += `<th rowspan="2" class="sortable ${def.cls}" style="${def.bg} border                        m: 1px solid #ddd; vertical-align: middle;" data-col="${col}" draggable=" tr ue" ondragstart="dragStart(event)" on dr agend="dragEnd(event)" ondragover="dr ag Over(event)" ondragleave="dragLeave(e ve nt)"                    op="dropC                        nt)" onclick="handleSort('${col}')" title="ÂèØÊãñÊõ≥ÊéíÂ∫èÊ¨Ñ‰Ωç">${def.title}</th> `; 
            });

            let monthFlexHtm l  = `<div style="display: flex; width: 100%; he ig ht: 100%;">`;
            timelineMonths.forEa ch (m => {
                                             nt                xHtml += `<div style="width:                    widthPct}%; border-righ t:  1px solid #90caf9; display: fl ex ; align-items:                     r; justify-content: center;                kg                d-color: #            2fd;             or: #0277bd; font-size: 13px; font-weight: bold; box-sizi                border-box;">${m.label}</div>`;
                        });
            monthFlexHtml += `</div>`;
            monthTr.innerHTML += `<th colspan="${timelineCols.length}" style="padding: 0; bo            r-bot            : 2px solid #bbdefb; border-right: none;">${monthFlexHtml}</th>`;                       timelineCols.forEach(c => {
                let labelHtm             `${c.label}<br><span style="font-size: 9px; font-weight: norma            color: #78909c;">${c.su            bel}</span>`;
                               adTr.innerHTML += `<th class="so                le time-col" onclick="handleSort('${c.key}')" style="li                eight: 1.2;">${labelHtml}</th>`;
            });

                        const showFlags = {
                                  region: document.getElemen                d('toggleRegion').checked, project: doc                t.getElementById('tog                    oject').checked,
                category: document.getElementById('toggleCategory').checked, macro: document.getElementById('toggleMacro').checked,
                            micro: document.getElementById('toggleMicro').checked, task: document.ge                mentById('toggleTask'                ecked,
                sub                     document.getElementById('togglS                    k').checked, group: documenE                    tById('toggleGroup').checked,
                               name: document.getElementById('toggleName').checked
            };

            if (mainTableData.length === 0) {
                tbody.innerHTML = `<tr><td colspan="${colOrder.length + timeli                    s.length}" style="color:#888; padding: 20px                    ÊòØÁ©∫ÁöÑÔºåË´ãÈªûÊìä‰∏äÊñπ„ÄåÊñ∞Â¢ûÂ∞àÊ°à/‰ªªÂãô„Äç„ÄÇ</td></tr>`;
                                   yColumnToggleDisplay(showFlags); return;
            }

            const f_reg = document.getElementById('flt_region').value; const f_proj = document.getElementById('flt_project').value;
            co                    _cat = document.getElementById('                    ategory').value; const f_m                        ocument.getElementById('flt_macro').value;
            const f_grp = document.getElementById('flt_group').value; const f_kw = document.getElementById('fl t_ keywor                        lue.toLowerCase();

            let filteredData = mainTableData.filter((row, originalIndex                    {
                               row._originalInde                        iginalIndex;
                if (f_reg && row.region !== f_reg) return false; if (f_proj && row.p                         !== f_proj) return false;
                if (f_cat && row.category !== f_cat) return false; if (f_mac && row.macro !== f_mac) return false;
                  if (f_grp && row.group !==  f_ g r p) return  f alse;
                if (f_kw && !`${row.name                    '}                    w.micro || ''} ${row.task ||                        {row.subTask || ''}`.toLowerCase().includes(f_kw)) return f al se;
                  return  t rue;
             }) ;

                                nst isAggregated = Object.values(showFlags).some(v => !v);
            const isOnlyNameHidden = !                        ags.name && showFlags.region && showFlags.project && showFlags.category && showFlags.macro && showFlags.micro && s h owFlags.group && showFlags.task   && showFla gs .subTask;
            let display Dat a   = [];

              if (!isAggregated) { 
                 displayData = filteredData.map(row =                    ..                     originalIndex: row._origin                        x }));
            } else {
                let grouped = {};
                filteredData.forEa                        w) => {
                    let key = colOrder.map(col => showFlags[col] ? (row[col] || "") : "-").join('|');
                    if (!grouped[key])  { 
                        grouped [ke y ]  = { isGro u ped: true, originalIndices: [] };
                                                      timelineCols.forEach(c => grou                        y][c.key] = 0);
                        colOrder.forEac h( col =>  gr ouped[key][col]  =  showFlags[col] ? ( ro w[col] || "                        ");
                    }
                    grouped[key].originalIndices.push(row._originalIndex)                                        timelineCols.forEach(c => { grouped[key][c.key] += parseFloat(row[c.key]) || 0; });
                  });
                displayDa t a = Object .v alues(grouped).map(row => {
                        ti m elineCols.forEach(c => { if  ( row[c.key] > 0) row[c.key] = Math.round(row[c.key] *                     /                     else row[c.key] = ""; });
                                      return row;
                });
            }

            displayData.sort((a, b) =                                      if (currentSort.column) {
                    if (currentSort.column.startsWith('y') && currentSort.column.includes('_w')) {
                          return currentSort.di rec t i on === 'as c ' ? parseFloat(a[currentSort.column] || 0) - p                    lo                    currentSort.column] || 0) :                        Float(b[currentSort.column] || 0) - parseFloat(a[currentSo rt .column ] | | 0);
                      } else {                                           return currentSort.direction === 'asc' ? String(a[currentSort.column] || "").                        Compare(String(b[currentSort.column] || ""), 'zh-TW') : -String(a[currentSort.column] || "").localeCompare(String( b [currentSort.column] || ""), 'z h -TW');
                      }
                 }
                     for (let col of colOrder)  { 
                    let cmp = String(a[col] || "")                    le                    re(Stri                        ol] || ""), 'zh-TW');
                    if (cmp !== 0) return cmp;
                }
                               re                 0;
                    });

                            ment.querySelectorAll('th.sortable').forEach(th => {
                th.classList.remove('asc', 'desc');
                                  (th.getAttribute('onclick') && th.getAttribute('onclick').in                    s(`'${currentSort.column}'`)) th.class                .au                tSort.direction);
                        });

                           st allGroups = [...new(                roupLinks.map(l => l.grou                    
            const allMacros = [...new Set (d b. proc                    nks.map(l => l.macro))];
            co nst  al lTasks                    ..new Set(db.taskLinks.map(t => t.task))];

            co                        aseCache = {};
            db.milestones.f                        (m => {
                if (!m.start || !m.end) retur                                     let rpcKey = `${m.region}|${m.proj{                        gory}`;
                                  if  (!pha s eCac h e[rpcKey]) phaseCache[rpcKey] = [];
                phaseCache[rpcKey].push(m);
            });

                                splayData.forEach((row) => {
                let tr = document.createElement('t                                       if (row.isGrouped) {
                                   i                sOnly                Hidden) { tr.dataset.groupIndices = JSON.stringify(row.originalIndices);                 ataset.type = 'group'; } else { tr.                    et.type = 'readonly';                                  } e                        tr.dataset.index = row.originalIndex; tr.dataset.type = 'single'; }

                let cellsHtml = '';

                colOrder.forEa                         => {
                 t                         = colDefs[col].cls;
                                         let isGrp = row.isGrouped;

                                                ÂçäÈÉ®ÁµÇÊ•µÂ∞çÈΩäÔºöÂº∑Âà∂‰∏ãÊãâÈÅ∏ÂñÆÂú®ÂîØËÆÄÊôÇÁßªÈô§ÁÆ≠È†≠‰∏¶ËÆäÊàê‰∏ÄËà¨ÊñáÂ≠óÈ°èËâ≤
                  S                            isGrp ? 'pointer-                            non e; col o r:#3 3 3; font-weight:normal; background-image:none !important; border-color:transparent !important; -webkit-appearance:none                            rance:none;' : '';
                    let sAttr = isGrp ? 'tabindex="-1"' : '';

                                         // üí° Â∑¶ÂçäÈÉ®ÁµÇÊ•µÂ∞çÈΩäÔºöËÆìÂú∞ÂçÄ„ÄÅÂ∞àÊ°àÁ≠âÁ¥îÊñáÂ≠óÁöÑ Padding ‰ΩàÂ±ÄË∑ü‰∏ãÊãâÈÅ∏ÂñÆ‰∏ÄÊ®°‰∏ÄÊ®£ÔºÅ
                                         let textWrapperStart = `<div style="font-size:13px; padd                             x 8px; border:1px solid transparent; display:flex; align-items:center; ju                            ontent:center; color:#333; white-space:nowrap;">`;
                    let tee                            `</div>`;

                    if (col === 'category') {
                                             let catHtml = row.category === 'NPI' ? `<span cl                            g-npi">NPI</span>` : (row.category === 'Ops.' ? `<span class="ta                            ps.</span>` : (row.category |                                             cellsHtml += `<td class="${tdClass}">${textWrapperStart}${catHtml}${textWrapperEnd}</td>`;
                    }
                    else if (col === 'macro') {
                        let onChg = isGrp ? '' : `onchange="updateRowField(${row.originalIndex}, 'macro', t                        lue)                                              ce                    ml<                    ass="${tdClass}"><select class="inline-select" style="${sStyle}" ${sAttr} ${onChg}                    ion value="">Êú™ÊåáÂÆö</option>${allMacros.map(x => `<option value}                    ow.macro === x ? 'selected'                     >${x}</option>`).join                        /select></td>`;
                    }
                    else if                        === 'micro') {
                        let vMic = row.macro ? [...new Set(db.processLinks.filter(l => l.macro === row.macro).map(l => l.micro).filter(s => s))] : [];
                        let onChg = isGrp ? '' : `onchange="updateRowField(${row.originalIndex}, 'micro', this.value)"`;
                        cellsHtml += `<td class="${tdCla                    <select c                        inline-select" style="${sStyle}" ${sAttr} ${onChg}>${row.macro ? `<option value="">Êú™ÊåáÂÆö</option>` + vMic.map(x => `<option value="${x}" ${row.micro === x ? 'selected' : ''}>${x}</option>`).join('') : `<option value="">Ë´ãÂÖàÈÅ∏Â§ßË£ΩÁ®ã</option>`}</select></td>`;
                    }
                                     se                (col                 k') {
                                    let onChg = isGrp ? ''             oncha            ="updateRowField(            ow.originalIndex}, 'task', this.value)"`;
                                 cellsHtml +                  class="${tdClass}"><select class="inline-select" style="${sStyle}" ${sAttr} ${o            g}><o            on value="">Êú™ÊåáÂÆö</option>${allTasks.map(x => `<option value="${x}" {            .task === x ? 'selected'             '}>${x}</option>`).join(''                select></td>`;
                    }
                                else if (col === 'subTask') {
                        let vSub = row.task ? [...new Set(db.taskLinks.filter(t => t.task === row.task).map(t => t.subTask).filter(s => s))] : [];
                        let onChg             sGrp            '' : `onchange="updateRowFie                {row.originalIndex}, 'subTask', this.value)"`;
                                    cellsHtml += `<td class="${tdClass}"><select class="inline-select" style="${sStyle}" ${sAttr} ${onChg}>${row.task ? `<option value="">Êú™ÊåáÂÆö</option>` + vSub.map(x => `<option value="${x            ${ro            ubTask === x ? 'selecte            : ''}>${x}</option>`).join('')             <option value="">Ë´ãÂÖàÈÅ∏‰∏ª‰∫ãÈ†Ö</option>`}</s        ect></td>`;
                    }
                    else if (col === 'group') {
                                 let onChg = isGrp ? '' : `o                nge="updateRowField(${row.originalIndex}, 'group', t                value)"`;
                                    cellsHtml += `<td class="${tdClass}"><select cl                "inline-select" style="${sStyle}" ${sAttr} ${onCh                option value="">Êú™ÊåáÂÆö</option>${allGroups.map(x => `<opt                value="${x}" ${row.grou                = x ? 'selected' : ''                x}</option>`).join('')}</sel                </td>`;
                    }
                                   else if (col === 'name') {
                                       let vName = row.grou                    ...new Set(db.groupLinks.filter(l => l.group === row.group).map(l => l.name))] : [];
                                                let onChg = isGrp ? '' : `onchange                    ateRowField($                    originalIndex}, 'name', this.valu                    
                        cellsHtml += `<td class="${tdClass}"><select class="inle                     style="${sStyle}" ${sAttr} ${o                    >${row.group ? `<option value="">Êú™ÊåáÂÆö</option>` + vName.map(x => `<option value="$$                    name === x ? 'selected' : ''}>${x}</option>`).join('                        <option value="">Ë´ãÂÖà                        ption>`}</select>                            
                    }
                                         else {
                        cel+                            class="${tdClass}">${textWrapperStart}${                            ] || ""}${textWrapperEnd}</td>`;
                                         }
                });

                                    Phases = [];
                if (row.region && row.project && row.ct&                            gion !== "-" && row.project !== "-" && row.category !== "-") {
                                         let rpcKey = `${row.region}                            project}|${row.category}`;
                                            rowPhases = phaseCache[rpcKey] || [];                                         }

                let maxLaneIndex = -1;
                le                                es = [];
                let validPhases = [];

                                      owPhases.                                m => {
                    let mStart = new                                start).setHours(0, 0, 0, 0);
                    let mEnd = new Dat                                .setHours(23, 59, 59, 999);
                                                              (mEnd >=                             eStartMs && mStart <= timelineEndMs) {
                        validPhas                            ({ ...m, mStart, mEnd });
                        let renderStart = Math.max(mStart,                        in                    tMs)                                         let renderEnd = Math.min(mEnd, timelineEndMs);

                                       let lIndex = -1;
                        for (let i = 0; i < rowLa                    ength; i++) { if (rowLanes[ i] < renderStart) { lIndex = i; rowLanes[i] = renderEnd; br                    } }
                        if (lIndex ===                 {            wLan        .push(renderEnd); lIndex = rowLanes.length - 1; }
                        if (lIndex > maxLaneIndex) maxLaneIndex = lIndex;
                    }
                });

                let paddingTop = maxLaneIndex >= 0 ? ((maxLaneIndex + 1) * 20 + 4) : 2;

                timelineCols.forEach((c, idx) => {
                    let phasesHtml = "";
                    if (idx === 0) {
                        phasesHtml = `<div style="position:absolute; top:0; left:0; width:0; height:100%; z-index:5; pointer-events:none; overflow:visible;">`;
                        let drawingLanes = [];

                        validPhases.forEach(m => {
                            let renderStart = Math.max(m.mStart, timelineStarts);
                            let renderEnd = Math.min(m.mEnd, timelineEndMs);

                            let lIndex = -1;
                            for (let i = 0; i < drawingLanes.length; i++) { if (drawingLanes[i] < renderStart) { lIndex = i; drawingLanes[i] = renderEnd; break; } }
                            if (lIndex === -1) { drawingLanes.push(renderEnd); lIndex = drawingLanes.length - 1; }

                            let startOffsetDays = (renderStart - timelineStartMs) / 86400000;
                            let durationDays = (renderEnd - renderStart) / 86400000;

                            let leftStr = `calc((var(--col-width) + 1px) * ${startOffsetDays / 7})`;
                            let widthStr = `calc((var(--col-width) + 1px) * ${durationDays / 7} - 1px)`;

                            let bgColor = m.category === 'NPI' ? '#e1f5fe' : '#e8f5e9';
                            let textColor = m.category === 'NPI' ? '#0288d1' : '#2e7d32';
                            let borderColor = m.category === 'NPI' ? '#81d4fa' : '#a5d6a7';
                            let topPos = lIndex * 20 + 2;

                            phasesHtml += `<div class="phase-bar" title="[${m.category}] ${m.phase} (${m.start}~${m.end})" style="top: ${topPos}px; left: ${leftStr}; width: ${widthStr}; background: ${bgColor}; color: ${textColor}; border: 1px solid ${borderColor}; border-radius: 3px;">&nbsp;${m.phase}</div>`;
                        });
                        phasesHtml += `</div>`;
                    }

                            let hasPhase = validPhases.some(m => c.startMs <= m.mEnd && c.endMs >= m.mStart);
                    let bgStyle = hasPhase ? "background            lor: #fafcff;" : "";

                    let val = row[c.key] || "";
                             if (row.isGrouped)                                       // üí° Âè≥ÂçäÈÉ®ÁµÇÊ•µÂ∞çÈΩäÔºö‰ΩøÁî® <input disabled> ËÆìÊ°ÜÁ∑öÈ´îÁ©çËàáÂπ≥Â∏∏Ëº∏ÂÖ•Ê°ÜÂÆåÂÖ®ÂêªÂêàÔºå‰∏¶ÈÄèÈÅé CSS Âº∑Âà∂ÈªëÂ≠óÈ°ØÁ§∫
                        cellsHtml += `<t                ass="time-col" style="padding-top: ${paddingTop}px !important; ${bgStyle}">${phasesHtml}<input type="text" class="inline-workload-input val-span" value="${val}" disabled style="color:#333; font-weight:bold; background:transparent; border-color:transparent; opacity:1; -webkit-text-fill-color:#333; cursor:default;"></td>`;
                    } else {
                        cellsHtml += `<td class="time-col" style="padding-top: ${paddingTop}px             port            ;  ${bgStyle}">${phasesHtml}<input type="number" class="inline-workload-input" value="${val}" min="0.1" max="1" step="0.05"        nchange="updateInlineWorkload(${row.originalIndex}, '${c.key}', this.value)"></td>`;
                    }
                });

                tr.innerHTML = cellsHtml;
                tbody.appendChild(tr);
            });

            let totals = {};
            timeline Cols.forEach(c => tot als[c.key] = 0);
            displayData.forEach(row => {
                timelineCols.forEach(c => { totals[c.key] += (parseFloat(row[c.key]) || 0); });
            });

            const firstVisibe            = colOrder.find(c => showFlags[c]) || 'none';
            let footerHtml = `<tr>`;
            colOrder.forEach(c            => {
                let text = col === firstVisibleId ? 'Áï∂ÂâçÁ∏ΩË®à ‚ûî' : '';
                         footerHtml += `<td class="${colDefs[col].cls}" style="background-color: #ffe082; font-weight: bold; color: #d84315; text-align: right; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">${text}</            `;
            });
             timelineCols.forEach(c => {
                         let sum = Math.roud                als[c.key] * 100) / 100;
                footerHtml += `<td id="footer_${c.key}" style="font-weight: bold; coo                d84315; background-color: #fff8e1; border-top: 2px solid #ffb300; border-bottom: 1px solid #ddd;">${sum > 0 ? sum : ""}</td>`;
            });
            footerHtml += `</tr>`;
            tfoot.innerHTML = footerHtml;

            applyColumnToggleDisplay(showFlags);
        }

        // ================= ÂãïÊÖãÂáçÁµêÊ¨Ñ‰ΩçÈÇèËºØ =================
        function updateStickyColumns() {
            requestAnimationFrame(() => {
                const table = document.getElementById('mainTable');
                if (!table) return;
                const monthTr = document.getElementById('monthTheadTr');
                cn            tfoo             =  table.querySelector('tfoot tr');
                const tbodyTrs = table.querySelectorAll('tbody tr');

                         (!monthTr) return;

                let currentLeft = 0;
                let lastVisibleIndex = -1;

                for (let i = 0; i < colOrder.length; i++) {
                    // üí° Â¢ûÂä†ÂÆâÂÖ®Ê™¢Êü•ÔºöÈÅøÂÖçÂõ†ÁÇ∫Ë°®Ê†ºÊõ¥Êñ∞‰∏≠Â∞éËá¥Êäì‰∏çÂà∞ÂÑ≤Â≠òÊ†ºËÄåÂ†±ÈåØ
                    if (!monthTr.cells[i]) continue;
                    if (window.getComputedStyle(monthTr.cells[i]).display !== 'none') lastVisibleIndex = i;
                }

                for (let i = 0; i < colOrder.length; i++) {
                    // üí° Â¢ûÂä†ÂÆâÂÖ®Ê™¢Êü• 
                    if (!monthTr.cells[i]) continue;
                    const isVisi ble = window.getComputedStyle(monthTr.cells[i]).display !== 'none'; 

                    // üí° Á≤æÊ∫ñËÆÄÂèñÂØ¨Â∫¶ÔºåÈÅøÂÖçÂá∫Áèæ 1px ÁöÑÊªæÂãïÈªëÁ∑öÊàñÊ®°Á≥ä
                    let exactWidth = isVisible ? monthTr.cells[i].getBoundingClientRect().width : 0;

                    const procs            ll = (cell, isHeader, isFooter) => {
                        if (!cell) return;
                        if (isVisible) {
                                     cell.style.position = 'sticky';
                            cell.style.left = cu            ntLeft + 'px';

                                       if (isHeader) cell.style.zIndex = '55';
                            else if (isFooter) cell.style.zIndex = '45';
                            es                ll.style.zIndex = '40';

                            if (!isHeader && !isFooter) cell.style.backgroundColor = 'inherit';

                            if (currentLeft === 0) cell.style.borderLeft = '1px solid #ddd';
                            else cell.style.borderLeft = 'none';

                            if (i === lastVisibleIndex) {
                                cell.style.borderRight = '2px solid #90caf9';
                                           (isF            er ) cell.style.boxShadow = '2px -2px 5px rgba(0,0,0,0.1)';
                                else cell.style.boxShadow = '2p        0 5px rgba(0,0,0,0.08)';
                            } else {
                                cell.style.borderRight = '1px solid #ddd';
                                if (isFooter) cell.style.boxShadow = '0 -2px 5px rgba(0,0,0,0.1)';
                                else cell.style.boxShadow = 'none';
                            }
                        } else {
                             cell.style.posit ion = ''; cell.style.left = ''; cell.style.zIndex = '';
                            cell.style.borderRight  = ''; cell.style.bor derLeft = ''; cell.style.boxShadow = '';
                        }
                    };

                    if (monthTr && monthTr.cells[i]) processCell(monthTr.cells[i], true, false);
                            if (tfootTr && tfootTr.cells[i]) processCell(tfootTr.cells[i], false, true);
                    tbodyTrs.forEach(tr => { if (tr.cells[i]) pr            ssCell(tr.cells[i], false, false); });

                    if (isVisible) cur            tLeft += exactWidth;
                                         });
        }
        window.addEventListener('resize', updateStickyColumns);

        // ================= DB ÁÆ°ÁêÜ =================
                    unction switchDbTab(tab) {
            document.querySelectorAll('.db-tab-btn').forEach(b => {
                b.classList.remove('active');
                if (b.innerText.includes('‰∫ãÈ†ÖÁ∂ÅÂÆö') && tab === 'task') b.style.backgroundColor = '#4CAF50';
                else if (b.innerText.includes('‰∫ãÈ†ÖÁ∂ÅÂÆö')) b.style.backgroundColor = '#e8f5e9';
                else if (b.innerText.includes('Â§ßÂ∞èË£ΩÁ®ã') && tab === 'process') b.style.backgroundColor = '#0            c';
                          else if (b.innerText.includes('Â§ßÂ∞èË£ΩÁ®ã')) b.style.backgroundColor = '#e0f2f1';
                else b.style.back        oundColor = '';
            });
            document.querySelectorAll('.db-tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById('tab_' + tab).classList.add('active');
            if (tab !== 'task' && tab !== 'process') event.target.classList.add('active'); else event.target.style.color = 'white';
        }

        functi on openDbModal() { u pdateFilterDropdowns(); applyRpFilter(); applyMilestoneFilter(); applyProcessFilter(); applyGroupFilter(); applyTaskFilter(); document.getElementById('dbModal').style.display = 'block'; }
        fu            ion updateFilterDropdowns() {
            const msRpSelect = document.getElementById('ms_rp'); const currentMsRp = msRpSelect.value;
                       RpSelect.innerHTML = `<option value="">-- ÈÅ∏ÊìáÂú∞ÂçÄ/Â∞àÊ°à --</option>` + db.rpLinks.m            l => `<option value="${l.region}$                roject}">${l.region} - ${l.project}</option>`).join('');
            msRpSelect.value = currentMsRp;
            const setDl = (id, arr) => documentg                ementById(id).innerHTML = [...new Set(arr)].map(x => `<option value="${x}">`).join('');
            setDl('dl_groups', db.groupLinks.map(l => l.group)); setDl('dl_names', db.groupLinks.map(l => l.name));
            setDl('dl_regions', db.rpLinks.map(l => l.region)); setDl('dl_projects', db.rpLinks.map(l => l.project));
            setDl('dl_macros', db.processLinks.map(l => l.macro)); setDl('dl_micros', db.processLinks.map(l => l.micro))
                               setDl('dl_tasks', db.taskLinks.map(l => l.task));
        }

        function applyRpFilter() {
            const f_reg         document.getElementById('rp_region').value.toLowerCase(); const f_proj = document.getElementById('rp_project').value.toLowerCase();
            const tbody = document.getElementById('db_rp_list'); tbody.innerHTML = '';
            db.rpLinks.forEach((l, i) => {
                if (f_reg && !l.region.toLowerCase().includes(f_reg)) return; if (f_proj && !l.project.toLowerCase().includes (f_proj)) return;
                 tbody.innerHTML += `<tr>
					<td>${l.region}</td>
					<td>${l.project}</td>
					<td style=" width: 130px; min-width:  130px; text-align: right; white-space: nowrap;">
						<button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;" onclick="startEditDb('rp', ${i})">Á∑®ËºØ</button>
						<button style="background:#ef4444; padding:4px 10px; font-size:12px;" onclick="delDb('rp', ${i})">Âà™Èô§</button>
					</td>
				</tr>`;
            });
            if (tbody.innerHTML === '') tbody.innerHTML = '<tr><td colspan="3" style="text-align:center; color:#888;">Êü•ÁÑ°Ë≥áÊñô</td></tr>';
        }
        function addDbRpLink() {
            const r = document.getElementById('rp_region').value.trim(); cont p = document.getElementById('rp_project').value.trim();
            if (r && p) { if (!db.rpLinks.find(x => x.region === r && x.project === p)) db.rpLinks.push({ region: r, project: p }); document.getElementById('rp_project').value = ''; saveAllStorage(); applyRpFilter(); updateFilterDropdowns(); } else { alert("Ë´ãËº∏ÂÖ•Âú∞ÂçÄËàáÂ∞àÊ°àÂêçÁ®±ÔºÅ"); }
        }

        function applyMilestoneFilter() {
            const f_rp = document.getElementById('ms_rp').value; const f_cat = document.getElementById('ms_categ ory').value;
            const tbody = document.getElementById('db_milestone_list'); tbody.innerHTML = '';
            let filteredMs = db.milestones.filter(l => { if (f_rp) { const [r, p] = f_rp.split('|'); if (l.region !== r || l.project !== p) return false; } if (f_cat && l.category !== f_cat) return false; return true; });
            filteredMs.sort((a, b) => new Date(a.start) - new Date(b.start));
            filteredMs.forEach(l => {
                const tagClass = l.category === 'NPI' ? 'tag-npi' : 'tag-mp'; const originalIndex = db.milestones.indexOf(l);
                tbody.innerHTML += `<tr>
					<td>${l.region}</td><td>${lproject}</td><td><span class="${tagClass}">${l.category}</span></td><td style="font-weight:bold;">${l.phase}</td><td>${l.start}</td><td>${l.end}</td>
					<td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
						<button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;" onclick="startEditDb('milestoe', ${originalIndex})">Á∑®ËºØ</button>
						<button style="background:#ef4444; padding:4px 10px; font-size:12px;" onclick="delDb('milestone', ${originalIndex})">Âà™Èô§</button>
					</td>
				</tr>`;
            });
            if (tbody.innerHTML === '') tbody.innerHTML = '<tr><td colspan="7" style="text-align:center; color:#888;">Êü•ÁÑ°Ë≥áÊñô</td></tr>';
        }
       function addDbMilestone() {
            const rpVal = document.getElementById('ms_rp').value; const cat = document.getElementById('ms_category').value;
            const ph = document.getElementById('ms_phase').value.trim(); const st = document.getElementById('ms_start').value; const ed = document.getElementById('ms_end').value;
            if (!rpal || !cat) { alert("Ë´ãÂÖàÈÅ∏Êìá„ÄêÂú∞ÂçÄ/Â∞àÊ°à„ÄëËàá„ÄêÈ°ûÂà•„Äë‰ΩúÁÇ∫Á∂ÅÂÆöÁõÆÊ®ôÔºÅ"); return; }
            if (ph && st && ed) { const [r, p] = rpVal.split('|'); if (new Date(st) > new Date(ed)) { alert("ÈñãÂßãÊôÇÈñì‰∏çËÉΩÊôöÊñºÁµêÊùüÊôÇÈñìÔºÅ"); return; } db.milestones.push({ region: r, project: p, category: cat, phase: ph, start: st, end: ed }); document.getElementById('ms_phase').value = ''; saveAllStorage(); applyMilestoneFilter(); } else { alert("Ë´ãÂ°´ÂØ´„ÄåÈöéÊÆµÂêçÁ®±„Äç‰∏¶ÊåáÂÆö„ÄåËµ∑Ë®ñÊó•Êúü„ÄçÔºÅ"); }
        }

        function applyProcessFilter() {
            const f_mac = document.getElementById('proc_macro').value.toLowerCase(); const f_mic = document.getElementById('proc_micro').value.toLowerCase();
            const tbody = document.getElementById('db_process_list'); tbody.innerHTML = '';
            db.processLinks.forEach((l, i) => {
                if (f_mac && !l.macro.toLowerCase().includes(f_mac)) return; if (f_mic && !f_mic.includes(',') && !l.micro.toLowerCase().includes(f_mic)) return;
                tbody.innerHTML += `<tr>
					<td>${l.macro}</td><td>${l.micro}</td >
					<td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
						<button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;" onclick="startEditDb('process', ${i})">Á∑®ËºØ</button>
						<button style="background:#ef4444; padding:4px 10px; font-size:12px;" onclick="delDb('process', ${i})">Âà™Èô§</button>
					</td>
				</tr>`;
            });
            if (tbody.innerHTML === '') tbody.innerHTML = '<tr><td colspan="3" style="text-align:center; color:#888;">Êü•ÁÑ°Ë≥áÊñô</td></tr>';
        }
        function addDbProcessLink() {
            const mac = document.getElementById('proc_macro').value.trim(); const mic_raw = document.getElementById('proc_micro').value.trim();
            if (mac) { if (mic_raw) { mic_raw.split(',').map(i => i.trim()).filter(i => i !== "").forEach(mic => { if (!db.processLinks.find(x => x.macro === mac && x.micro === mic)) db.processLinks.push({ macro: mac, micro: mic }); }); } else { if (!db.processLinks.find(x => x. macro === mac && x.micro === "")) db.processLinks.push({ macro: mac, micro: "" }); } document.getElementById('proc_micro').value = ''; saveAllStorage(); applyProcessFilter(); updateFilterDropdowns(); } else { alert("Ëá≥Â∞ëÈúÄËº∏ÂÖ•Â§ßË£ΩÁ®ãÔºÅ"); }
        }

        function applyGroupFilter() {
            const f_grp = document.getElementById('grp_group').value.toLowerCase() ;  const f_name = doc um ent.getElementById('grp_name').value.toLowerCase();
            const tbody = document.getElementById('db_group_list'); tbody.innerHTML = '';
            db.groupLinks.forEach((l, i) => {
                if (f_grp && !l.group.toLowerCase().includes(f_grp)) return; if (f_name && !f_name.includes(',') && !l.name.toLowerCase().includes(f_name)) return;
                tbody.innerHTML += `<tr>
					<td>${l.group}</td><td>${l.name}</td>
					<td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
						<button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;" onclick="startEditDb('group', ${i})">Á∑® ËºØ</button>
						<button style="background:#ef4444; padding:4px 10px; font-size:12px;" onclick="delDb('group', ${i})">Âà™Èô§</button>
					</td>
				</tr>`;
            });
            if (tbody.innerHTML === '') tbody.innerHTML = '<tr><td colspan="3" style="text-align:center; color:#888;">Êü•ÁÑ°Ë≥áÊñô</td></tr>';
        }
        function addDbGroupLink() {
            const g = document.getElementById('grp_group').value.trim(); const n_raw = document.getElementById('grp_name').value.trim();
            if (g && n_raw) { n_raw.split(',').map(i => i.trim()).filter(i => i !== "").forEach(name => { if (!db.groupLinks.find(x => x.group === g && x.name === name)) db.groupLinks.push({ group: g, name: name }); }); document.getElementById('grp_name').value  = ''; saveAllStorage(); applyGroupFilter(); updateFilterDropdowns(); } else { alert("Ë´ãËº∏ÂÖ•ÁµÑÂà•ËàáÂßìÂêçÔºÅ"); }
        }

        function applyTaskFilter() {
            const f_main = document.getElementById('task_main').value.toLowerCase(); const f_sub = document.getElementById('task_sub').value.toLowerCase();
            const tbody = document.getElementById('db_task_li st '); tbody.innerHTM L  = '';
            db.taskLinks.forEach((l, i) => {
                if (f_main && !l.task.toLowerCase().includes(f_main)) return; if (f_sub && !f_sub.includes(',') && !l.subTask.toLowerCase().includes(f_sub)) return;
                tbody.innerHTML += `<tr>
					<td>${l.task}</td><td>${l.subTask}</td>
					<td style="width: 130px; min-width: 130px; text-align: right; white-space: nowrap;">
						<button style="background:#3b82f6; padding:4px 10px; font-size:12px; margin-right:4px;" onclick="startEditDb('task', ${i})">Á∑®ËºØ</button>
						<button style="background:#ef4444; padding:4px 10px; font-size:12px;" onclick="delDb('task', ${i})">Âà™Èô§</button>
					</td>
				</tr>`;
            });
            if (tbody.innerHTML === '') tbody.innerHTML = '<tr><td colspan="3" style="text-align:center; color:#888;">Êü•ÁÑ°Ë≥áÊñô</td></tr>';
        }
        function addDbTaskLink() {
            const mainT = document.getElementById('task_main').value.trim(); const subT_raw = document.getElementById('task_sub').value.trim();
          inT) { if (subT_raw) { subT_raw.split(',').map(i => i.trim()).filter(i => i !== ""            orEach(sub => { if (!db.taskLinks.find(            > x.task === mainT && x.subTask ===            b)) db.taskLinks.push({ task:            inT, subTask: sub }); }); } else { if (!db.taskLinks.find(x =>             ask === mainT && x.subTas            == "")) db.taskLinks.push            task: mainT, subTask:                 ); } document.getElementById('t                sub').value = ''; saveAllStorage(); applyT                ilter(); updateFilterDropdowns()                else { alert("Ëá≥Â∞ëÈúÄËº∏ÂÖ•‰∏ª‰∫ãÈ†ÖÔºÅ"); }
                  
        function delDb(ty                originalIndex) {
            if (type === 'rp') db.rpLinks                ice(originalIndex, 1); else if (type === 'milestone') db.milestones.splice(originalIndex, 1);
                        else if (type === 'process') db.processLinks.splice(originalx                ; else if (type === 'grou                db.groupLinks.splic                iginalIndex, 1);
             el se  if                 e === 'task') db.taskLinks.s pli ce( origind                1);
            saveAllStorage();
            if (type === 'rp') { applyRpFilter(); updateFilterDropdowns(); }                e if (type === 'milestone') applyMilestoneFi                ();
            e                if (type === 'process') { applyProcessFilter(); up                FilterDropdowns(); } else if                pe === 'group') { applyGroupFilter             ut            lterDropdowns(); }
                      lse { applyTaskFilter(); updateFilterDropdowns(); }
        }

          fu            ion closeModal(id) { document.getElementById(id).style.display = 'none            }
         window.onclick = function (e) { if (e.target.c                Name === 'modal') e.tar            .style.di                y = 'none'; }

        let c            en        ditDb = { type: null, index: -1 };
        function startEditDb(type, index) {
            currentEditDb = { type: type, index: index }; let body = document.getElementById('editDbBody'); let html = '';
            if (type === 'rp') { html = `<label style="display:block;margin-bottom:10px;">Âú∞ÂçÄÔºö<input type="text" id="edit_reg" value="${db.rpLinks[index].region}" class="workload-input-modal"></label><label style="display:block;">Â∞àÊ°àÔºö<input type="text" id="edit_proj" value="${db.rpLinks[index].project}" class="workload-input-modal"></label>`; }
            else if (type === 'process') { html = `<label style="display:block;margin-bottom:10px;">Â§ßË£ΩÁ®ãÔºö<input type="text" id="edit_mac" value="${db.processLinks[index].macro}" class="workload-input-modal"></label><label style="display:block;">Â∞èË£ΩÁ®ãÔºö<input type="text" id="edit_mic" value="${db.processLinks[index].micro}" class="workload-input-modal"></label>`; }
            else if (type === 'group') { html = `<label style="display:block;margin-bottom:10px;">ÁµÑÂà•Ôºö<input type="text" id="edit_grp" value="${db.groupLinks[index].group}" class="workload-input-modal"></label><label style="display:block;">ÂßìÂêçÔºö<input type="text" id="edit_name" value="${db.groupLinks[index].name}" class="workload-input-modal"></label>`; }
            else if (type === 'task') { html = `<label style="display:block;margin-bottom:10px;">‰∏ª‰∫ãÈ†ÖÔºö<input type="text" id="edit_main" value="${db.taskLinks[index].task}" class="workload-input -modal"></label><label style="display:block;">Â∞è‰∫ãÈ†ÖÔºö<input type="text" id="edit_sub" value="${db.taskLinks[index].subTask}" class="workloa d- in put-modal"></label>`; }
            else if (type === 'm ile sto ne') { html = `<label style="display:block;margin-bottom:10px;">ÈöéÊÆµÂêçÁ®±Ôºö<input type="text" id="edit_ph" value="${db.milestones[index].phase}" class="workload-input-modal"></label><label style="display:block;margin-bottom:10px;">ÈñãÂßãÊôÇÈñìÔºö<input type="date" id="edit_st" value="${db.milestones[index].start}" class="workload-input-modal"></label><label style = "display:block;">ÁµêÊùüÊôÇÈñìÔºö<input type="date" id="edit_ed" value="${db.milestones[index].end}"             ss="workload-input-modal"></label>`; }
            body.innerHTML = html            ocument.getElementById('editDbModal').style.display = 'block';
        }
        function saveDbEdit() {
            const { type, index            = currentEditDb;
            if (type === 'rp') {
                const oldReg = db.rpLinks[index].regi             const oldProj = db.rpLinks[index].project;
                const newRe             document.getElementById('ed            reg').value.trim(); const             Proj = document.getElementById('edit_proj').value.trim();
                         if (!newReg || !newProj) return;
                if (newReg !== oldReg) { mainTableData.forEach(r => { if (r.region === oldReg) r.r            on = newReg; }); db.rpLinks.forEah            => { if (r.region === oldReg) r.region = newReg; }); db.milestone            orEach(m => { if (m.regi            === oldReg) m.region              Reg; }); }
                            (newProj !== oldProj) { mainTa                ata.forEach(r => { if (r.re gi on === newReg &&  r. project === oldPro j)  r.project = ne wP roj; }); db.rpL in ks.forEach(r = >  { if (r.region == =  newRegr                ject === oldProj) r.project = ne                    ; }); db.milestones.forEach(m => { if (m.region === newReg && m.project === ol                j)                 oject = newProj; }); }
                               applyRpFilter();
            } el                     (type === 'pro                         {
                const oldMac = db.processLinks[                            macro; const oldMic = db.processLinks[index].micro;
                const newMac = document.getElementById('edit_m                        al                        m(); const newMic = document.getElementById('edit_mi                        lue.trim();
                                 newMac) return;
                if (                            !== oldMac) { mainTableDa                            ach(r => { if (r.macro === oldMac) r.mac r o = newMac; });d                            ssLinks.forEach(p => { if p                         === oldM                            acro = newMac; }); }
                                           wMic !== oldMic) { mainTableData.forEach(row =>   { if (row.macro === newMac) { let mics = row.micro ? row.micro.split(',').map(s =>                             )).filter(s => s) : []; if (oldMic) { let  i  = mics.                        f(                    c)                 (i             1) {             (newMic) mics[i] = newMic; else mics.s                e(i, 1); row.micro = mics.join(', ')                } else if (!oldMic && ne)                f (!mics.includes(newMic)) mics.push(newMic); row.micro = mics.join(', '); } } }); db                cessLinks[index].micro = newMic; }
                applyProci                ();
            } else if (type === 'group') {
                const oldGrp = db.groupLinks[index].group; cons                    Name = db.groupLinks[index].name;
                const newGrp                     ument.getElementById('edit_grp')                        .trim(); const newName = document.getElementById('edit_name').value.trim();
                if (!newGrp ||                     am                    turn;
                if (newGrp !== oldGrp                    ainTableData.forEach(r => { if (r.group === ol                     r.group = newGrp; }); db.groupLinks.forEach(g => { if (g.grou                =             Grp            .group = newGrp; });                            if (newName !                ld Name) { mainTableData.forEach(r => { if (r.grou                = newGrp && r.name === oldName) r.name = newName; });             group            ks[index].name = newName; }
                            applyGroupFilter();
                           lse if (type === 'task') {
                               const oldTask = db.taskLinks[index].task; const oldSub = db.taskLinks                    x] .subTask;
                const newTask = document.getE                    tB yId('edit_main').value.trim(); const newSub = document.getElementById('edit_sub').value.trim();
                          if (!newTask) return;
                if (newTask !== oldTask) { mainTableDat                    Each(r => { if (r.task === oldTask) r.task = ne                    ; }); db.taskLinks.forEach(t => { if (t.task === oldTask) t.task = newTask; }); }
                                                 (newSub !== oldSub) { mainTableData.forEach(row => { if (row.task === new            k) { let subs = row.subTask ? row.subTask.spli        ','        map(s => s.trim()).filter(        => s) : []; if (oldSub) { let i = subs.indexOf(oldSub); if (i > -1) { if (ne            b) subs[i] = newSub; else subs.splice(i, 1); row.subTask =            bs.join(', '); } } else if (!oldSub && newSub) { if (!subs.incl            s(newSub)) subs.push(newSub            row.subTask = subs.join(', '); } } }); db.taskLinks[index].subTask = newSub; }
                      applyTaskFilter();
            } else i                ype === 'milestone') {                             db.milestones[index] = { ...db.milestones[index],                 e: docum            .ge            ementById('edit_ph').value.trim(), start: docume            getElementById('edit_st').value, end: document.getElementB            ('edit_ed').value }; applyMilestoneFilter();
            }
            saveAllSt            ge(); renderMainTable(); updateFilterDropdowns(); closeModal('editDbModal');
        }


        // ===            ==========================                ==========================================
        // =====                ======== üåü Ë≥áÊ∫êÂàÜÈÖçÁü©Èô£ (Allocation Matrix) Á≥ªÁµ± =================
        // ==============================================================================

        let allocTimelineCols =            ;

                 function initAllocWeekNavigator() {
            let start = new Date(timelineS            tMs);
            let end = new Date(timeli            ndMs);
            let curr = new Date(start);

                       nst selector = document.getElementById('allocWeekSe            tor');
            selector.inner                 = '';
            allocTimeline                 = [];

            while (curr <= end) {
                let thursday = new Date(curr);
                thursday.setDate(thursday.                ate() + 3);
                 let y = thursday.getFullYear();
                            let w = get                eek(thursday);

                               let mon = new Date(curr);
                let sun = new Date(curr); sun.setDate(sun.getDate() + 6);
                               let dateStrLong =                        n.getMonth() + 1}/${mon.getDate()} ~ ${sun .g et Mont                        1}/${sun.getDate()}`;
                l et  dat eStrSh`                        getMonth() + 1}/${mon.getDate()}`;

                le                             `y${y}_w${w}`;
                // üí° ÂØ´ÂÖ•Áï∂ÈÄ±ÁúüÊ≠£ÁöÑËµ∑Ë®ñÊØ´ÁßíÊï∏
                                     let startMs = mon.setHours(0, 0, 0,                                   let endMs = sun.setHours(23, 59, 59, 999);

                alloc                            eCols.push({ key: key, label: `W${w}`, dateStr: dateStrShort, startr                            dMs: endMs });

                let opt = document.createEle                            ption');
                opt.value = key;
                opt.                            tent = `${y}Âπ¥ W${w} (${dateStrLong})`;
                selector.h                            );

                curr.setDate(curr.getDate() + 7);
            }

            let todayThurs = new Date();
            todayThurs.setDate(todayThurs.getDate() + 3 - (todayThurs.getDay() || 7));
            let tKey = `y${todayThurs.getFullYear()}_w${getISOWeek(todayThurs)}`;
            if (selector.querySelector(`option[value="${tKey}"]`)) {
                selector.value = tKey;
            } else {
                selector.selectedIndex = 0;
            }
        }

                                              ion                     llocModal() {
                          itc                Navigator();
            updateAllocView();
            document.getElementById('allocModal').style.display = 'block';
        }

        function changeAllocWeek(offset) {
            const selector = document.getElementById('allocWeekSelector');
            let newIndex = selector.selectedIndex + offset;
            if (newIndex >= 0 && newIndex < selector.options.length) {
                selector.selectedIndex = newIndex;
                updateAllocView();
            }
        }

        function formatDate(dateStr) {
            if (e                 return "" ; 
              let d = new Date(da                    );
            return `$                    tMonth() + 1}/${d.getDate()}`;
        }

        fuc                    getSmartPhase(region, project, category, currentWeekKey)                              let msList = db.milestones.filter(m => m.region === n                    .project === pro                    && m.category === category);
            if (msList.length === 0) return { name: "Â∏∏Ë¶è‰ªªÂãô", type: "am-phase-normal" };

            let match = currentWeekKey.match(/y(\d+)_w(\d+)/);
            if (!match) return { name: "Â∏∏Ë¶è‰ªªÂãô", type: "am-phase-normal" };
            let y = parseInt(match[1]), w = parseInt(match[2]);
            let d = new Date(Date.UTC(y, 0, 1));
            d.setUTCDate(d.getUTCDate() + 4 - (d.getUTCDay() || 7));
            let targetDate = new Date(d.getTime() + (w - 1) * 604800000).getTime();

            msList.sort((a, b) => new Date(a.start) - new D                    .start));

            for                        m of msList) {
                let s = new Date(m.start).se                        (0, 0, 0, 0);
                let e = new Date(m.end).setHours(23, 59, 59, 999);
                if (targetDate >= s && targetDate <= e) return { name: m.phase, type:h                        tive" };
            }

                              for (let m of msLi                                        if (targetDat                             Date(m.start).getTime()) retur                                : `${m.phase} (È†êÂÇô)`, type: "am-phase-prep" };
                                    }
            return { name: `${msList[msList.length - 1].phase} (Êî∂Â∞æ)`, type: "am-phase-post" };
        }

        function updateAllocView() {
            const currentWeek = document.getElementById('allocWeekSelector').value;
            const weekText = document.getElementById('allocWeekSelector').options[document.getElementById('allocWeekSelector').selectedIndex].text;
            document.getElementById('allocRightPanelTitle').innerText = `üë• ÂúòÈöäË≤†Ëç∑Ê∞¥‰ΩçË°® - ${weekText.split(' ')[1]}`;

            let currIdx = allocTimelineCols.findIndex(c => c.key === currentW                                          let startIdx = currIdx - 3;
            let endIdx = currId                                                             if (startIdx < 0) { endIdx                                 abs(startIdx); startIdx = 0;                                          if (endIdx >= allocTimelineCols.length) { startIdx -= (a                                    ineCols.length + 1); endIdx = all                                    eCols.length - 1; }
            startIdx = Math.max(0, startIdx);
            let windowCols = allocTimelineCols.slice(startIdx, endIdx + 1);

            let projectGroups = {};
            let pendingCount = 0;
            let globalTaskDict = {};

            mainTableData.forEach(row => {
                let taskKey = `${row.region || ""}|${row.project || ""}|${row.category || ""}|${row.macro || ""}|${row.micro || ""}|${row.task || ""}|${row.subTask || ""}`;

                if (!globalTaskDict[taskKey]) {
                    globalTaskDict[taskKey] = { taskKey: taskKey, baseRow: row, weeklyData: {} };
                }

                allocTimelineCols.forEach(c => {
                    let val = parseFloat(row[c.key]);
                    if (val > 0) {
                        if (!globalTaskDict[t                                weeklyDat                                     {
                            globalTaskDict[taskKey].weeklyData[c.key] = { totalReq: 0, unassignedVal: 0, unassignedId: null, assignees: [] };
                        }
                                                       =                            TaskDict[                                .weeklyData[c.key];
                        wd.totalReq += val;

                        if (!row.name                            .n                        = "") {
                                                 wd.unassignedVal += val;
                            wd.unassignedId = row._id                         te                         + Math.random());
                            row._id = wd.unassignedId;
                                                      } else {                                                           // üí° ËÆÄÂèñ‰∏¶Ë®òÈåÑ r            personalTask (ÂêÑ‰∫∫‰∫ãÈ†Ö)
                                  wd.assignees.push({ _id: row._id || (Date.now(             Math.random()), name: row.name, val: val, personalTask: row.p            onalTask || "" }                                        row._id = wd.assignees[            assignees.length - 1]._id;
                                    }
                    }
                });
            });

            for (let taskKey in globalTaskDict                            let task = globalTaskDict[taskKey];
                let row = task.baseRow;

                task.smartPhase = getSmartPhase(row.region, row.project, row.category, currentWeek);
                let hasAnyWeight = Object.keys(task.weeklyData).length > 0;

                if (hasAnyWeight || task.smartPhase.type === "am-phase-active" || task.smartPhase.type === "am-phase-prep") {
                    let groupKey = `${row.region}|${row.project}|${row.category}`;
                    if (!projectGroups[groupKey]) {
                        projectGroups[groupKey] = { region: row.region, project: row.project, category: row.category, tasks: [] };
                    }
                    projectGroups[groupKey].tasks.push(task);

                    let wdCurrent = task.weeklyData[currentWeek];
                    if (wdCurrent && wdCurrent.unassignedVal > 0) pendingCount++;
                }
            }

            let workloads = {};
            db.groupLinks.forEach(g => {
                if (!worklog                up]) workloads[g.group] = {};
                workloads[g.group][g                e] = { total: 0, tasks: [] };
                           });

            mainTableData.                    ch(row => {
            e                     = parseFloat(row[currentWeek]);
                if (row.name && val > 0) {
                    let personG                    = db.groupLinks.fin                         g.name === row.name)?.group || "Êú™ÂàÜÈ°û";
                    if (!workloads[personGroup]) wor                    s[personGroup] = {};
                                      if (!workloads[personGroup][row.name]) workloads[personGroup][row.name] = { total:                    asks: [] };

                                      let phaseObj = getSmartPhase(row.region, row.project, row.category, currentWeek);
                                                   orkloads[personGroup][row.name].total += val                                     workloads[personGro up][row.name].tasks.push({ ...ro                        , smartPhase: phaseObj });
                }
            });

            renderAllocEvents(projectGroups, pendingCount, currentWeek, wil                                  renderAllocPer                        (workloads, currentWeek);
        }

        // üí° Êé•Êî∂‰∏äÊñπË®àÁÆóÂ•ΩÁöÑ windowCols
        function renderAllocEvents(projectGroo                        urrentWeek, windowCols) {
            const listEl = document.getElementById('allocEventList');
            let countEl = document.getElementById('allocUnassignedCount');
            countEl.innerText = count;
            countEl.style.backgroundColor = count > 0 ? "var(--danger)" : "var(--success)";

            if (Object.keys(projectGroups).length === 0) {
                // üí° ÁßªÈô§„ÄåÂºïÂÖ•È†êÂÇôÈúÄÊ±Ç„ÄçÁöÑÊèêÁ§∫ÊñáÂ≠ó
                listEl.innerHTML = `<div class="empty-state">Êú¨ÈÄ±Â∞öÁÑ°‰ªªÂãôË¶èÂäÉÔºÅ</div>`;
                return;
            }

            let allPeople = db.groupLinks.map(g => g.name);
            let selectOptions = `<option value="">-- ÊåáÊ¥æ --</option>`;
            allPeople.forEach(p => selectOptions += `<option value="${p}">${p}</option>`);

            let thHtml = `<th class="am-task-info-td" style="text-align:left; padding-left:16px;">Â∞àÊ°à / ‰ªªÂãôË≥áË®ä</th>`;
            windowCols.forEach(c => {
                let isCurrent = c.key === currentWeek ? "is-current" : "";
                thHtml += `<th class="${isCurrent}" style="min-width: 120px; width: 120px;">${c.label}<br><span style="font-size:10px; font-weight:normal; color:#64748b;">${c.dateStr}</span></th>`;
            });

            let html = `<table class="am-matrix"><thead><tr>${thHtml}</tr></thead><tbody>`;

            let windowStartMs = windowCols[0].startMs;
            let windowEndMs = windowCols[windowCols.length - 1].endMs;
            let windowDuration = windowEndMs - windowStartMs;

            for (let key in projectGroups) {
                let group = projectGroups[key];
                let msList = db.mileston                    lter(m => m.re                    === group.region && m.project === group.project && m.category === group.category);
                msList.sort((a, b) => new Date(a.start) - new Date(b.start))                                  let phasesHtml = "";
                if (msList.length > 0) {
                    phasesHtml = `<div style="position:relative; width:100%; height:24px; display:flex; align-items:center;">`;
                    msList.forEach(m => {
                        let mStart = new Date(m.start).setHours(0, 0, 0, 0);
                        let mEnd = new Date(m.end).setHours(23, 59, 59, 999);

                        if (mEnd >= windowStartMs && mStart <= windowEndMs) {
                            let renderStart = Math.max(mStart, windowStartMs);
                            let renderEnd = Math.min(mEnd, windowEndMs);

                            let leftPct = ((renderStart - windowStartMs) / windowDuration) * 100;
                            let widthPct = ((renderEnd - renderStart) / windowDuration) * 100;

                            let bgColor = m.category === 'NPI' ? '#e1f5fe' : '#e8f5e9';
                            let textColor = m.category === 'NPI' ? '#0288d1' : '#2e7d32';
                            let borderColor = m.category === 'NPI' ? '#81d4fa' : '#a5d6a7';

                            phasesHtml += `<div class="gantt-bar" style="position:absolute                fte                t}%; width:${width            }%a            round:${bgColor}; b                r:1px solid ${borderColor}; z-index:5; box-sizing:border-box; overflow:hidden;" title="[${m.category}] ${m.phase            ${t            }~${m.end})">
								<sp         style="color:${textColor}">${formatDate(m.start) }</span>
								<b style="color:${textColor}">${m.phase}</b>
								<span style="color:${textColor}">${formatDate(m.end)}</span>
							</div>`;
                        }
                    });
                    phasesHtml += `</div>`;
                }

                html += `
				<tr class="am-group-row">
					<td class="am-task-info-td">
						<div style="display:flex; justify-content:space-between; align-items:center;">
							<span style="font-size:14px; font-weight:bold; color:#1e293b;">üåç ${group.region} - üì¶ ${group.project} <span style="color:#64748b; fon t-weight:normal;">(${group.category})</span></span>
						</div>
					</td>
					<td colspan="${windowCols.length}" style="padding: 0; vertical-align: middle; position: relative; border-right: none;">
						${phasesHtml}
					</td>
				</tr>`;

                for (let i = 0; i < group.tasks.length; i++) {
                    let t = group.tasks[i];
                    let safeTaskKey = t.taskKey.replace(/"/g, '&quot;');
                    let phaseClass = `am-badge-phase ${t.smartPhase.type}`;
                    let wdCurrent = t.weeklyData[curre ntWeek] || { totalReq: 0 };

                     html += `<tr>`;
                    html += `
					<td class="am-task-info-td">
						<div class="am-task-name"><span c l ass="${phaseClass}">${t.smartPhase.name}</span><span>${t.baseRow.task}</span></div>
						<div class="am-task-path">${t.baseRow.macro} ‚ûî ${t.baseRow.micro}${t.baseRow.subTask ? `(${t.baseRow.subTask})` : ''}</div>
						<div style="font-size:11px; color:#647top:4px;">
							Áï∂ÈÄ±ÈúÄÊ±Ç: <input type="number" value="${wdCurrent.totalReq.toFixed(1)}" step="0.1" data-task="${safeTaskKey}" onchange="changeAllocTotalReq(this)" class="am-input-req" title="ÈªûÊìä‰øÆÊîπ"> ‰∫∫
						</div>
					< /td>`;

                    windowCols.forEach(c => {
                        let isCurrent = c.key === currentWeek ? "is-current" : "";
                        let currentStyle = c.key === currentWeek ? "border-left: 2px solid #60a5fa; border-right: 2px solid #60a5fa; box-shadow: inset 0 0 10px rgba(191,219,254,0.3);" : "";

                        let wd = t.weeklyData[c.key];
                        let tdHtml = "";

                        if (wd && wd.totalReq  >  0) {
                              if (wd.assignees.length > 0 )  {
                                  // üí° È°ØÁ§∫ÂêÑ‰∫∫‰∫ãÈ†ÖÔºöÂ¶ÇÊûúË©≤ÊåáÊ¥æÊúâÂ°´ÂØ´  p ersonalTaskÔºåÂ∞±Âú®ÂêçÂ≠ó‰∏ãÊñπÂä†‰∏äÁ∂†Ëâ≤Â∞èÂ≠ó 
                                   let parts = wd.assignees.map(a => `
									<div class="am-pill" style="display:block;">
										<div style="display:flex; justify-content:space-between; align-items:center;">
											<span>${a.name} <b style="opacity:0.7; font-weight:normal;">${a.val.toFixed(1)}</b></span>
											<button class="am-btn-rm" onclick="unassignAllocTask(${a._id}, '${c.key}')" title="ÊãîÈô§">‚úñ</button>
										</div>
										${a.personalTask ? `<div style="font-size:10px; color:#065f46; opacity:0.8; margin-top:2px;">‚Ü≥ ${a.personalTask}</div>` : ''}
									</div>
								`);
                                tdHtml += `<div style="margin-bottom:6px;">${parts.join('')}</div>`;
                            }

                            if (c.key === currentWeek) {
                                if (wd.unassignedVal > 0) {
                                    let defaultVal = Math.min(1.0, wd.unassignedVal).toFixed(1);

                                    //   üí° Â¢ûÂä†„ÄåÂêÑ‰∫∫‰∫ãÈ†Ö„ÄçËº∏ÂÖ•Ê°Ü (am_ptask_...)
                                    tdHtml += `
									<div class="am-assign-controls">
										<div style="font-size:11px; font-weight:bold; color:var(--danger); margin-bottom:4px; text-align:center;">Â∞öÁº∫ ${wd.unassignedVal.toFixed(1)}</div>
										<select id="am_sel_${wd.unassignedId}" class="am-assign-sel">${selectOptions}</select>
										<input type="text" id="am_ptask_${wd.unassignedI d}" class="am-ass            -sel" placeholder="ÂêÑ‰∫∫‰∫ãÈ†Ö (ÈÅ∏Â°´)" style="margin-bottom:4px; background:#f8fa             text-align:left;">
										<div style="display:flex; gap:4px;">
									            input type="number" id="am_val_${wd.unassignedId}" class="am-assign-val" value="${defaua             min="0.1" max="            d.unassignedVal}" step="0.1">
											<button class="am-btn-assign" onclick=as            nA llocTask(${wd.unassignedId})">ÊåáÊ¥æ</butto            		 								</div>
									</div>`;
                                }             e {
                                    tdHtml += `<div style="text-a            n:center; font-size:11px; color:var(--successf            -weight:bold; background:#d1fae5; border-r            us:4px; padding:4px 0; border: 1px solid #a7f3d0;">‚úÖ ÊªøÁ∑®            iv>`;
                                }
                                     } else {
                                  if (w.            ssignedVal > 0) tdHtml +=             iv class="am-missing">Áº∫ ${wd.unassignedVal.toFixed(1)}</div>`;
                                  }
                                 } else {
                                 tdHtml = `<div style="text-align:center; cl            #cbd5e1; font-size:11px; margin-top:8px;">-<            v>`;
                                                           html += `<td class="${isCurrent}" style="${currentStyle}">${tdHtml}</            `;
                    });
                         html += `</tr>`;
                }
            }
                  html += `</tbody></table>`;
             listEl.innerHTML = html;
        }

        function renderAllocPersonnel(workloads, currentWeek) { const listEl = document.getElementById('allocPersonnelList');
            let html = "";

            let sortedGroups = Object.keys(workloads).sort();

            for (let group of sortedGroups) {
                let sortedPeople rkloads[group]).sort((a, b) => workloads[group][b].total - worklods[group][a].total);

                html += `
				<div class="am-group-hdr" onclick="let c = this.nextElementSibling; let i = this.querySelector('.am-grp-icon'); if(c.style.display==='none'){c.style.display='block'; i.innerText='‚ñº';}else{c.style.display='none'; i.innerText='‚ñ∂';}" onmouseover="this.style.backgroundColor='#f1f5f9'" onmouseout="this.style.backgroundColor='transparent'" style="cursor:pointer; font-size:13px; color:#475569; border-bottom:2px solid #cbd5e1; padding:6px 4px; margin:15px 0 5px 0; display:flex; align-items:center; justify-content:space-between; transition:0.2s; border-radius:4px 4px 0 0;">
					<div style="display:flex; align-items:center; gap:8px;">
						<span styl e ="background:#e2e8f0; padding:2px 6px; border-radius:4px; font-weight:bold; color:#1e293b;">üè¢ ${group}</span>
						<span style="font-size:11px; color:#64748b; font-weight:normal;">(ÂÖ± ${sortedPeople.length} ‰∫∫)</span>
					</div>
					<span class="am-grp-icon" style="fontr:#94a3b8; font-weight:bold; padding-right:4px;>‚ñº</span>
				</div>`;

                html += `<div class="am-group-content" style="display:blo        ;">`;

                for (let name of sortedPeople) {
                    let data = workloads[g roup][name];
                    let total = data.total;

                    let barColor = "#10b981"; let textColor = "#047857"; let bgColor = "#f0fdf4"; let borderC7d0";
                    if (total === 0) {
                        barColor = "#cbd5e1"; textColor = "#94a3b8"; bgColor = "#f8fafc"; borderColor = "#e2e8f0";
                    } else if (total < 0.8) {
                        barColor = "#f59e0b"; textColor = "#b45309"; bgColor = "#fffbeb"; borderColor = "#fde68a";
                    } else if (total > 1.0) {
                        barColor = "#ef4444"; textColor = "#b91c1c"; bgColor = "#fef2f2"; erC"#fecaca";
                    }

                    let widthPct = Math.min(total * 100, 100);

                    let badgesHtml = data.tasks.sort((a, b) => b.val - a.val).map(t => {
                        let phaseColor = t.smartPhase.type === 'am-phase-active' ? '#3b82f6' : (t.smartPhase.type === 'am-phase-prep' ? '#eab308' : '#94a3b8');

                        // üí° Â¶ÇÊûúÊúâÂêÑ‰∫∫‰∫ãÈ†ÖÔºåÂ∞±Âú®Âç°Áâá‰∏≠‰∏≤Êé•È°ØÁ§∫
                        let pTaskHtml = t.personalTask ? `<span style="color:#0f172a; font-weight:bold;"> ‚ûî ${t.personalTask}</span>` : '';

                        return `
						<div class="am-task-tag" title="[${t.smartPhase.name}] ${t.project} - ${t.task}${t.personalTask ? ` ‚ûî ${t.personalTask}` : ''}" style="display:flex; align-items:center; background:#fff; border:1px solid #e2e8f0; padding:6px 8px 6px 12px; border-radius:6px; position:relative; overflow:hidden; box-shadow:0 1px 2px rgba(0,0,0,0.02); flex: 1 1 calc(50% - 6px); min-width:140px; cursor:default;">
							<div style="position:absolute; left:0; top:0; bottom:0; width:4px; background-color:${phaseColor};"></div>
							<div style="display:flex; flex-direction:column; gap:4px; width:100%;">
								<div style="display:flex; justify-content:space-between; align-items:flex-start; gap:4px;">
									<span style="font-weight:700; font-size:12px; color:#1e293b; line-height:1.2; text-overflow:ellipsis; overflow:hidden; white-space:nowrap;">üì¶ ${t.project}</span>
									<span style="font-weight:900; color:#0f172a; font-size:13px; background:#f1f5f9; padding:0 4px; border-radius:4px; border:1px solid #e2e8f0;">${t.val.toFixed(1)}</span>
								</div>
								<div style="font-size:10px; color:#64748b; display:flex; justify-content:space-between; align-items:center;">
									<span style="white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:85%;"><span>${t.task}</span>${pTaskHtml} <span style="opacity:0.6; margin-left:4px;">(${t.smartPhase.name})</span></span>
									<button class="am-tag-rm" onclick="unassignAllocTask(${t._id}, '${currentWeek}')" title="ÊãîÈô§‰ªªÂãô" style="cursor:pointer; padding:0 2px;">‚úñ</button>
								</div>
							</div>
						</div>`;
                    }).join('');

                    if (!badgesHtml) badgesHtml = `<div style="font-size:11px; color:#94a3b8; font-style:italic; padding:6px; width:100%; text-align:center;">üèñÔ∏è Êú¨ÈÄ±ÁÑ°ÊåáÊ¥æ‰ªªÂãô</div>`;

                    html += `
					<div class="am-person" style="border: 1px solid ${borderColor}; background-color: ${bgColor}; margin-bottom: 8px; border-radius:8px; padding:12px; transition:0.2s;">
						<div class="am-person-row" style="margin-bottom: 12px; display:flex; align-items:center; gap:12px;">
							<div class="am-person-name" style="width: 70px; text-align: right; font-weight:bold; color:#334155; font-size:14px;">${name}</div>
							<div class="am-track" style="flex:1; height:8px; background:#e2e8f0; border-radius:4px; position:relative;">
								<div class="am-fill" style="height:100%; border-radius:4px; transition:width 0.4s, background-color 0.4s; width: ${widthPct}%; background-color: ${barColor};"></div>
								<div style="position:absolute; left:100%; top:-3px; bottom:-3px; width:2px; background:#475569; z-index:2; opacity:0.6;" title="ÊªøÁ∑® 1.0 Âü∫Ê∫ñÁ∑ö"></div>
							</div>
							<div class="am-val" style="color: ${textColor}; width: 35px; text-align:right; font-weight:800; font-size:13px;">${total.toFixed(1)}</div>
						</div>
						<div class="am-tasks" style="padding-left: 0; display: flex; flex-wrap: wrap; gap: 6px;">
							${badgesHtml}
						</div>
					</div>`;
                }

                html += `</div>`;
            }

            if (html === "") {
                html = `<div style="text-align:center; padding:30px 20px; color:#94a3b8; font-size:14px;">Êú¨ÈÄ±Â∞öÁÑ°‰ªª‰ΩïÂúòÈöä‰ªªÂãôË≥áÊñô„ÄÇ</div>`;
            }

            listEl.innerHTML = html;
        }

        window.openAllocAddReqModal = function () {
            const projSelect = document.getElementById('allocNewReqProject');
            projSelect.innerHTML = db.rpLinks.map(l => {
                let ms = db.milestones.find(m => m.region === l.region && m.project === l.project);
                let cat = ms ? ms.category : 'NPI';
                return `<option value="${l.region}|${l.project}|${cat}">üåç ${l.region} - üì¶ ${l.project} (${cat})</option>`;
            }).join('');
            document.getElementById('allocAddReqModal').style.display = 'block';
        }

        window.submitAllocNewReq = function () {
            const currentWeek = document.getElementById('allocWeekSelector').value;
            const projVal = document.getElementById('allocNewReqProject').value;
            const [region, project, category] = projVal.split('|');
            const macro = document.getElementById('allocNewReqMacro').value;
            const micro = document.getElementById('allocNewReqMicro').value;
            const task = document.getElementById('allocNewReqTask').value;
            const val = document.getElementById('allocNewReqVal').value;

            if (!task) return alert('Ë´ãÂ°´ÂØ´‰ªªÂãôÂêçÁ®±ÔºÅ');
            if (parseFloat(val) <= 0) return alert('ÈúÄÊ±Ç‰∫∫ÂäõÈ†àÂ§ßÊñº 0');

            let newRow = { _id: Date.now() + Math.floor(Math.random() * 100000), region, project, category, macro, micro, task, subTask: "", group: "", name: "" };
            allocTimelineCols.forEach(c => newRow[c.key] = "");
            newRow[currentWeek] = parseFloat(val).toFixed(1);
            mainTableData.push(newRow);

            saveAllStorage(); renderMainTable();
            document.getElementById('allocAddReqModal').style.display = 'none';
            updateAllocView();
        }

        window.changeAllocTotalReq = function (inputEl) {
            const currentWeek = document.getElementById('allocWeekSelector').value;
            const taskKey = inputEl.getAttribute('data-task');
            const [region, project, category, macro, micro, task, subTask] = taskKey.split('|');
            const newVal = parseFloat(inputEl.value);

            if (isNaN(newVal) || newVal < 0) { alert("Ë´ãËº∏ÂÖ•ÊúâÊïàÁöÑÊï∏Â≠óÔºÅ"); updateAllocView(); return; }

            let taskRows = mainTableData.filter(r => (r.region || "") === region && (r.project || "") === project && (r.category || "") === category && (r.macro || "") === macro && (r.micro || "") === micro && (r.task || "") === task && (r.subTask || "") === subTask);
            let assignedTotal = 0; let unassignedRowIndex = -1;

            taskRows.forEach(r => {
                let val = parseFloat(r[currentWeek]) || 0;
                if (r.name && r.name !== "") assignedTotal += val;
                else if (val > 0) unassignedRowIndex = mainTableData.findIndex(mainR => mainR === r);
            });

            if (newVal < assignedTotal) { alert(`ÁÑ°Ê≥ïÈôç‰ΩéÔºÅÂ∑≤ÊåáÊ¥æ ${assignedTotal.toFixed(1)}„ÄÇË´ãÂÖàÂæû‰∏ãÊñπÈÄ±ÊúüË°®ÊãîÈô§‰∫∫Âì°„ÄÇ`); updateAllocView(); return; }

            let newUnassignedVal = newVal - assignedTotal;

            if (unassignedRowIndex > -1) {
                if (newUnassignedVal > 0) mainTableData[unassignedRowIndex][currentWeek] = newUnassignedVal.toFixed(1);
                else mainTableData[unassignedRowIndex][currentWeek] = "";
            } else {
                if (newUnassignedVal > 0 && taskRows.length > 0) {
                    let newRow = { _id: Date.now() + Math.floor(Math.random() * 100000), region, project, category, macro, micro, task, subTask, group: "", name: "" };
                    allocTimelineCols.forEach(c => newRow[c.key] = "");
                    newRow[currentWeek] = newUnassignedVal.toFixed(1);
                    mainTableData.push(newRow);
                }
            }
            saveAllStorage(); renderMainTable(); updateAllocView();
        }

        window.assignAllocTask = function (unassignedId) {
            const currentWeek = document.getElementById('allocWeekSelector').value;
            const personName = document.getElementById(`am_sel_${unassignedId}`).value;
            const assignVal = parseFloat(document.getElementById(`am_val_${unassignedId}`).value);

            // üí° Áç≤ÂèñÂêÑ‰∫∫‰∫ãÈ†ÖËº∏ÂÖ•ÂÄº
            const pTask = document.getElementById(`am_ptask_${unassignedId}`).value.trim();

            if (!personName) return alert("Ë´ãÂÖàÈÅ∏Êìá‰∫∫Âì°ÔºÅ");
            if (isNaN(assignVal) || assignVal <= 0) return alert("ÂàÜÈÖçÈ°çÂ∫¶ÂøÖÈ†àÂ§ßÊñº 0ÔºÅ");

            let targetIdx = mainTableData.findIndex(r => r._id == unassignedId);
            if (targetIdx === -1) return alert("Êâæ‰∏çÂà∞‰ªªÂãô");

            let targetRow = mainTableData[targetIdx];
            let originalVal = parseFloat(targetRow[currentWeek]);

            let newRow = JSON.parse(JSON.stringify(targetRow));
            newRow._id = Date.now() + Math.floor(Math.random() * 100000);
            newRow.name = personName;
            newRow.group = db.groupLinks.find(g => g.name === personName)?.group || "Êú™ÂàÜÈ°û";

            // üí° ÂØ´ÂÖ•ÂêÑ‰∫∫‰∫ãÈ†ÖÂà∞Êñ∞Ë≥áÊñôË°å‰∏≠
            newRow.personalTask = pTask;

            allocTimelineCols.forEach(c => newRow[c.key] = "");
            newRow[currentWeek] = assignVal.toFixed(1);
            mainTableData.push(newRow);

            if (assignVal < originalVal) targetRow[currentWeek] = (originalVal - assignVal).toFixed(1);
            else targetRow[currentWeek] = "";

            saveAllStorage(); renderMainTable(); updateAllocView();
        }

        window.unassignAllocTask = function (taskId, targetWeekKey) {
            let targetIdx = mainTableData.findIndex(r => r._id == taskId);

            if (targetIdx > -1) {
                let targetRow = mainTableData[targetIdx];
                let valToReturn = parseFloat(targetRow[targetWeekKey]);
                if (isNaN(valToReturn) || valToReturn <= 0) return;

                let existingUnassigned = mainTableData.find(r =>
                    r._id != taskId && (!r.name || r.name === "") &&
                    r.region === targetRow.region && r.project === targetRow.project && r.category === targetRow.category &&
                    r.macro === targetRow.macro && r.micro === targetRow.micro && r.task === targetRow.task && r.subTask === targetRow.subTask
                );

                if (existingUnassigned) {
                    existingUnassigned[targetWeekKey] = (parseFloat(existingUnassigned[targetWeekKey] || 0) + valToReturn).toFixed(1);
                } else {
                    let newRow = JSON.parse(JSON.stringify(targetRow));
                    newRow._id = Date.now() + Math.floor(Math.random() * 100000);
                    newRow.name = ""; newRow.group = "";
                    allocTimelineCols.forEach(c => newRow[c.key] = "");
                    newRow[targetWeekKey] = valToReturn.toFixed(1);
                    mainTableData.push(newRow);
                }

                targetRow[targetWeekKey] = "";
                saveAllStorage(); renderMainTable(); updateAllocView();
            }
        }
        // ================= ÂàáÊèõÈÄ≤ÈöéÊéíÁ®ãÂçÄÂ°ä =================
        window.toggleAdvancedScheduling = function (forceState) {
            const block = document.getElementById('advanced_scheduling_block');
            const btn = document.getElementById('btn_toggle_advanced');

            if (forceState === 'open' || (forceState !== 'close' && block.style.display === 'none')) {
                block.style.display = 'block';
                btn.innerHTML = 'üîº Êî∂ÂêàÈÄ≤ÈöéÊéíÁ®ã';
                btn.style.backgroundColor = '#e2e8f0';
            } else {
                block.style.display = 'none';
                btn.innerHTML = 'üîΩ Â±ïÈñãÈÄ≤ÈöéÊéíÁ®ã (Èï∑ÊúüÊâπÊ¨°ÊåáÊ¥æ‰∫∫Âì°ËàáÈÄ±Ê¨äÈáç)';
                btn.style.backgroundColor = '#f8fafc';
            }
        }
    </script>


</body>

</html>