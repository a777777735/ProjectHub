# ProjectHub/render.yaml
services:
  - type: web
    name: projecthub-ttt-backend 
    env: node
    region: oregon 
    plan: free
    rootDir: apps/tic-tac-toe-server 
    buildCommand: "npm install && echo '--- [TTT Backend] Listing current (apps/tic-tac-toe-server) directory: ---' && ls -la"
    startCommand: "node server.js"
    healthCheckPath: /
    envVars:
      - key: NODE_ENV
        value: production

  - type: web
    name: projecthub-main-frontend 
    env: node
    region: oregon 
    plan: free
    # No rootDir, build/start commands run from repository root.
    # The buildCommand will also list files for debugging.
    buildCommand: "npm install && echo '--- [Main Frontend] Listing repository root: ---' && ls -la && echo '--- [Main Frontend] Listing server/ directory: ---' && ls -la server/"
    startCommand: "node server/index.js" # **This now correctly points to ProjectHub/server/index.js**
    healthCheckPath: / 
    envVars:
      - key: NODE_ENV
        value: production
      # Example of passing the TTT backend's internal URL to this frontend server
      # This frontend server could then, for example, inject it into the TTT client HTML if needed,
      # or the TTT client JS could fetch it from an API endpoint on this frontend server.
      # However, for client-side JS直接连接，客户端JS需要知道后端的公共URL。
      # - key: TIC_TAC_TOE_BACKEND_URL # Public URL
      #   fromService:
      #     type: web
      #     name: projecthub-ttt-backend # Must match the name above
      #     property: url
